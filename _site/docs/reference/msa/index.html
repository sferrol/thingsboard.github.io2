







<!Doctype html>
<html id="docs" class="Architecture">







<head>
    <meta charset="utf-8">
    <meta name="cf-2fa-verify" content="a08672380de15e9">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>ThingsBoard Microservices architecture | ThingsBoard Community Edition</title>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="ThingsBoard Microservices architecture" />
<meta name="author" content="thingsboard" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ThingsBoard architecture" />
<meta property="og:description" content="ThingsBoard architecture" />
<link rel="canonical" href="http://0.0.0.0:4002/docs/reference/msa/" />
<meta property="og:url" content="http://0.0.0.0:4002/docs/reference/msa/" />
<meta property="og:site_name" content="ThingsBoard" />
<meta property="og:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta property="twitter:title" content="ThingsBoard Microservices architecture" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4002/docs/reference/msa/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4002/images/thingsboard_logo.png"},"name":"thingsboard"},"author":{"@type":"Person","name":"thingsboard"},"image":{"twitter":"/images/thingsboard_logo.png","facebook":"/images/thingsboard_logo.png","url":"http://0.0.0.0:4002/images/thingsboard_logo.png","@type":"imageObject"},"description":"ThingsBoard architecture","@type":"WebPage","headline":"ThingsBoard Microservices architecture","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
    
    <meta name="twitter:description" content="ThingsBoard architecture"/>
    
    
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.7.0/qs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gifffer/1.5.0/gifffer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <script type="text/javascript">
        window.onload = function() {
            Gifffer();
        }
    </script>
    <script type="text/javascript">
        /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
        !function (a) {
            "use strict";
            var b = function (b, c, d) {
                function e(a) {
                    return h.body ? a() : void setTimeout(function () {
                        e(a)
                    })
                }

                function f() {
                    i.addEventListener && i.removeEventListener("load", f), i.media = d || "all"
                }

                var g, h = a.document, i = h.createElement("link");
                if (c) g = c; else {
                    var j = (h.body || h.getElementsByTagName("head")[0]).childNodes;
                    g = j[j.length - 1]
                }
                var k = h.styleSheets;
                i.rel = "stylesheet", i.href = b, i.media = "only x", e(function () {
                    g.parentNode.insertBefore(i, c ? g : g.nextSibling)
                });
                var l = function (a) {
                    for (var b = i.href, c = k.length; c--;) if (k[c].href === b) return a();
                    setTimeout(function () {
                        l(a)
                    })
                };
                return i.addEventListener && i.addEventListener("load", f), i.onloadcssdefined = l, l(f), i
            };
            "undefined" != typeof exports ? exports.loadCSS = b : a.loadCSS = b
        }("undefined" != typeof global ? global : this);

        /*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
        function onloadCSS(a, b) {
            function c() {
                !d && b && (d = !0, b.call(a))
            }

            var d;
            a.addEventListener && a.addEventListener("load", c), a.attachEvent && a.attachEvent("onload", c), "isApplicationInstalled" in navigator && "onloadcssdefined" in a && a.onloadcssdefined(c)
        }
    </script>
    <script type="text/javascript">

        function jqueryDefer(method) {
            if (window.jQuery) {
                method();
            } else {
                setTimeout(function () {
                    jqueryDefer(method)
                }, 50);
            }
        }

        function jqueryUiDefer(method) {
            if (window.jQuery && window.jQuery.ui) {
                method();
            } else {
                setTimeout(function () {
                    jqueryUiDefer(method)
                }, 50);
            }
        }

        window.vis = (function () {
            var stateKey,
                eventKey,
                keys = {
                    hidden: "visibilitychange",
                    webkitHidden: "webkitvisibilitychange",
                    mozHidden: "mozvisibilitychange",
                    msHidden: "msvisibilitychange"
                };
            for (stateKey in keys) {
                if (stateKey in document) {
                    eventKey = keys[stateKey];
                    break;
                }
            }
            return function (c) {
                if (c) document.addEventListener(eventKey, c);
                return !document[stateKey];
            }
        })();

        function loadScript(src, callback) {
            var s, r, t;
            r = false;
            s = document.createElement('script');
            s.type = 'text/javascript';
            s.src = src;
            s.onload = s.onreadystatechange = function () {
                if (!r && (!this.readyState || this.readyState == 'complete')) {
                    r = true;
                    if (callback) {
                        callback();
                    }
                }
            };
            t = document.getElementsByTagName('script')[0];
            t.parentNode.insertBefore(s, t);
        }

        function loadCssAsync(src, callback) {
            var stylesheet = loadCSS(src);
            if (callback) {
                onloadCSS(stylesheet, callback);
            }
        }

        function loadNextScript(index, scriptsList, completeCallback) {
            if (index < scriptsList.length) {
                var script = scriptsList[index];
                if (script.type === 'script') {
                    loadScript(script.src, function () {
                        if (script.callback) {
                            script.callback();
                        }
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                } else if (script.type === 'css') {
                    loadCssAsync(script.src, function () {
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                }
            } else if (completeCallback) {
                completeCallback();
            }
        }

        var initialScriptsList = [
            {src: '/js/jquery-2.2.0.min.js', type: 'script'},
            {src: '/css/jquery-ui.min.css', type: 'css'},
            {src: '/js/jquery-ui.min.js', type: 'script'},
            {src: '/js/jquery.vide.js', type: 'script'},
            {src: '/js/script.js', type: 'script'},
            {src: '/css/photoswipe.css', type: 'css'},
            {src: '/css/default-skin/default-skin.css', type: 'css'},
            {src: '/js/photoswipe.min.js', type: 'script'},
            {src: '/js/photoswipe-ui-default.min.js', type: 'script'}
        ];

        loadNextScript(0, initialScriptsList);

        jqueryDefer(function () {
            (function ($, win) {
                $.fn.inViewport = function (cb) {
                    return this.each(function (i, el) {
                        function visPx() {
                            var H = $(this).height(),
                                r = el.getBoundingClientRect(), t = r.top, b = r.bottom;
                            var result = cb.call(el, Math.max(0, t > 0 ? H - t : (b < H ? b : H)));
                            if (result) {
                                $(win).off("resize scroll", visPx);
                            }
                        }

                        visPx();
                        $(win).on("resize scroll", visPx);
                    });
                };
            }(jQuery, window));
        });

        function inViewportDefer(method) {
            if (window.jQuery && $.fn.inViewport) {
                method();
            } else {
                setTimeout(function () {
                    inViewportDefer(method)
                }, 50);
            }
        }

    </script>
    <script type="text/javascript">
        function _gaLt(event) {
            /* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
            if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
                return;
            }
            var el = event.srcElement || event.target;

            while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
                el = el.parentNode;
            }
            if (el && el.href) {
                var link = el.href;
                if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
                    var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
                        target = "_blank";
                    }

                    var hbrun = false; // tracker has not yet run
                    var hitBack = function () {
                        if (hbrun) return;
                        hbrun = true;
                        window.location.href = link;
                    };

                    if (target) {
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search
                        );
                    } else {
                        event.preventDefault ? event.preventDefault() : event.returnValue = !1;
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search, {
                                "hitCallback": hitBack
                            }
                        );

                        setTimeout(hitBack, 1000);
                    }
                }
            }
        }

        var _w = window;
        var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
        _w.addEventListener ? _w.addEventListener("load", function () {
                document.body.addEventListener(_gaLtEvt, _gaLt, !1)
            }, !1)
            : _w.attachEvent && _w.attachEvent("onload", function () {
            document.body.attachEvent("on" + _gaLtEvt, _gaLt)
        });
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-88383331-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script>
        function Burger() {
            var header = $('header');
            var body = $('body');
            if (header.hasClass('opened-burger')) {
                header.removeClass('opened-burger');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                body.css('overflow', '');
            } else {
                header.addClass('opened-burger');
                body.css('overflow', 'hidden');
            }
        }
    </script>
    <script>

        jqueryDefer(function () {
            let menuElement = $('nav.head-menu > ul');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            let menuItems = $('nav.head-menu > ul > li');
            let indicator = $('nav.head-menu > ul > div.indicator');
            let subMenuActive = false;
            menuElement.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('div.sub-menu-container').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            submenuContainer.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('nav.head-menu > ul').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            menuItems.each(function() {
                let item = $( this );
                let subMenuId = item.attr('data-submenu-id');
                item.on('mouseenter', function () {
                    let submenus = $('nav.head-menu > div.sub-menu-container > div');
                    submenus.css('display', 'none');
                    menuItems.removeClass('active');
                    item.addClass('active');
                    let targetSubMenu = $('nav.head-menu > div.sub-menu-container > div#'+subMenuId);
                    targetSubMenu.css('display', 'block');
                    submenuContainer.css('overflow', 'visible');
                    let left = item.position().left + (item.outerWidth() - targetSubMenu.outerWidth()) / 2;
                    submenuContainer.css('left', left + 'px');
                    if (!subMenuActive) {
                        submenuContainer.addClass('active');
                        subMenuActive = true;
                    } else {
                        submenuContainer.addClass('bounds-transition');
                        indicator.addClass('left-transition');
                    }
                    indicator.css('left', item.position().left);
                    indicator.css('width', item.outerWidth());
                    submenuContainer.css('height', targetSubMenu.outerHeight() + 'px');
                    submenuContainer.css('width', targetSubMenu.outerWidth() + 'px');
                    submenuContainer.css('overflow', 'hidden');
                });
            });

            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                initMobileSubmenu();
            }

            $(window).resize(function(){
                let newIsMobile = $('button.burger').css('display') === 'block';
                if (isMobile !== newIsMobile) {
                    isMobile = newIsMobile;
                    if (isMobile) {
                        initMobileSubmenu();
                    } else {
                        restoreDesktopSubmenu();
                    }
                }
            });

            // Products selector

            
            let productsSelector = $('.products-selector');
            $(window).click(function(e) {
                if (productsSelector[0].contains(e.target)) {
                    if (productsSelector.hasClass('active')) {
                        productsSelector.removeClass('active');
                    } else {
                        productsSelector.addClass('active');
                    }
                } else {
                    productsSelector.removeClass('active');
                }
            });
            

            // Rogue line numbers fix (don't show line numbers for 1 row)
            $( document ).ready(function() {
                $('.rouge-gutter.gl').each(function() {
                    var lineNumbers = $(this).children('.lineno');
                    if (lineNumbers.text() === '1\n') {
                        $(this).css('display', 'none');
                    }
                });
            });
        });

        function initMobileSubmenu() {

            var header = $('header');
            if (header.hasClass('opened-burger')) {
                var body = $('body');
                body.css('overflow', 'hidden');
            }

            let targetSubMenus = $('nav.head-menu > div.sub-menu-container > div');
            targetSubMenus.css('display', 'block');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'none');

            targetSubMenus.each(function() {
                let subMenu = $( this );
                let subMenuId = subMenu.attr('id');
                let parent = $('nav.head-menu > ul > li.'+subMenuId);
                parent.append(subMenu);
            });
        }

        function restoreDesktopSubmenu() {
            var body = $('body');
            body.css('overflow', '');
            let targetSubMenus = $('nav.head-menu > ul > li > div');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'block');
            let menuItems = $('nav.head-menu > ul > li');
            menuItems.removeClass('active');
            targetSubMenus.each(function() {
                let subMenu = $( this );
                submenuContainer.append(subMenu);
            });
        }

        function listburg(subMenuId) {
            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                let targetSubMenu = $('nav.head-menu > ul > li > div.centered-sub#'+subMenuId+' > ul.sub-menu');
                let isOpen = targetSubMenu.hasClass('open-sub');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                if (!isOpen) {
                    targetSubMenu.addClass('open-sub');
                }
            }
        }
    </script>
</head>
<body>

<div class="products-selector">
    <img src="/images/thingsboard-cm-icon.svg"/>
    <div class="product-info">
        <div class="product-title">
            Community Edition
        </div>
        <div class="product-description">
            ThingsBoard Documentation
        </div>
    </div>
    <div class="products">
        
        

    
        
        


        
    


        <a href="/docs/paas/" class="product">Cloud</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/pe/reference/msa/" class="product">Professional Edition</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/reference/msa/" class="product active">Community Edition</a>
        
        

    


        <a href="/docs/edge/" class="product">Edge</a>
        
        

    


        <a href="/docs/iot-gateway/" class="product">IoT Gateway</a>
        
        

    


        <a href="/products/license-server/" class="product">License Server</a>
        
        

    


        <a href="/docs/trendz/" class="product">Trendz Analytics</a>
        
    </div>
</div>

<header>
    <div class="logo-burger">
        
        <button onclick="Burger()" class="burger"></button>
        <div id="githubButtonContainer">
            <a class="github-button" href="https://github.com/thingsboard/thingsboard" data-show-count="true"
               aria-label="Star thingsboard/thingsboard on GitHub">Star</a>
        </div>
    </div>
    <nav class="head-menu">
        <ul>
            <li class="nav-products" data-submenu-id="nav-products">
                <a onclick="listburg('nav-products')">Products</a>
            </li>
            <li class="nav-services" data-submenu-id="nav-services">
                <a onclick="listburg('nav-services')">Services</a>
            </li>
            
            <li class="nav-cases" data-submenu-id="nav-cases">
                <a onclick="listburg('nav-cases')">Use Cases</a>
            </li>
            <li class="nav-customers" data-submenu-id="nav-customers">
                <a onclick="listburg('nav-customers')">Customers</a>
            </li>
            <li class="nav-company" data-submenu-id="nav-company">
                <a onclick="listburg('nav-company')">Company</a>
            </li>
            <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
        </ul>
        <div class="sub-menu-container">
            <div id="nav-products" class="centered-sub">
                <ul class="sub-menu products">
                    <div class="sub-groups">
                        <div class="group">
                            <p class="group-name">IoT platforms</p>
                            <a class="cloud-lnk" href="/products/paas/">
                                <img src="/images/thingsboard-c-icon.svg">
                                <div class="sub-text">
                                    <h1>Cloud</h1>
                                    <p>Platform as a service</p>
                                </div>
                            </a>
                            <a class="prof-lnk" href="/products/thingsboard-pe/">
                                <img src="/images/thingsboard-p-icon.svg">
                                <div class="sub-text">
                                    <h1>Professional Edition</h1>
                                    <p>Advanced IoT platform</p>
                                </div>
                            </a>
                            <a class="com-lnk" href="/">
                                <img src="/images/thingsboard-cm-icon.svg">
                                <div class="sub-text">
                                    <h1>Community Edition</h1>
                                    <p>Open source platform</p>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <p class="group-name">Product ecosystem</p>
                            <a class="edge-lnk" href="/products/thingsboard-edge/">
                                <img src="/images/thingsboard-e-icon.svg">
                                <div class="sub-text">
                                    <h1>Edge</h1>
                                    <p>Edge computing</p>
                                </div>
                            </a>
                            <a class="gateway-lnk" href="/docs/iot-gateway/what-is-iot-gateway/">
                                <img src="/images/gateway-icon.svg">
                                <div class="sub-text">
                                    <h1>IoT Gateway</h1>
                                    <p>Connect legacy protocols</p>
                                </div>
                            </a>
                            <a class="license-lnk" href="/products/license-server/">
                                <img src="/images/license-icon.svg">
                                <div class="sub-text">
                                    <h1>License Server</h1>
                                    <p>Billing solution</p>
                                </div>
                            </a>
                            <a class="trendz-lnk" href="/products/trendz/">
                                <img src="/images/trendz-icon.svg">
                                <div class="sub-text">
                                    <h1>Trendz Analytics</h1>
                                    <p>Data analytics and Prediction</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-services" class="centered-sub">
                <ul class="sub-menu services">
                    <a href="/docs/services/support/">
                        <img src="/images/support-icon.svg">
                        <div class="sub-text">
                            <h1>Support</h1>
                            <p>Support packages</p>
                        </div>
                    </a>
                    <a href="/docs/services/trainings/">
                        <img src="/images/train-icon.svg">
                        <div class="sub-text">
                            <h1>Trainings</h1>
                            <p>ThingsBoard education courses</p>
                        </div>
                    </a>
                    <a href="/docs/services/consulting/">
                        <img src="/images/prof-icon.svg">
                        <div class="sub-text">
                            <h1>Professional services</h1>
                            <p>Development of solutions by the ThingsBoard team</p>
                        </div>
                    </a>
                </ul>
            </div>
            
            <div id="nav-cases" class="centered-sub">
                <ul class="sub-menu cases">
                    <a href="/smart-metering/">
                        <img src="/images/case-met-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Metering</h1>
                            <p>Collection, analysis and visualization of data from meters</p>
                        </div>
                    </a>
                    <a href="/smart-energy/">
                        <img src="/images/case-eng-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Energy</h1>
                            <p>Energy monitoring and efficiency analysis</p>
                        </div>
                    </a>
                    <a href="/smart-farming/">
                        <img src="/images/case-fam-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Farming</h1>
                            <p>Monitoring of indoor conditions and plant growth characteristics</p>
                        </div>
                    </a>
                    <a href="/fleet-tracking/">
                        <img src="/images/case-trk-icon.svg">
                        <div class="sub-text">
                            <h1>Fleet Tracking</h1>
                            <p>Fleet tracking and fleet management</p>
                        </div>
                    </a>
                </ul>
            </div>
            <div id="nav-customers" class="centered-sub">
                <ul class="sub-menu customers">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/industries/smart-energy/">
                                <img src="/images/se-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Energy</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/agriculture/">
                                <img src="/images/agr-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Agriculture</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/smart-buildings/">
                                <img src="/images/sb-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Buildings</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/industries/smart-city/">
                                <img src="/images/sc-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart City</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/telecom/">
                                <img src="/images/tel-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Telecom</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/industry40/">
                                <img src="/images/in-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Industry 4.0</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-company" class="centered-sub">
                <ul class="sub-menu about">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/company/">
                                <img src="/images/about-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Our Company</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/docs/contact-us/">
                                <img src="/images/contact-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Contact Us</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/careers/">
                                <img src="/images/careers-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Careers</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/mediakit/">
                                <img src="/images/media-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Media Kit</h1>
                                </div>
                            </a>
                            <a class="small-link" href="https://blog.thingsboard.io/">
                                <img src="/images/blog-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Blog</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="bottom-group">
                        <a class="small-link" href="/partners/hardware/">
                            <img src="/images/hard-s-icon.svg">
                            <div class="sub-text">
                                <h1>Hardware partners</h1>
                            </div>
                        </a>
                        <a class="small-link" href="/partners/distributors/">
                            <img src="/images/dis-s-icon.svg">
                            <div class="sub-text">
                                <h1>Distributors</h1>
                            </div>
                        </a>
                    </div>
                </ul>
            </div>
        </div>
    </nav>
    <div>
        <a href="/installations/" class="n-button try">Try it now</a>
        <a href="/pricing/" class="n-button price">Pricing</a>
    </div>
</header>


<div id="searchBox">
    <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    <button class="searchButton"></button>
</div>

<!--  HERO  -->
<section id="hero">
  <div id="hero-content">
    <div id="vendorStrip">
      <div id="docsList">
          <ul>
            
              
              
              
              <li>
                  <a href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/" >Documentation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/guides/" >Guides</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/user-guide/install/installation-options/" >Installation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/reference/" class="YAH">Architecture</a>
                  
                     <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/api/" >API</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/faq/" >FAQ</a>
                  
              </li>
            
          </ul>
          <div id="docsBreadcrumbs">
              
                  
                  
                  
                  
                      
                  
                      
                  
                      
                        
                        
                  
                    <span class="item">Architecture</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">Microservices architecture</span>
                    
                  
              
          </div>
      </div>
    </div>
  </div>
</section>
<div id="docsNav">
    <div class="docItems">
        
            
            
                <a class="toc" href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
            
        
            
            
                <a class="toc" href="/docs/" >Documentation</a>
            
        
            
            
                <a class="toc" href="/docs/guides/" >Guides</a>
            
        
            
            
                <a class="toc" href="/docs/user-guide/install/installation-options/" >Installation</a>
            
        
            
            
                <div class="pi-accordion">
                    


<a class="item" data-title="Architecture Overview" href="/docs/reference/"></a>


<a class="item" data-title="Monolithic architecture" href="/docs/reference/monolithic/"></a>


<a class="item" data-title="Microservices architecture" href="/docs/reference/msa/"></a>


<a class="item" data-title="Deployment scenarios" href="/docs/reference/iot-platform-deployment-scenarios/"></a>


<div class="item" data-title="ThingsBoard Performance">
  <div class="container">


<a class="item" data-title="Data Collection Performance" href="/docs/reference/performance/"></a>


<a class="item" data-title="Single instance performance on different AWS instances" href="/docs/reference/performance-aws-instances/"></a>
  </div>
</div>
                </div>
            
        
            
            
                <a class="toc" href="/docs/api/" >API</a>
            
        
            
            
                <a class="toc" href="/docs/faq/" >FAQ</a>
            
        
    </div>
</div>








<section id="encyclopedia">
  
  <div id="docsToc">
        <div class="pi-accordion">
        


<a class="item" data-title="Architecture Overview" href="/docs/reference/"></a>


<a class="item" data-title="Monolithic architecture" href="/docs/reference/monolithic/"></a>


<a class="item" data-title="Microservices architecture" href="/docs/reference/msa/"></a>


<a class="item" data-title="Deployment scenarios" href="/docs/reference/iot-platform-deployment-scenarios/"></a>


<div class="item" data-title="ThingsBoard Performance">
  <div class="container">


<a class="item" data-title="Data Collection Performance" href="/docs/reference/performance/"></a>


<a class="item" data-title="Single instance performance on different AWS instances" href="/docs/reference/performance-aws-instances/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
  </div> <!-- /docsToc -->
  
  <div id="docsContent" class=" hasTocContent">
      <div id="table-of-contents">
          
              <h4>On this page</h4>
          
      </div>
      <div id="top-spacer"></div>
      <h1>ThingsBoard Microservices architecture</h1>
      <div id="content">
          
<ul id="markdown-toc">
  <li><a href="#architecture-diagram" id="markdown-toc-architecture-diagram">Architecture diagram</a></li>
  <li><a href="#transport-microservices" id="markdown-toc-transport-microservices">Transport Microservices</a></li>
  <li><a href="#web-ui-microservices" id="markdown-toc-web-ui-microservices">Web UI Microservices</a></li>
  <li><a href="#javascript-executor-microservices" id="markdown-toc-javascript-executor-microservices">JavaScript Executor Microservices</a></li>
  <li><a href="#thingsboard-node" id="markdown-toc-thingsboard-node">ThingsBoard Node</a></li>
  <li><a href="#third-party" id="markdown-toc-third-party">Third-party</a>    <ul>
      <li><a href="#kafka" id="markdown-toc-kafka">Kafka</a></li>
      <li><a href="#redis" id="markdown-toc-redis">Redis</a></li>
      <li><a href="#zookeeper" id="markdown-toc-zookeeper">Zookeeper</a></li>
      <li><a href="#haproxy-or-other-loadbalancer" id="markdown-toc-haproxy-or-other-loadbalancer">HAProxy (or other LoadBalancer)</a></li>
      <li><a href="#databases" id="markdown-toc-databases">Databases</a></li>
    </ul>
  </li>
  <li><a href="#deployment" id="markdown-toc-deployment">Deployment</a></li>
</ul>

<p>Since ThingsBoard v2.2, the platform supports microservices deployment mode. 
This article consist of high level diagram, description of data flow between various services and some architecture choices made.</p>

<h2 id="architecture-diagram">Architecture diagram</h2>

<object width="80%" data="/images/reference/msa-architecture.svg"></object>

<h2 id="transport-microservices">Transport Microservices</h2>

<p>ThingsBoard provides MQTT, HTTP and CoAP based APIs that are available for your device applications/firmware. 
Each of the protocol APIs are provided by a separate server component and is part of ThingsBoard “Transport Layer”. 
The full list of components and corresponding documentation pages are listed below:</p>

<ul>
  <li>HTTP Transport microservice provides device APIs described <a href="/docs/reference/http-api/">here</a>;</li>
  <li>MQTT Transport microservice provides device APIs described <a href="/docs/reference/mqtt-api/">here</a>
and also enables gateway APIs described <a href="/docs/reference/gateway-mqtt-api/">here</a>;</li>
  <li>CoAP Transport microservice provides device APIs described <a href="/docs/reference/coap-api/">here</a>;</li>
  <li>LwM2M Transport microservice provides device APIs described <a href="/docs/reference/lwm2m-api/">here</a>.</li>
</ul>

<p>Each of the transport servers listed above communicates with the main ThingsBoard Node microservices using Kafka. 
<a href="https://kafka.apache.org">Apache Kafka</a> is a distributed, reliable and scalable persistent message queue and streaming platform.</p>

<p>The messages that are sent to Kafka are serialized using <a href="https://developers.google.com/protocol-buffers/">protocol buffers</a> 
with the messages definition available <a href="https://github.com/thingsboard/thingsboard/blob/master/common/transport/transport-api/src/main/proto/transport.proto">here</a>.</p>

<p><strong>Note</strong>: Starting v2.5, ThingsBoard PE is going to support alternative queue implementation: Amazon DynamoDB. See <a href="/docs/reference/roadmap">roadmap</a> for more details.</p>

<p>There are two main topics that are used by the transport layer microservices.</p>

<p>First topic “tb.transport.api.requests” is used to execute short-living API requests to check device credentials or create device on behalf of the gateway.
Responses to this requests are sent to the topic that is specific for each transport microservice. The prefix of such “callback” topic is “tb.transport.api.responses” by default.</p>

<p>Second topic “tb.rule-engine” is used to store all incoming telemetry messages from devices until they are not processed by the rule engine. In case the rule engine node(s) are down
, messages will be persisted and available for later processing.</p>

<p>You can see a part of configuration file to specify those properties below:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="na">transport</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${TRANSPORT_TYPE:local}"</span> <span class="c1"># local or remote</span>
  <span class="na">remote</span><span class="pi">:</span>
    <span class="na">transport_api</span><span class="pi">:</span>
      <span class="na">requests_topic</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${TB_TRANSPORT_API_REQUEST_TOPIC:tb.transport.api.requests}"</span>
      <span class="na">responses_topic</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${TB_TRANSPORT_API_RESPONSE_TOPIC:tb.transport.api.responses}"</span>
    <span class="na">rule_engine</span><span class="pi">:</span>
      <span class="na">topic</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${TB_RULE_ENGINE_TOPIC:tb.rule-engine}"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Since ThingsBoard uses very simple communication protocol between transport and core services, 
it is quite easy to implement support of custom transport protocol, for example: CSV over plain TCP, binary payloads over UDP, etc.
We suggest to review existing transports <a href="https://github.com/thingsboard/thingsboard/tree/master/common/transport/mqtt">implementation</a> to get started or <a href="/docs/contact-us/">contact us</a> if you need any help.</p>

<h2 id="web-ui-microservices">Web UI Microservices</h2>

<p>ThingsBoard provides a lightweight component written using Express.js framework to host static web ui content. Those components are completely stateless and no much configuration available.</p>

<h2 id="javascript-executor-microservices">JavaScript Executor Microservices</h2>

<p>ThingsBoard rule engine allows users to specify custom javascript functions to parse, filter and transform messages. 
Since those functions are user defined, we need to execute them in an isolated context to avoid impact on main processing.
ThingsBoard provides a lightweight component written using Node.js to execute user defined JavaScript functions remotely to isolate them from the core rule engine components.</p>

<p><strong>Note</strong>: ThingsBoard monolith app executes user defined functions in a java embedded JS engine, which does not allow to isolate resource consumption.</p>

<p>We recommend to launch 20+ separate JavaScript Executors that will allow certain concurrency level and load balancing of JS execution requests. 
Each microservice will subscribe to “js.eval.requests” kafka topic as part of single consumer group to enable load balancing. 
Requests for the same script are forwarded to the same JS executor using built-in Kafka partitioning by key (key is a script/rule node id).</p>

<p>It is possible to define max amount of pending JS execution requests and max request timeout to avoid single JS execution blocking the JS exector microservice.
Each ThingsBoard core service has individual blacklist for JS functions and will not invoke blocked function more then 3(by default) times.</p>

<h2 id="thingsboard-node">ThingsBoard Node</h2>

<p>ThingsBoard node is a core service written in Java that is responsible for handling:</p>

<ul>
  <li><a href="/docs/reference/rest-api/">REST API</a> calls;</li>
  <li>WebSocket <a href="/docs/user-guide/telemetry/#websocket-api">subscriptions</a> on entity telemetry and attribute changes;</li>
  <li>Processing messages via <a href="/docs/user-guide/rule-engine-2-0/re-getting-started/">rule engine</a>;</li>
  <li>Monitoring device <a href="/docs/user-guide/device-connectivity-status/">connectivity state</a> (active/inactive).</li>
</ul>

<p><strong>Note</strong>: moving rule engine to a separate microservice is scheduled for ThingsBoard v2.5. See <a href="/docs/reference/roadmap">roadmap</a> for more details.</p>

<p>ThingsBoard node uses Actor System to implement tenant, device, rule chains and rule node actors. 
Platform nodes can join the cluster, where each node is equal. Service discovery is done via Zookeeper. 
ThingsBoard nodes route messages between each other using consistent hashing algorithm based on entity id. 
So, messages for the same entity are processed on the same ThingsBoard node. Platform uses <a href="https://grpc.io/">gRPC</a> to send messages between ThingsBoard nodes.</p>

<p><strong>Note</strong>: ThingsBoard authors consider moving from gRPC to Kafka in the future releases for exchanging messages between ThingsBoard nodes. 
The main idea is to sacrifice small performance/latency penalties in favor of persistent and reliable message delivery and automatic load balancing provided by Kafka consumer groups.</p>

<h2 id="third-party">Third-party</h2>

<h3 id="kafka">Kafka</h3>

<p><a href="https://kafka.apache.org/">Apache Kafka</a> is an open-source stream-processing software platform. ThingsBoard uses Kafka to persist incoming telemetry from HTTP/MQTT/CoAP transpots 
until it is processed by the rule engine. ThingsBoard also uses Kafka for some API calls between micro-services.</p>

<h3 id="redis">Redis</h3>

<p><a href="https://redis.io/">Redis</a> is an open source (BSD licensed), in-memory data structure store used by ThingsBoard for caching. 
ThingsBoard caches assets, entity views, devices, device credentials, device sessions and entity relations.</p>

<h3 id="zookeeper">Zookeeper</h3>

<p><a href="https://zookeeper.apache.org/">Zookeeper</a> is an open-source server which enables highly reliable distributed coordination. 
ThingsBoard uses Zookeeper to address requests processing from a single entity (device,asset,tenant) to a certain ThingsBoard server 
and guarantee that only one server process data from particular device at a single point in time.</p>

<p><strong>Note</strong>: Zookeeper is also used by Kafka, so there was almost no reasons to use two different coordination services (Consul, etcd) in parallel.</p>

<h3 id="haproxy-or-other-loadbalancer">HAProxy (or other LoadBalancer)</h3>

<p>We recommend to use HAProxy for load balancing. 
You can find the reference <a href="https://github.com/thingsboard/thingsboard/blob/release-2.5/docker/haproxy/config/haproxy.cfg">haproxy.cfg</a> 
configuration that corresponds to the architecture diagram below:</p>

<figure class="highlight">
  <div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
</pre></td><td class="rouge-code"><pre><span class="c">#HA Proxy Config
</span><span class="n">global</span>
 <span class="n">ulimit</span>-<span class="n">n</span> <span class="m">500000</span>
 <span class="n">maxconn</span> <span class="m">99999</span>
 <span class="n">maxpipes</span> <span class="m">99999</span>
 <span class="n">tune</span>.<span class="n">maxaccept</span> <span class="m">500</span>

 <span class="n">log</span> <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span> <span class="n">local0</span>
 <span class="n">log</span> <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span> <span class="n">local1</span> <span class="n">notice</span>

 <span class="n">ca</span>-<span class="n">base</span> /<span class="n">etc</span>/<span class="n">ssl</span>/<span class="n">certs</span>
 <span class="n">crt</span>-<span class="n">base</span> /<span class="n">etc</span>/<span class="n">ssl</span>/<span class="n">private</span>

 <span class="n">ssl</span>-<span class="n">default</span>-<span class="n">bind</span>-<span class="n">ciphers</span> <span class="n">ECDH</span>+<span class="n">AESGCM</span>:<span class="n">DH</span>+<span class="n">AESGCM</span>:<span class="n">ECDH</span>+<span class="n">AES256</span>:<span class="n">DH</span>+<span class="n">AES256</span>:<span class="n">ECDH</span>+<span class="n">AES128</span>:<span class="n">DH</span>+<span class="n">AES</span>:<span class="n">ECDH</span>+<span class="m">3</span><span class="n">DES</span>:<span class="n">DH</span>+<span class="m">3</span><span class="n">DES</span>:<span class="n">RSA</span>+<span class="n">AESGCM</span>:<span class="n">RSA</span>+<span class="n">AES</span>:<span class="n">RSA</span>+<span class="m">3</span><span class="n">DES</span>:!<span class="n">aNULL</span>:!<span class="n">MD5</span>:!<span class="n">DSS</span>
 <span class="n">ssl</span>-<span class="n">default</span>-<span class="n">bind</span>-<span class="n">options</span> <span class="n">no</span>-<span class="n">sslv3</span>

<span class="n">defaults</span>

 <span class="n">log</span> <span class="n">global</span>

 <span class="n">mode</span> <span class="n">http</span>

 <span class="n">timeout</span> <span class="n">connect</span> <span class="m">5000</span><span class="n">ms</span>
 <span class="n">timeout</span> <span class="n">client</span> <span class="m">50000</span><span class="n">ms</span>
 <span class="n">timeout</span> <span class="n">server</span> <span class="m">50000</span><span class="n">ms</span>
 <span class="n">timeout</span> <span class="n">tunnel</span>  <span class="m">1</span><span class="n">h</span>    <span class="c"># timeout to use with WebSocket and CONNECT
</span>
 <span class="n">default</span>-<span class="n">server</span> <span class="n">init</span>-<span class="n">addr</span> <span class="n">none</span>

<span class="c">#enable resolving throught docker dns and avoid crashing if service is down while proxy is starting
</span><span class="n">resolvers</span> <span class="n">docker_resolver</span>
  <span class="n">nameserver</span> <span class="n">dns</span> <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">11</span>:<span class="m">53</span>

<span class="n">listen</span> <span class="n">stats</span>
 <span class="n">bind</span> *:<span class="m">9999</span>
 <span class="n">stats</span> <span class="n">enable</span>
 <span class="n">stats</span> <span class="n">hide</span>-<span class="n">version</span>
 <span class="n">stats</span> <span class="n">uri</span> /<span class="n">stats</span>
 <span class="n">stats</span> <span class="n">auth</span> <span class="n">admin</span>:<span class="n">admin</span>@<span class="m">123</span>

<span class="n">listen</span> <span class="n">mqtt</span>-<span class="n">in</span>
 <span class="n">bind</span> *:${<span class="n">MQTT_PORT</span>}
 <span class="n">mode</span> <span class="n">tcp</span>
 <span class="n">option</span> <span class="n">clitcpka</span> <span class="c"># For TCP keep-alive
</span> <span class="n">timeout</span> <span class="n">client</span> <span class="m">3</span><span class="n">h</span>
 <span class="n">timeout</span> <span class="n">server</span> <span class="m">3</span><span class="n">h</span>
 <span class="n">option</span> <span class="n">tcplog</span>
 <span class="n">balance</span> <span class="n">leastconn</span>
 <span class="n">server</span> <span class="n">tbMqtt1</span> <span class="n">tb</span>-<span class="n">mqtt</span>-<span class="n">transport1</span>:<span class="m">1883</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
 <span class="n">server</span> <span class="n">tbMqtt2</span> <span class="n">tb</span>-<span class="n">mqtt</span>-<span class="n">transport2</span>:<span class="m">1883</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>

<span class="n">frontend</span> <span class="n">http</span>-<span class="n">in</span>
 <span class="n">bind</span> *:${<span class="n">HTTP_PORT</span>}

 <span class="n">option</span> <span class="n">forwardfor</span>

 <span class="n">reqadd</span> <span class="n">X</span>-<span class="n">Forwarded</span>-<span class="n">Proto</span>:\ <span class="n">http</span>

 <span class="n">acl</span> <span class="n">acl_static</span> <span class="n">path_beg</span> /<span class="n">static</span>/ /<span class="n">index</span>.<span class="n">html</span>
 <span class="n">acl</span> <span class="n">acl_static</span> <span class="n">path</span> /
 <span class="n">acl</span> <span class="n">acl_static_rulenode</span> <span class="n">path_beg</span> /<span class="n">static</span>/<span class="n">rulenode</span>/

 <span class="n">acl</span> <span class="n">transport_http_acl</span> <span class="n">path_beg</span> /<span class="n">api</span>/<span class="n">v1</span>/
 <span class="n">acl</span> <span class="n">letsencrypt_http_acl</span> <span class="n">path_beg</span> /.<span class="n">well</span>-<span class="n">known</span>/<span class="n">acme</span>-<span class="n">challenge</span>/

 <span class="n">redirect</span> <span class="n">scheme</span> <span class="n">https</span> <span class="n">if</span> !<span class="n">letsencrypt_http_acl</span> !<span class="n">transport_http_acl</span> { <span class="n">env</span>(<span class="n">FORCE_HTTPS_REDIRECT</span>) -<span class="n">m</span> <span class="n">str</span> <span class="n">true</span> }

 <span class="n">use_backend</span> <span class="n">letsencrypt_http</span> <span class="n">if</span> <span class="n">letsencrypt_http_acl</span>
 <span class="n">use_backend</span> <span class="n">tb</span>-<span class="n">http</span>-<span class="n">backend</span> <span class="n">if</span> <span class="n">transport_http_acl</span>
 <span class="n">use_backend</span> <span class="n">tb</span>-<span class="n">web</span>-<span class="n">backend</span> <span class="n">if</span> <span class="n">acl_static</span> !<span class="n">acl_static_rulenode</span>

 <span class="n">default_backend</span> <span class="n">tb</span>-<span class="n">api</span>-<span class="n">backend</span>

<span class="n">frontend</span> <span class="n">https_in</span>
  <span class="n">bind</span> *:${<span class="n">HTTPS_PORT</span>} <span class="n">ssl</span> <span class="n">crt</span> /<span class="n">usr</span>/<span class="n">local</span>/<span class="n">etc</span>/<span class="n">haproxy</span>/<span class="n">default</span>.<span class="n">pem</span> <span class="n">crt</span> /<span class="n">usr</span>/<span class="n">local</span>/<span class="n">etc</span>/<span class="n">haproxy</span>/<span class="n">certs</span>.<span class="n">d</span> <span class="n">ciphers</span> <span class="n">ECDHE</span>-<span class="n">RSA</span>-<span class="n">AES256</span>-<span class="n">SHA</span>:<span class="n">RC4</span>-<span class="n">SHA</span>:<span class="n">RC4</span>:<span class="n">HIGH</span>:!<span class="n">MD5</span>:!<span class="n">aNULL</span>:!<span class="n">EDH</span>:!<span class="n">AESGCM</span>

  <span class="n">option</span> <span class="n">forwardfor</span>

  <span class="n">reqadd</span> <span class="n">X</span>-<span class="n">Forwarded</span>-<span class="n">Proto</span>:\ <span class="n">https</span>

  <span class="n">acl</span> <span class="n">transport_http_acl</span> <span class="n">path_beg</span> /<span class="n">api</span>/<span class="n">v1</span>/

  <span class="n">acl</span> <span class="n">acl_static</span> <span class="n">path_beg</span> /<span class="n">static</span>/ /<span class="n">index</span>.<span class="n">html</span>
  <span class="n">acl</span> <span class="n">acl_static</span> <span class="n">path</span> /
  <span class="n">acl</span> <span class="n">acl_static_rulenode</span> <span class="n">path_beg</span> /<span class="n">static</span>/<span class="n">rulenode</span>/

  <span class="n">use_backend</span> <span class="n">tb</span>-<span class="n">http</span>-<span class="n">backend</span> <span class="n">if</span> <span class="n">transport_http_acl</span>
  <span class="n">use_backend</span> <span class="n">tb</span>-<span class="n">web</span>-<span class="n">backend</span> <span class="n">if</span> <span class="n">acl_static</span> !<span class="n">acl_static_rulenode</span>

  <span class="n">default_backend</span> <span class="n">tb</span>-<span class="n">api</span>-<span class="n">backend</span>

<span class="n">backend</span> <span class="n">letsencrypt_http</span>
  <span class="n">server</span> <span class="n">letsencrypt_http_srv</span> <span class="m">127</span>.<span class="m">0</span>.<span class="m">0</span>.<span class="m">1</span>:<span class="m">8080</span>

<span class="n">backend</span> <span class="n">tb</span>-<span class="n">web</span>-<span class="n">backend</span>
  <span class="n">balance</span> <span class="n">leastconn</span>
  <span class="n">option</span> <span class="n">tcp</span>-<span class="n">check</span>
  <span class="n">option</span> <span class="n">log</span>-<span class="n">health</span>-<span class="n">checks</span>
  <span class="n">server</span> <span class="n">tbWeb1</span> <span class="n">tb</span>-<span class="n">web</span>-<span class="n">ui1</span>:<span class="m">8080</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
  <span class="n">server</span> <span class="n">tbWeb2</span> <span class="n">tb</span>-<span class="n">web</span>-<span class="n">ui2</span>:<span class="m">8080</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
  <span class="n">http</span>-<span class="n">request</span> <span class="n">set</span>-<span class="n">header</span> <span class="n">X</span>-<span class="n">Forwarded</span>-<span class="n">Port</span> %[<span class="n">dst_port</span>]

<span class="n">backend</span> <span class="n">tb</span>-<span class="n">http</span>-<span class="n">backend</span>
  <span class="n">balance</span> <span class="n">leastconn</span>
  <span class="n">option</span> <span class="n">tcp</span>-<span class="n">check</span>
  <span class="n">option</span> <span class="n">log</span>-<span class="n">health</span>-<span class="n">checks</span>
  <span class="n">server</span> <span class="n">tbHttp1</span> <span class="n">tb</span>-<span class="n">http</span>-<span class="n">transport1</span>:<span class="m">8081</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
  <span class="n">server</span> <span class="n">tbHttp2</span> <span class="n">tb</span>-<span class="n">http</span>-<span class="n">transport2</span>:<span class="m">8081</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>

<span class="n">backend</span> <span class="n">tb</span>-<span class="n">api</span>-<span class="n">backend</span>
  <span class="n">balance</span> <span class="n">leastconn</span>
  <span class="n">option</span> <span class="n">tcp</span>-<span class="n">check</span>
  <span class="n">option</span> <span class="n">log</span>-<span class="n">health</span>-<span class="n">checks</span>
  <span class="n">server</span> <span class="n">tbApi1</span> <span class="n">tb1</span>:<span class="m">8080</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
  <span class="n">server</span> <span class="n">tbApi2</span> <span class="n">tb2</span>:<span class="m">8080</span> <span class="n">check</span> <span class="n">inter</span> <span class="m">5</span><span class="n">s</span> <span class="n">resolvers</span> <span class="n">docker_resolver</span> <span class="n">resolve</span>-<span class="n">prefer</span> <span class="n">ipv4</span>
  <span class="n">http</span>-<span class="n">request</span> <span class="n">set</span>-<span class="n">header</span> <span class="n">X</span>-<span class="n">Forwarded</span>-<span class="n">Port</span> %[<span class="n">dst_port</span>]
</pre></td></tr></tbody></table></code></pre></div>  </div>
</figure>

<h3 id="databases">Databases</h3>

<p>See “<a href="/docs/reference/#sql-vs-nosql-vs-hybrid-database-approach">SQL vs NoSQL vs Hybrid?</a>” for more details.</p>

<h2 id="deployment">Deployment</h2>

<p>You can find the reference <a href="https://github.com/thingsboard/thingsboard/blob/release-2.5/docker/docker-compose.yml">docker-compose.yml</a>
and corresponding <a href="https://github.com/thingsboard/thingsboard/blob/master/docker/README.md">documentation</a> that will help you to run ThingsBoard containers in a cluster mode 
(although on a single host machine)</p>

<p>TODO: 2.5</p>

<figure class="highlight">
  <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
</pre></td><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2.2'</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">zookeeper</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">zookeeper:3.5"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">2181"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">ZOO_MY_ID</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">ZOO_SERVERS</span><span class="pi">:</span> <span class="s">server.1=zookeeper:2888:3888;zookeeper:2181</span>
  <span class="na">kafka</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">wurstmeister/kafka"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">9092:9092"</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka.env</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">zookeeper</span>
  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">redis:4.0</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">6379"</span>
  <span class="na">tb-js-executor</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${JS_EXECUTOR_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">scale</span><span class="pi">:</span> <span class="m">20</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-js-executor.env</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb1</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${TB_NODE_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080"</span>
    <span class="na">logging</span><span class="pi">:</span>
      <span class="na">driver</span><span class="pi">:</span> <span class="s2">"</span><span class="s">json-file"</span>
      <span class="na">options</span><span class="pi">:</span>
        <span class="na">max-size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">200m"</span>
        <span class="na">max-file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb1</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb1</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-node.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-node/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-node/log:/var/log/thingsboard</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
      <span class="pi">-</span> <span class="s">redis</span>
      <span class="pi">-</span> <span class="s">tb-js-executor</span>
  <span class="na">tb2</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${TB_NODE_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080"</span>
    <span class="na">logging</span><span class="pi">:</span>
      <span class="na">driver</span><span class="pi">:</span> <span class="s2">"</span><span class="s">json-file"</span>
      <span class="na">options</span><span class="pi">:</span>
        <span class="na">max-size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">200m"</span>
        <span class="na">max-file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb2</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb2</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-node.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-node/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-node/log:/var/log/thingsboard</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
      <span class="pi">-</span> <span class="s">redis</span>
      <span class="pi">-</span> <span class="s">tb-js-executor</span>
  <span class="na">tb-mqtt-transport1</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${MQTT_TRANSPORT_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">1883"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb-mqtt-transport1</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb-mqtt-transport1</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-mqtt-transport.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-transports/mqtt/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-transports/mqtt/log:/var/log/tb-mqtt-transport</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb-mqtt-transport2</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${MQTT_TRANSPORT_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">1883"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb-mqtt-transport2</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb-mqtt-transport2</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-mqtt-transport.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-transports/mqtt/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-transports/mqtt/log:/var/log/tb-mqtt-transport</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb-http-transport1</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${HTTP_TRANSPORT_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8081"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb-http-transport1</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb-http-transport1</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-http-transport.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-transports/http/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-transports/http/log:/var/log/tb-http-transport</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb-http-transport2</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${HTTP_TRANSPORT_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8081"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb-http-transport2</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb-http-transport2</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-http-transport.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-transports/http/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-transports/http/log:/var/log/tb-http-transport</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb-coap-transport</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${COAP_TRANSPORT_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5683-5688:5683-5688/udp"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">TB_HOST</span><span class="pi">:</span> <span class="s">tb-coap-transport</span>
      <span class="na">CLUSTER_NODE_ID</span><span class="pi">:</span> <span class="s">tb-coap-transport</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-coap-transport.env</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./tb-transports/coap/conf:/config</span>
      <span class="pi">-</span> <span class="s">./tb-transports/coap/log:/var/log/tb-coap-transport</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">kafka</span>
  <span class="na">tb-web-ui1</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${WEB_UI_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080"</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-web-ui.env</span>
  <span class="na">tb-web-ui2</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${DOCKER_REPO}/${WEB_UI_DOCKER_NAME}:${TB_VERSION}"</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8080"</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">tb-web-ui.env</span>
  <span class="na">haproxy</span><span class="pi">:</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${LOAD_BALANCER_NAME}"</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">xalauc/haproxy-certbot:1.7.9</span>
    <span class="na">volumes</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="s">./haproxy/config:/config</span>
     <span class="pi">-</span> <span class="s">./haproxy/letsencrypt:/etc/letsencrypt</span>
     <span class="pi">-</span> <span class="s">./haproxy/certs.d:/usr/local/etc/haproxy/certs.d</span>
    <span class="na">ports</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>
     <span class="pi">-</span> <span class="s2">"</span><span class="s">443:443"</span>
     <span class="pi">-</span> <span class="s2">"</span><span class="s">1883:1883"</span>
     <span class="pi">-</span> <span class="s2">"</span><span class="s">9999:9999"</span>
    <span class="na">cap_add</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="s">NET_ADMIN</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">HTTP_PORT</span><span class="pi">:</span> <span class="m">80</span>
      <span class="na">HTTPS_PORT</span><span class="pi">:</span> <span class="m">443</span>
      <span class="na">MQTT_PORT</span><span class="pi">:</span> <span class="m">1883</span>
      <span class="na">FORCE_HTTPS_REDIRECT</span><span class="pi">:</span> <span class="s2">"</span><span class="s">false"</span>
    <span class="na">links</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">tb1</span>
        <span class="pi">-</span> <span class="s">tb2</span>
        <span class="pi">-</span> <span class="s">tb-web-ui1</span>
        <span class="pi">-</span> <span class="s">tb-web-ui2</span>
        <span class="pi">-</span> <span class="s">tb-mqtt-transport1</span>
        <span class="pi">-</span> <span class="s">tb-mqtt-transport2</span>
        <span class="pi">-</span> <span class="s">tb-http-transport1</span>
        <span class="pi">-</span> <span class="s">tb-http-transport2</span>
</pre></td></tr></tbody></table></code></pre></div>  </div>
</figure>


      </div>
      <footer>
	<main class="light-text">
		<div class="newsletterSubsContainer">
            <script type="text/javascript">
                function subscribeForNewsletter(event) {
                    event.stopPropagation();
                    var script_tag = document.createElement('script');
                    script_tag.setAttribute("type", "text/javascript");
                    script_tag.setAttribute("src", "https://static.mailerlite.com/js/w/webforms.min.js?v28bf44f740701752bfc6767bc7e171d4");
                    document.getElementsByTagName("head")[0].appendChild(script_tag);
                    $(event.target).css('display', 'none');
                    $('#mlb2-7341216').css('display', 'block');
                }
            </script>
            <button class="n-button price subscribe" onClick="subscribeForNewsletter(event)">Sign up for ThingsBoard news</button>
            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: none;">
<!--            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: block;">-->
                <div class="ml-vertical-align-center">
                    <div class="subscribe-form ml-block-success" style="display: none;">
                        <div class="form-section">
                            <p>Thank you for your interest in ThingsBoard!<br/>Have a great day!</p>
                        </div>
                    </div>
                    <form class="ml-block-form" action="https://static.mailerlite.com/webforms/submit/r9r9x7" data-id="708170" data-code="r9r9x7" method="POST" target="_blank">
                        <div class="subscribe-form horizontal">
                            <div class="form-section horizontal">
                                <div class="form-group ml-field-email ml-validate-required ml-validate-email">
                                    <input type="email" name="fields[email]" class="form-control" placeholder="Email address*" value="" autocomplete="email" x-autocompletetype="email" spellcheck="false" autocapitalize="off" autocorrect="off">
                                </div>
                            </div>
                            <input type="hidden" name="ml-submit" value="1">
                            <div class="form-section horizontal ml-button-position">
                                <button class="primary n-button price subscribe" type="submit">
                                    Subscribe
                                </button>
                                <button disabled="disabled" style="display: none;" type="button" class="n-button loading">
                                    <img src="https://static.mailerlite.com/images/rolling@2x.gif" width="20" height="20" style="width: 20px; height: 20px;">
                                </button>
                            </div>
                            <p>By subscribing you agree to receive newsletters from ThingsBoard, Inc.</p>
                        </div>
                    </form>
                </div>
            </div>
		</div>

        <hr>

        <div class="deeper">
            <a href="/" class="footer-logo"></a>
            <nav>
                <a href="/docs/getting-started-guides/helloworld/">Get Started</a>
                <a href="/docs/">Documentation</a>
                <a href="/iot-use-cases/">Use cases</a>
                <a href="https://blog.thingsboard.io/">Blog</a>
                <a href="/docs/services/">Services</a>
                <a href="/docs/contact-us/">Contact us</a>
            </nav>
        </div>

        <div class="deepmost">
            <div class="copyright">&copy; 2021 The ThingsBoard Authors</div>
            <div class="social">
                <a href="https://github.com/thingsboard/thingsboard" class="github"></a>
                <a href="https://gitter.im/thingsboard/chat" class="gitter"></a>
                <a href="https://www.youtube.com/thingsboard" class="youtube"></a>
                <a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"></a>
                <a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"></a>
                <a href="https://www.facebook.com/thingsboard" class="facebook"></a>
                <a href="https://twitter.com/thingsboard" class="twitter"></a>
            </div>
        </div>
	</main>
</footer>

  </div>
</section>

<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
<script>
    jqueryDefer(function () {
        $(document).on('selectionchange',function() {
        // $(document).mouseup(function () {
            $('.clipboard-btn').removeClass('noChars');
            var selectedChars = getSelectedText();
            // $('#numberChars').html(selectedChars.length);
            if (selectedChars == 0) {
                $('.clipboard-btn').addClass('noChars');
            }
        });
    });
    function getSelectedText() {
        var text;
        if (window.getSelection) {
            text = window.getSelection().toString();
        } else if (document.getSelection) {
            text = document.getSelection();
        } else if (document.selection) {
            text = document.selection.createRange().text;
        }
        return text;
    }
</script>
<script>
    jqueryDefer(function () {
        $(document).ready(function () {
            var allCodeBlocksElements = $(".copy-code");
            allCodeBlocksElements.each(function (i) {
                var codeBlock = $(this);
                if (!codeBlock.hasClass('highlighter-rouge')) {
                    codeBlock = codeBlock.find('.highlighter-rouge');
                }
                codeBlock.each(function () {
                    var block = codeBlock.find('pre.highlight > code .rouge-code');
                    var currentId = "codeblock" + (i + 1);
                    block.attr('id', currentId);
                    var clipButton = $('<button class="clipboard-btn" data-clipboard-target="#' + currentId + '"><p>Copy to clipboard</p><div><img src="/images/copy-code-icon.svg" alt="Copy to clipboard"></div></button>');
                    $(this).append(clipButton);
                    var troyan = codeBlock.find('pre.highlight');
                    var Tooltip = $('<div class="customTooltip"><div class="tooltipText">Copied!</div></div>');
                    troyan.append(Tooltip);
                    troyan.addClass('clipboard-btn');
                    troyan.attr('data-clipboard-target', "#" + currentId);
                    troyan.on('mouseleave', clearTooltip);
                    troyan.on('blur', clearTooltip);
                    troyan.on('click', function(e) {
                        var el = $(e.currentTarget);
                        if (el.hasClass('showTool')) {
                            clearTooltip(e);
                            troyan.attr('data-skip-tooltip', "true");
                        }
                    });
                });
            });

            var clipboard = new Clipboard('.noChars');
            clipboard.on('success', function (e) {
                $('.clipboard-btn').removeClass('noChars');
                e.clearSelection();
                var trigger = e.trigger;
                if (!$(trigger).attr('data-skip-tooltip')) {
                    showTooltip(e.trigger, 'Copied!');
                } else {
                    $(trigger).removeAttr('data-skip-tooltip');
                }
            });

            $('#search').focus(
                function(){
                    $(this).parent('#searchBox').addClass('focused');
                }).blur(
                function(){
                    $(this).parent('#searchBox').removeClass('focused');
                });

            $('#searchBox .searchButton').click(function () {
                var value = $('#search').val();
                window.location.replace('/docs/search/?q=' + value);
            });

            $('#docsBreadcrumbs').click(function () {
                if ($(this).hasClass('active')) {
                    $(this).removeClass('active');
                    $('#docsNav').removeClass('active');
                    $('#searchBox').removeClass('visible');
                } else {
                    $(this).addClass('active');
                    $('#docsNav').addClass('active');
                    $('#searchBox').addClass('visible');
                }
            });
        });

        function clearTooltip(e) {
            var el = $(e.currentTarget);
            el.removeClass('showTool');
            el.attr('aria-label', null);
        }

        function showTooltip(elem, msg) {
            var el = $(elem);
            el.addClass('showTool');
            el.attr('aria-label', msg);
        }
    });
</script>

<script>
    jqueryDefer(function () {
        var markdownTocs = null;
        var contentAnchors = [];
        var activeAnchor = null;
        var firstAnchor = null;
        var lastAnchor = null;

        function updatePositions() {
            contentAnchors = [];
            markdownTocs.each(function (i) {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                var contentAnchor = $('div#content ' + href);
                var top = Math.floor(contentAnchor.offset().top);
                var bottom;
                if (i < markdownTocs.length - 1) {
                    var nextHref = $(markdownTocs[i + 1]).children('a').attr('href');
                    var nextContentAnchor = $('div#content ' + nextHref);
                    bottom = Math.floor(nextContentAnchor.offset().top);
                } else {
                    bottom = $('div#content').offset().top + $('div#content').innerHeight();
                }
                var contentAnchorInfo = {anchor: contentAnchor, toc: $(this), top: top, bottom: bottom, href: href};
                contentAnchors.push(contentAnchorInfo);
                if (i === 0) {
                    firstAnchor = contentAnchorInfo;
                }
                if (i === markdownTocs.length - 1) {
                    lastAnchor = contentAnchorInfo;
                }
            });
        }

        function findActiveContentToc() {
            var top = $(window).scrollTop();
            var bottom = top + $(window).height();
            if (bottom === $('#encyclopedia').offset().top + $('#encyclopedia').innerHeight()) {
                return lastAnchor;
            } else {
                bottom -= 154;
                for (var i = 0; i < contentAnchors.length; i++) {
                    var contentAnchor = contentAnchors[i];
                    if (contentAnchor.top <= bottom &&
                        contentAnchor.bottom > top) {
                        return contentAnchor;
                    }
                }
            }
            return firstAnchor;
        }

        function updateActiveToc(init) {
            updatePositions();
            var newActiveAnchor = findActiveContentToc();
            if (!activeAnchor || newActiveAnchor.href !== activeAnchor.href) {
                activeAnchor = newActiveAnchor;
                markdownTocs.removeClass('active');
                activeAnchor.toc.addClass('active');
                var tocTop = $('#table-of-contents').scrollTop() + 100;
                var tocBottom = tocTop + $('#table-of-contents').innerHeight() - 200;
                var activeTocTop = activeAnchor.toc.position().top;
                var activeTocBottom = activeTocTop + activeAnchor.toc.children(':first').height();
                if (tocTop > activeTocTop) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop -= 100;
                } else if (tocBottom < activeTocBottom) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop += init ? -100 : 100;
                }
            }
        }
        $( document ).ready(function() {
            var tocs = $('#content > ul#markdown-toc');
            var tableOfContents = $('#table-of-contents');
            tableOfContents.append(tocs);
            markdownTocs = $('#table-of-contents ul#markdown-toc li').filter(function() {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                if (!href.startsWith('#')) {
                    return false;
                } else {
                    var contentAnchor = $('div#content ' + href);
                    return contentAnchor.length > 0;
                }
            });
            updateActiveToc(true);
        });

        $(document).on("scroll", function() {
            updateActiveToc(false);
        });

    });
</script>

</body>
</html>

