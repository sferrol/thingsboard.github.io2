







<!Doctype html>
<html id="docs" class="ThingsBoard Professional Edition Documentation">







<head>
    <meta charset="utf-8">
    <meta name="cf-2fa-verify" content="a08672380de15e9">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Widgets Development Guide | ThingsBoard Professional Edition</title>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Widgets Development Guide" />
<meta name="author" content="thingsboard" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://0.0.0.0:4002/docs/pe/user-guide/contribution/widgets-development/" />
<meta property="og:url" content="http://0.0.0.0:4002/docs/pe/user-guide/contribution/widgets-development/" />
<meta property="og:site_name" content="ThingsBoard" />
<meta property="og:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta property="twitter:title" content="Widgets Development Guide" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4002/docs/pe/user-guide/contribution/widgets-development/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4002/images/thingsboard_logo.png"},"name":"thingsboard"},"author":{"@type":"Person","name":"thingsboard"},"image":{"twitter":"/images/thingsboard_logo.png","facebook":"/images/thingsboard_logo.png","url":"http://0.0.0.0:4002/images/thingsboard_logo.png","@type":"imageObject"},"@type":"WebPage","headline":"Widgets Development Guide","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
    
    
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.7.0/qs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gifffer/1.5.0/gifffer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <script type="text/javascript">
        window.onload = function() {
            Gifffer();
        }
    </script>
    <script type="text/javascript">
        /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
        !function (a) {
            "use strict";
            var b = function (b, c, d) {
                function e(a) {
                    return h.body ? a() : void setTimeout(function () {
                        e(a)
                    })
                }

                function f() {
                    i.addEventListener && i.removeEventListener("load", f), i.media = d || "all"
                }

                var g, h = a.document, i = h.createElement("link");
                if (c) g = c; else {
                    var j = (h.body || h.getElementsByTagName("head")[0]).childNodes;
                    g = j[j.length - 1]
                }
                var k = h.styleSheets;
                i.rel = "stylesheet", i.href = b, i.media = "only x", e(function () {
                    g.parentNode.insertBefore(i, c ? g : g.nextSibling)
                });
                var l = function (a) {
                    for (var b = i.href, c = k.length; c--;) if (k[c].href === b) return a();
                    setTimeout(function () {
                        l(a)
                    })
                };
                return i.addEventListener && i.addEventListener("load", f), i.onloadcssdefined = l, l(f), i
            };
            "undefined" != typeof exports ? exports.loadCSS = b : a.loadCSS = b
        }("undefined" != typeof global ? global : this);

        /*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
        function onloadCSS(a, b) {
            function c() {
                !d && b && (d = !0, b.call(a))
            }

            var d;
            a.addEventListener && a.addEventListener("load", c), a.attachEvent && a.attachEvent("onload", c), "isApplicationInstalled" in navigator && "onloadcssdefined" in a && a.onloadcssdefined(c)
        }
    </script>
    <script type="text/javascript">

        function jqueryDefer(method) {
            if (window.jQuery) {
                method();
            } else {
                setTimeout(function () {
                    jqueryDefer(method)
                }, 50);
            }
        }

        function jqueryUiDefer(method) {
            if (window.jQuery && window.jQuery.ui) {
                method();
            } else {
                setTimeout(function () {
                    jqueryUiDefer(method)
                }, 50);
            }
        }

        window.vis = (function () {
            var stateKey,
                eventKey,
                keys = {
                    hidden: "visibilitychange",
                    webkitHidden: "webkitvisibilitychange",
                    mozHidden: "mozvisibilitychange",
                    msHidden: "msvisibilitychange"
                };
            for (stateKey in keys) {
                if (stateKey in document) {
                    eventKey = keys[stateKey];
                    break;
                }
            }
            return function (c) {
                if (c) document.addEventListener(eventKey, c);
                return !document[stateKey];
            }
        })();

        function loadScript(src, callback) {
            var s, r, t;
            r = false;
            s = document.createElement('script');
            s.type = 'text/javascript';
            s.src = src;
            s.onload = s.onreadystatechange = function () {
                if (!r && (!this.readyState || this.readyState == 'complete')) {
                    r = true;
                    if (callback) {
                        callback();
                    }
                }
            };
            t = document.getElementsByTagName('script')[0];
            t.parentNode.insertBefore(s, t);
        }

        function loadCssAsync(src, callback) {
            var stylesheet = loadCSS(src);
            if (callback) {
                onloadCSS(stylesheet, callback);
            }
        }

        function loadNextScript(index, scriptsList, completeCallback) {
            if (index < scriptsList.length) {
                var script = scriptsList[index];
                if (script.type === 'script') {
                    loadScript(script.src, function () {
                        if (script.callback) {
                            script.callback();
                        }
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                } else if (script.type === 'css') {
                    loadCssAsync(script.src, function () {
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                }
            } else if (completeCallback) {
                completeCallback();
            }
        }

        var initialScriptsList = [
            {src: '/js/jquery-2.2.0.min.js', type: 'script'},
            {src: '/css/jquery-ui.min.css', type: 'css'},
            {src: '/js/jquery-ui.min.js', type: 'script'},
            {src: '/js/jquery.vide.js', type: 'script'},
            {src: '/js/script.js', type: 'script'},
            {src: '/css/photoswipe.css', type: 'css'},
            {src: '/css/default-skin/default-skin.css', type: 'css'},
            {src: '/js/photoswipe.min.js', type: 'script'},
            {src: '/js/photoswipe-ui-default.min.js', type: 'script'}
        ];

        loadNextScript(0, initialScriptsList);

        jqueryDefer(function () {
            (function ($, win) {
                $.fn.inViewport = function (cb) {
                    return this.each(function (i, el) {
                        function visPx() {
                            var H = $(this).height(),
                                r = el.getBoundingClientRect(), t = r.top, b = r.bottom;
                            var result = cb.call(el, Math.max(0, t > 0 ? H - t : (b < H ? b : H)));
                            if (result) {
                                $(win).off("resize scroll", visPx);
                            }
                        }

                        visPx();
                        $(win).on("resize scroll", visPx);
                    });
                };
            }(jQuery, window));
        });

        function inViewportDefer(method) {
            if (window.jQuery && $.fn.inViewport) {
                method();
            } else {
                setTimeout(function () {
                    inViewportDefer(method)
                }, 50);
            }
        }

    </script>
    <script type="text/javascript">
        function _gaLt(event) {
            /* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
            if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
                return;
            }
            var el = event.srcElement || event.target;

            while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
                el = el.parentNode;
            }
            if (el && el.href) {
                var link = el.href;
                if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
                    var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
                        target = "_blank";
                    }

                    var hbrun = false; // tracker has not yet run
                    var hitBack = function () {
                        if (hbrun) return;
                        hbrun = true;
                        window.location.href = link;
                    };

                    if (target) {
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search
                        );
                    } else {
                        event.preventDefault ? event.preventDefault() : event.returnValue = !1;
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search, {
                                "hitCallback": hitBack
                            }
                        );

                        setTimeout(hitBack, 1000);
                    }
                }
            }
        }

        var _w = window;
        var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
        _w.addEventListener ? _w.addEventListener("load", function () {
                document.body.addEventListener(_gaLtEvt, _gaLt, !1)
            }, !1)
            : _w.attachEvent && _w.attachEvent("onload", function () {
            document.body.attachEvent("on" + _gaLtEvt, _gaLt)
        });
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-88383331-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script>
        function Burger() {
            var header = $('header');
            var body = $('body');
            if (header.hasClass('opened-burger')) {
                header.removeClass('opened-burger');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                body.css('overflow', '');
            } else {
                header.addClass('opened-burger');
                body.css('overflow', 'hidden');
            }
        }
    </script>
    <script>

        jqueryDefer(function () {
            let menuElement = $('nav.head-menu > ul');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            let menuItems = $('nav.head-menu > ul > li');
            let indicator = $('nav.head-menu > ul > div.indicator');
            let subMenuActive = false;
            menuElement.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('div.sub-menu-container').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            submenuContainer.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('nav.head-menu > ul').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            menuItems.each(function() {
                let item = $( this );
                let subMenuId = item.attr('data-submenu-id');
                item.on('mouseenter', function () {
                    let submenus = $('nav.head-menu > div.sub-menu-container > div');
                    submenus.css('display', 'none');
                    menuItems.removeClass('active');
                    item.addClass('active');
                    let targetSubMenu = $('nav.head-menu > div.sub-menu-container > div#'+subMenuId);
                    targetSubMenu.css('display', 'block');
                    submenuContainer.css('overflow', 'visible');
                    let left = item.position().left + (item.outerWidth() - targetSubMenu.outerWidth()) / 2;
                    submenuContainer.css('left', left + 'px');
                    if (!subMenuActive) {
                        submenuContainer.addClass('active');
                        subMenuActive = true;
                    } else {
                        submenuContainer.addClass('bounds-transition');
                        indicator.addClass('left-transition');
                    }
                    indicator.css('left', item.position().left);
                    indicator.css('width', item.outerWidth());
                    submenuContainer.css('height', targetSubMenu.outerHeight() + 'px');
                    submenuContainer.css('width', targetSubMenu.outerWidth() + 'px');
                    submenuContainer.css('overflow', 'hidden');
                });
            });

            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                initMobileSubmenu();
            }

            $(window).resize(function(){
                let newIsMobile = $('button.burger').css('display') === 'block';
                if (isMobile !== newIsMobile) {
                    isMobile = newIsMobile;
                    if (isMobile) {
                        initMobileSubmenu();
                    } else {
                        restoreDesktopSubmenu();
                    }
                }
            });

            // Products selector

            
            let productsSelector = $('.products-selector');
            $(window).click(function(e) {
                if (productsSelector[0].contains(e.target)) {
                    if (productsSelector.hasClass('active')) {
                        productsSelector.removeClass('active');
                    } else {
                        productsSelector.addClass('active');
                    }
                } else {
                    productsSelector.removeClass('active');
                }
            });
            

            // Rogue line numbers fix (don't show line numbers for 1 row)
            $( document ).ready(function() {
                $('.rouge-gutter.gl').each(function() {
                    var lineNumbers = $(this).children('.lineno');
                    if (lineNumbers.text() === '1\n') {
                        $(this).css('display', 'none');
                    }
                });
            });
        });

        function initMobileSubmenu() {

            var header = $('header');
            if (header.hasClass('opened-burger')) {
                var body = $('body');
                body.css('overflow', 'hidden');
            }

            let targetSubMenus = $('nav.head-menu > div.sub-menu-container > div');
            targetSubMenus.css('display', 'block');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'none');

            targetSubMenus.each(function() {
                let subMenu = $( this );
                let subMenuId = subMenu.attr('id');
                let parent = $('nav.head-menu > ul > li.'+subMenuId);
                parent.append(subMenu);
            });
        }

        function restoreDesktopSubmenu() {
            var body = $('body');
            body.css('overflow', '');
            let targetSubMenus = $('nav.head-menu > ul > li > div');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'block');
            let menuItems = $('nav.head-menu > ul > li');
            menuItems.removeClass('active');
            targetSubMenus.each(function() {
                let subMenu = $( this );
                submenuContainer.append(subMenu);
            });
        }

        function listburg(subMenuId) {
            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                let targetSubMenu = $('nav.head-menu > ul > li > div.centered-sub#'+subMenuId+' > ul.sub-menu');
                let isOpen = targetSubMenu.hasClass('open-sub');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                if (!isOpen) {
                    targetSubMenu.addClass('open-sub');
                }
            }
        }
    </script>
</head>
<body>

<div class="products-selector">
    <img src="/images/thingsboard-p-icon.svg"/>
    <div class="product-info">
        <div class="product-title">
            Professional Edition
        </div>
        <div class="product-description">
            ThingsBoard Documentation
        </div>
    </div>
    <div class="products">
        
        

    
        
        


        
            
        
    


        <a href="/docs/paas/user-guide/contribution/widgets-development/" class="product">Cloud</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/pe/user-guide/contribution/widgets-development/" class="product active">Professional Edition</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/user-guide/contribution/widgets-development/" class="product">Community Edition</a>
        
        

    


        <a href="/docs/edge/" class="product">Edge</a>
        
        

    


        <a href="/docs/iot-gateway/" class="product">IoT Gateway</a>
        
        

    


        <a href="/products/license-server/" class="product">License Server</a>
        
        

    


        <a href="/docs/trendz/" class="product">Trendz Analytics</a>
        
    </div>
</div>

<header>
    <div class="logo-burger">
        
        <button onclick="Burger()" class="burger"></button>
        <div id="githubButtonContainer">
            <a class="github-button" href="https://github.com/thingsboard/thingsboard" data-show-count="true"
               aria-label="Star thingsboard/thingsboard on GitHub">Star</a>
        </div>
    </div>
    <nav class="head-menu">
        <ul>
            <li class="nav-products" data-submenu-id="nav-products">
                <a onclick="listburg('nav-products')">Products</a>
            </li>
            <li class="nav-services" data-submenu-id="nav-services">
                <a onclick="listburg('nav-services')">Services</a>
            </li>
            
            <li class="nav-cases" data-submenu-id="nav-cases">
                <a onclick="listburg('nav-cases')">Use Cases</a>
            </li>
            <li class="nav-customers" data-submenu-id="nav-customers">
                <a onclick="listburg('nav-customers')">Customers</a>
            </li>
            <li class="nav-company" data-submenu-id="nav-company">
                <a onclick="listburg('nav-company')">Company</a>
            </li>
            <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
        </ul>
        <div class="sub-menu-container">
            <div id="nav-products" class="centered-sub">
                <ul class="sub-menu products">
                    <div class="sub-groups">
                        <div class="group">
                            <p class="group-name">IoT platforms</p>
                            <a class="cloud-lnk" href="/products/paas/">
                                <img src="/images/thingsboard-c-icon.svg">
                                <div class="sub-text">
                                    <h1>Cloud</h1>
                                    <p>Platform as a service</p>
                                </div>
                            </a>
                            <a class="prof-lnk" href="/products/thingsboard-pe/">
                                <img src="/images/thingsboard-p-icon.svg">
                                <div class="sub-text">
                                    <h1>Professional Edition</h1>
                                    <p>Advanced IoT platform</p>
                                </div>
                            </a>
                            <a class="com-lnk" href="/">
                                <img src="/images/thingsboard-cm-icon.svg">
                                <div class="sub-text">
                                    <h1>Community Edition</h1>
                                    <p>Open source platform</p>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <p class="group-name">Product ecosystem</p>
                            <a class="edge-lnk" href="/products/thingsboard-edge/">
                                <img src="/images/thingsboard-e-icon.svg">
                                <div class="sub-text">
                                    <h1>Edge</h1>
                                    <p>Edge computing</p>
                                </div>
                            </a>
                            <a class="gateway-lnk" href="/docs/iot-gateway/what-is-iot-gateway/">
                                <img src="/images/gateway-icon.svg">
                                <div class="sub-text">
                                    <h1>IoT Gateway</h1>
                                    <p>Connect legacy protocols</p>
                                </div>
                            </a>
                            <a class="license-lnk" href="/products/license-server/">
                                <img src="/images/license-icon.svg">
                                <div class="sub-text">
                                    <h1>License Server</h1>
                                    <p>Billing solution</p>
                                </div>
                            </a>
                            <a class="trendz-lnk" href="/products/trendz/">
                                <img src="/images/trendz-icon.svg">
                                <div class="sub-text">
                                    <h1>Trendz Analytics</h1>
                                    <p>Data analytics and Prediction</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-services" class="centered-sub">
                <ul class="sub-menu services">
                    <a href="/docs/services/support/">
                        <img src="/images/support-icon.svg">
                        <div class="sub-text">
                            <h1>Support</h1>
                            <p>Support packages</p>
                        </div>
                    </a>
                    <a href="/docs/services/trainings/">
                        <img src="/images/train-icon.svg">
                        <div class="sub-text">
                            <h1>Trainings</h1>
                            <p>ThingsBoard education courses</p>
                        </div>
                    </a>
                    <a href="/docs/services/consulting/">
                        <img src="/images/prof-icon.svg">
                        <div class="sub-text">
                            <h1>Professional services</h1>
                            <p>Development of solutions by the ThingsBoard team</p>
                        </div>
                    </a>
                </ul>
            </div>
            
            <div id="nav-cases" class="centered-sub">
                <ul class="sub-menu cases">
                    <a href="/smart-metering/">
                        <img src="/images/case-met-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Metering</h1>
                            <p>Collection, analysis and visualization of data from meters</p>
                        </div>
                    </a>
                    <a href="/smart-energy/">
                        <img src="/images/case-eng-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Energy</h1>
                            <p>Energy monitoring and efficiency analysis</p>
                        </div>
                    </a>
                    <a href="/smart-farming/">
                        <img src="/images/case-fam-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Farming</h1>
                            <p>Monitoring of indoor conditions and plant growth characteristics</p>
                        </div>
                    </a>
                    <a href="/fleet-tracking/">
                        <img src="/images/case-trk-icon.svg">
                        <div class="sub-text">
                            <h1>Fleet Tracking</h1>
                            <p>Fleet tracking and fleet management</p>
                        </div>
                    </a>
                </ul>
            </div>
            <div id="nav-customers" class="centered-sub">
                <ul class="sub-menu customers">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/industries/smart-energy/">
                                <img src="/images/se-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Energy</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/agriculture/">
                                <img src="/images/agr-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Agriculture</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/smart-buildings/">
                                <img src="/images/sb-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Buildings</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/industries/smart-city/">
                                <img src="/images/sc-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart City</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/telecom/">
                                <img src="/images/tel-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Telecom</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/industry40/">
                                <img src="/images/in-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Industry 4.0</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-company" class="centered-sub">
                <ul class="sub-menu about">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/company/">
                                <img src="/images/about-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Our Company</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/docs/contact-us/">
                                <img src="/images/contact-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Contact Us</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/careers/">
                                <img src="/images/careers-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Careers</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/mediakit/">
                                <img src="/images/media-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Media Kit</h1>
                                </div>
                            </a>
                            <a class="small-link" href="https://blog.thingsboard.io/">
                                <img src="/images/blog-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Blog</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="bottom-group">
                        <a class="small-link" href="/partners/hardware/">
                            <img src="/images/hard-s-icon.svg">
                            <div class="sub-text">
                                <h1>Hardware partners</h1>
                            </div>
                        </a>
                        <a class="small-link" href="/partners/distributors/">
                            <img src="/images/dis-s-icon.svg">
                            <div class="sub-text">
                                <h1>Distributors</h1>
                            </div>
                        </a>
                    </div>
                </ul>
            </div>
        </div>
    </nav>
    <div>
        <a href="/installations/" class="n-button try">Try it now</a>
        <a href="/pricing/" class="n-button price">Pricing</a>
    </div>
</header>


<div id="searchBox">
    <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/pe/search/?q=' + this.value)">
    <button class="searchButton"></button>
</div>

<!--  HERO  -->
<section id="hero">
  <div id="hero-content">
    <div id="vendorStrip">
      <div id="docsList">
          <ul>
            
              
              
              
              <li>
                  <a href="/docs/getting-started-guides/helloworld-pe/" >Getting Started</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/pe/" class="YAH">Documentation</a>
                  
                     <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/pe/guides/" >Guides</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/user-guide/install/pe/installation-options/" >Installation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/pe/reference/" >Architecture</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/pe/api/" >API</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/pe/faq/" >FAQ</a>
                  
              </li>
            
          </ul>
          <div id="docsBreadcrumbs">
              
                  
                  
                  
                  
                      
                  
                      
                  
                      
                  
                      
                         
                         
                         
    

    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    

    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    
        
        
        
    

    

    

    

    

    


        
            
        
    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    

    

    

    

    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    

    

    

    

    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    

    

    

    

    

    

    

    
        
        
        
    

    

    

    


        
            
        
    


                         
                            
                         
                      
                  
                      
                         
                         
                         
    

    

    
        
        
        

                         
                            
                  
                    <span class="item">Documentation</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">Contribution Guide</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">Widgets development (ThingsBoard v3.x)</span>
                    
                  
              
          </div>
      </div>
    </div>
  </div>
</section>
<div id="docsNav">
    <div class="docItems">
        
            
            
                <a class="toc" href="/docs/getting-started-guides/helloworld-pe/" >Getting Started</a>
            
        
            
            
                <div class="pi-accordion">
                    


<a class="item" data-title="Professional Edition" href="/docs/pe/"></a>


<a class="item" data-title="What is ThingsBoard?" href="/docs/pe/getting-started-guides/what-is-thingsboard/"></a>


<a class="item" data-title="How to connect your device?" href="/docs/pe/getting-started-guides/connectivity/"></a>


<div class="item item-new" data-title="Solution Templates">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/solution-templates/overview/"></a>


<a class="item" data-title="Temperature & Humidity Sensors" href="/docs/pe/solution-templates/temperature-humidity-sensors/"></a>


<a class="item" data-title="Smart office" href="/docs/pe/solution-templates/smart-office/"></a>


<a class="item" data-title="Fleet tracking" href="/docs/pe/solution-templates/fleet-tracking/"></a>


<a class="item" data-title="Water metering" href="/docs/pe/solution-templates/water-metering/"></a>
  </div>
</div>


<div class="item" data-title="Key concepts">
  <div class="container">


<a class="item" data-title="Entities and Relations" href="/docs/pe/user-guide/entities-and-relations/"></a>


<a class="item" data-title="Tenant Profiles" href="/docs/pe/user-guide/tenant-profiles/"></a>


<a class="item item-new" data-title="Device Profiles" href="/docs/pe/user-guide/device-profiles/"></a>


<a class="item" data-title="Attributes" href="/docs/pe/user-guide/attributes/"></a>


<a class="item" data-title="Time-series data" href="/docs/pe/user-guide/telemetry/"></a>


<a class="item" data-title="Alarms" href="/docs/pe/user-guide/alarms/"></a>


<a class="item" data-title="Remote commands to devices" href="/docs/pe/user-guide/rpc/"></a>


<a class="item item-new" data-title="OTA updates" href="/docs/pe/user-guide/ota-updates/"></a>
  </div>
</div>


<div class="item" data-title="Dashboards">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/user-guide/dashboards/"></a>


<a class="item" data-title="Aliases" href="/docs/pe/user-guide/ui/aliases/"></a>


<a class="item" data-title="Widget Actions" href="/docs/pe/user-guide/ui/widget-actions/"></a>


<a class="item" data-title="Widgets Library" href="/docs/pe/user-guide/ui/widget-library/"></a>
  </div>
</div>


<div class="item" data-title="Rule engine">
  <div class="container">


<a class="item" data-title="Getting Started" href="/docs/pe/user-guide/rule-engine-2-0/re-getting-started/"></a>


<a class="item" data-title="Overview" href="/docs/pe/user-guide/rule-engine-2-0/overview/"></a>


<a class="item" data-title="Architecture" href="/docs/pe/user-guide/rule-engine-2-0/architecture/"></a>


<div class="item" data-title="Nodes">
  <div class="container">


<a class="item" data-title="Filter Nodes" href="/docs/pe/user-guide/rule-engine-2-0/filter-nodes/"></a>


<a class="item" data-title="Enrichment Nodes" href="/docs/pe/user-guide/rule-engine-2-0/enrichment-nodes/"></a>


<a class="item" data-title="Transformation Nodes" href="/docs/pe/user-guide/rule-engine-2-0/transformation-nodes/"></a>


<a class="item" data-title="Action Nodes" href="/docs/pe/user-guide/rule-engine-2-0/action-nodes/"></a>


<a class="item" data-title="External Nodes" href="/docs/pe/user-guide/rule-engine-2-0/external-nodes/"></a>


<a class="item" data-title="Analytics Nodes" href="/docs/pe/user-guide/rule-engine-2-0/analytics-nodes/"></a>
  </div>
</div>


<a class="item" data-title="Custom Rule Nodes" href="/docs/user-guide/contribution/rule-node-development/"></a>
  </div>
</div>


<div class="item" data-title="White-labeling">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/user-guide/white-labeling/"></a>


<a class="item" data-title="Self-registration" href="/docs/pe/user-guide/self-registration/"></a>


<a class="item" data-title="Custom Translations" href="/docs/pe/user-guide/custom-translation/"></a>


<a class="item" data-title="Custom Menu" href="/docs/pe/user-guide/custom-menu/"></a>
  </div>
</div>


<div class="item" data-title="Integrations">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/user-guide/integrations/"></a>


<a class="item" data-title="Remote Integrations" href="/docs/user-guide/integrations/remote-integrations/"></a>


<a class="item" data-title="HTTP" href="/docs/user-guide/integrations/http/"></a>


<a class="item" data-title="MQTT" href="/docs/user-guide/integrations/mqtt/"></a>


<a class="item" data-title="OPC-UA" href="/docs/user-guide/integrations/opc-ua/"></a>


<a class="item" data-title="Actility ThingPark" href="/docs/user-guide/integrations/thingpark/"></a>


<a class="item" data-title="TheThingsNetwork" href="/docs/user-guide/integrations/ttn/"></a>


<a class="item" data-title="TheThingsIndustries" href="/docs/user-guide/integrations/tti/"></a>


<a class="item" data-title="LORIOT" href="/docs/user-guide/integrations/loriot/"></a>


<a class="item" data-title="AWS IoT" href="/docs/user-guide/integrations/aws-iot/"></a>


<a class="item" data-title="AWS Kinesis" href="/docs/user-guide/integrations/aws-kinesis/"></a>


<a class="item" data-title="IBM Watson" href="/docs/user-guide/integrations/ibm-watson-iot/"></a>


<a class="item" data-title="Azure Event Hub" href="/docs/user-guide/integrations/azure-event-hub/"></a>


<a class="item" data-title="Azure IoT Hub" href="/docs/user-guide/integrations/azure-iot-hub/"></a>


<a class="item" data-title="TCP" href="/docs/user-guide/integrations/tcp/"></a>


<a class="item" data-title="UDP" href="/docs/user-guide/integrations/udp/"></a>


<a class="item" data-title="SigFox" href="/docs/user-guide/integrations/sigfox/"></a>


<a class="item" data-title="Ocean Connect" href="/docs/user-guide/integrations/ocean-connect/"></a>


<a class="item" data-title="Custom Integration development guide" href="/docs/user-guide/integrations/custom/"></a>


<a class="item" data-title="Notifications and Alarms on your smartphone using Telegram Bot" href="/docs/pe/user-guide/rule-engine-2-0/tutorials/integration-with-telegram-bot/"></a>
  </div>
</div>


<div class="item" data-title="Analytics">
  <div class="container">


<a class="item" data-title="Trendz Analytics" href="/docs/trendz/"></a>


<a class="item" data-title="Kafka Streams" href="/docs/pe/samples/analytics/kafka-streams/"></a>
  </div>
</div>


<div class="item" data-title="Other Features">
  <div class="container">


<a class="item" data-title="Device Connectivity Status" href="/docs/pe/user-guide/device-connectivity-status/"></a>


<a class="item" data-title="Claiming Devices" href="/docs/pe/user-guide/claiming-devices/"></a>


<a class="item" data-title="Device provisioning" href="/docs/pe/user-guide/device-provisioning/"></a>


<a class="item" data-title="Entity Views" href="/docs/pe/user-guide/entity-views/"></a>


<a class="item" data-title="API Limits" href="/docs/pe/user-guide/api-limits/"></a>


<a class="item" data-title="Bulk Provisioning" href="/docs/pe/user-guide/bulk-provisioning/"></a>


<a class="item" data-title="Entity Groups" href="/docs/pe/user-guide/groups/"></a>


<a class="item" data-title="Scheduler" href="/docs/pe/user-guide/scheduler/"></a>


<a class="item" data-title="Reporting" href="/docs/pe/user-guide/reporting/"></a>


<a class="item" data-title="CSV/XLS data export" href="/docs/pe/user-guide/csv-xls-data-export/"></a>


<a class="item" data-title="File Storage" href="/docs/pe/user-guide/file-storage/"></a>
  </div>
</div>


<div class="item" data-title="Security">
  <div class="container">


<a class="item" data-title="Audit Log" href="/docs/pe/user-guide/audit-log/"></a>


<a class="item" data-title="Advanced RBAC for IoT" href="/docs/pe/user-guide/rbac/"></a>


<a class="item item-new" data-title="OAuth 2 Support" href="/docs/pe/user-guide/oauth-2-support/"></a>


<a class="item" data-title="MQTT over SSL" href="/docs/pe/user-guide/mqtt-over-ssl/"></a>


<a class="item" data-title="Device authentication options" href="/docs/pe/user-guide/device-credentials/"></a>


<a class="item" data-title="Access Token based authentication" href="/docs/pe/user-guide/access-token/"></a>


<a class="item" data-title="Basic MQTT Credentials" href="/docs/pe/user-guide/basic-mqtt/"></a>


<a class="item" data-title="X.509 Certificate based authentication" href="/docs/pe/user-guide/certificates/"></a>
  </div>
</div>


<div class="item" data-title="Administration UI">
  <div class="container">


<a class="item" data-title="Tenants" href="/docs/pe/user-guide/ui/tenants/"></a>


<a class="item" data-title="Customers" href="/docs/pe/user-guide/ui/customers/"></a>


<a class="item" data-title="Users" href="/docs/pe/user-guide/ui/users/"></a>


<a class="item" data-title="Assets" href="/docs/pe/user-guide/ui/assets/"></a>


<a class="item" data-title="Devices" href="/docs/pe/user-guide/ui/devices/"></a>


<a class="item" data-title="Rule Chains" href="/docs/pe/user-guide/ui/rule-chains/"></a>


<a class="item" data-title="Dashboards" href="/docs/pe/user-guide/ui/dashboards/"></a>


<a class="item" data-title="SMS Provider Settings" href="/docs/pe/user-guide/ui/sms-provider-settings/"></a>


<a class="item" data-title="Mail Settings" href="/docs/pe/user-guide/ui/mail-settings/"></a>


<div class="item" data-title="Widgets">
  <div class="container">


<a class="item" data-title="Chart Widgets" href="/docs/pe/user-guide/ui/chart-widget/"></a>


<a class="item" data-title="Entity Table Widget" href="/docs/pe/user-guide/ui/entity-table-widget/"></a>


<a class="item" data-title="Trip Animation Widget" href="/docs/pe/user-guide/ui/trip-animation-widget/"></a>


<a class="item" data-title="Advanced data key configuration" href="/docs/pe/user-guide/ui/advanced-data-key-configuration/"></a>
  </div>
</div>
  </div>
</div>


<div class="item" data-title="Contribution Guide">
  <div class="container">


<a class="item" data-title="How to contribute your device integration guide" href="/docs/pe/user-guide/contribution/how-to-contribute-your-device-integration-guide/"></a>


<a class="item" data-title="Rule Node development" href="/docs/pe/user-guide/contribution/rule-node-development/"></a>


<a class="item" data-title="Widgets development (ThingsBoard v3.x)" href="/docs/pe/user-guide/contribution/widgets-development/"></a>


<a class="item" data-title="Widgets development (ThingsBoard v2.x)" href="/docs/pe/user-guide/contribution/widgets-development-before-3.0/"></a>
  </div>
</div>


<a class="item" data-title="Troubleshooting" href="/docs/pe/user-guide/troubleshooting/"></a>


<a class="item" data-title="Release Notes" href="/docs/pe/reference/releases/"></a>


<a class="item" data-title="Roadmap" href="/docs/pe/reference/roadmap/"></a>
                </div>
            
        
            
            
                <a class="toc" href="/docs/pe/guides/" >Guides</a>
            
        
            
            
                <a class="toc" href="/docs/user-guide/install/pe/installation-options/" >Installation</a>
            
        
            
            
                <a class="toc" href="/docs/pe/reference/" >Architecture</a>
            
        
            
            
                <a class="toc" href="/docs/pe/api/" >API</a>
            
        
            
            
                <a class="toc" href="/docs/pe/faq/" >FAQ</a>
            
        
    </div>
</div>








<section id="encyclopedia">
  
  <div id="docsToc">
        <div class="pi-accordion">
        


<a class="item" data-title="Professional Edition" href="/docs/pe/"></a>


<a class="item" data-title="What is ThingsBoard?" href="/docs/pe/getting-started-guides/what-is-thingsboard/"></a>


<a class="item" data-title="How to connect your device?" href="/docs/pe/getting-started-guides/connectivity/"></a>


<div class="item item-new" data-title="Solution Templates">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/solution-templates/overview/"></a>


<a class="item" data-title="Temperature & Humidity Sensors" href="/docs/pe/solution-templates/temperature-humidity-sensors/"></a>


<a class="item" data-title="Smart office" href="/docs/pe/solution-templates/smart-office/"></a>


<a class="item" data-title="Fleet tracking" href="/docs/pe/solution-templates/fleet-tracking/"></a>


<a class="item" data-title="Water metering" href="/docs/pe/solution-templates/water-metering/"></a>
  </div>
</div>


<div class="item" data-title="Key concepts">
  <div class="container">


<a class="item" data-title="Entities and Relations" href="/docs/pe/user-guide/entities-and-relations/"></a>


<a class="item" data-title="Tenant Profiles" href="/docs/pe/user-guide/tenant-profiles/"></a>


<a class="item item-new" data-title="Device Profiles" href="/docs/pe/user-guide/device-profiles/"></a>


<a class="item" data-title="Attributes" href="/docs/pe/user-guide/attributes/"></a>


<a class="item" data-title="Time-series data" href="/docs/pe/user-guide/telemetry/"></a>


<a class="item" data-title="Alarms" href="/docs/pe/user-guide/alarms/"></a>


<a class="item" data-title="Remote commands to devices" href="/docs/pe/user-guide/rpc/"></a>


<a class="item item-new" data-title="OTA updates" href="/docs/pe/user-guide/ota-updates/"></a>
  </div>
</div>


<div class="item" data-title="Dashboards">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/user-guide/dashboards/"></a>


<a class="item" data-title="Aliases" href="/docs/pe/user-guide/ui/aliases/"></a>


<a class="item" data-title="Widget Actions" href="/docs/pe/user-guide/ui/widget-actions/"></a>


<a class="item" data-title="Widgets Library" href="/docs/pe/user-guide/ui/widget-library/"></a>
  </div>
</div>


<div class="item" data-title="Rule engine">
  <div class="container">


<a class="item" data-title="Getting Started" href="/docs/pe/user-guide/rule-engine-2-0/re-getting-started/"></a>


<a class="item" data-title="Overview" href="/docs/pe/user-guide/rule-engine-2-0/overview/"></a>


<a class="item" data-title="Architecture" href="/docs/pe/user-guide/rule-engine-2-0/architecture/"></a>


<div class="item" data-title="Nodes">
  <div class="container">


<a class="item" data-title="Filter Nodes" href="/docs/pe/user-guide/rule-engine-2-0/filter-nodes/"></a>


<a class="item" data-title="Enrichment Nodes" href="/docs/pe/user-guide/rule-engine-2-0/enrichment-nodes/"></a>


<a class="item" data-title="Transformation Nodes" href="/docs/pe/user-guide/rule-engine-2-0/transformation-nodes/"></a>


<a class="item" data-title="Action Nodes" href="/docs/pe/user-guide/rule-engine-2-0/action-nodes/"></a>


<a class="item" data-title="External Nodes" href="/docs/pe/user-guide/rule-engine-2-0/external-nodes/"></a>


<a class="item" data-title="Analytics Nodes" href="/docs/pe/user-guide/rule-engine-2-0/analytics-nodes/"></a>
  </div>
</div>


<a class="item" data-title="Custom Rule Nodes" href="/docs/user-guide/contribution/rule-node-development/"></a>
  </div>
</div>


<div class="item" data-title="White-labeling">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/pe/user-guide/white-labeling/"></a>


<a class="item" data-title="Self-registration" href="/docs/pe/user-guide/self-registration/"></a>


<a class="item" data-title="Custom Translations" href="/docs/pe/user-guide/custom-translation/"></a>


<a class="item" data-title="Custom Menu" href="/docs/pe/user-guide/custom-menu/"></a>
  </div>
</div>


<div class="item" data-title="Integrations">
  <div class="container">


<a class="item" data-title="Overview" href="/docs/user-guide/integrations/"></a>


<a class="item" data-title="Remote Integrations" href="/docs/user-guide/integrations/remote-integrations/"></a>


<a class="item" data-title="HTTP" href="/docs/user-guide/integrations/http/"></a>


<a class="item" data-title="MQTT" href="/docs/user-guide/integrations/mqtt/"></a>


<a class="item" data-title="OPC-UA" href="/docs/user-guide/integrations/opc-ua/"></a>


<a class="item" data-title="Actility ThingPark" href="/docs/user-guide/integrations/thingpark/"></a>


<a class="item" data-title="TheThingsNetwork" href="/docs/user-guide/integrations/ttn/"></a>


<a class="item" data-title="TheThingsIndustries" href="/docs/user-guide/integrations/tti/"></a>


<a class="item" data-title="LORIOT" href="/docs/user-guide/integrations/loriot/"></a>


<a class="item" data-title="AWS IoT" href="/docs/user-guide/integrations/aws-iot/"></a>


<a class="item" data-title="AWS Kinesis" href="/docs/user-guide/integrations/aws-kinesis/"></a>


<a class="item" data-title="IBM Watson" href="/docs/user-guide/integrations/ibm-watson-iot/"></a>


<a class="item" data-title="Azure Event Hub" href="/docs/user-guide/integrations/azure-event-hub/"></a>


<a class="item" data-title="Azure IoT Hub" href="/docs/user-guide/integrations/azure-iot-hub/"></a>


<a class="item" data-title="TCP" href="/docs/user-guide/integrations/tcp/"></a>


<a class="item" data-title="UDP" href="/docs/user-guide/integrations/udp/"></a>


<a class="item" data-title="SigFox" href="/docs/user-guide/integrations/sigfox/"></a>


<a class="item" data-title="Ocean Connect" href="/docs/user-guide/integrations/ocean-connect/"></a>


<a class="item" data-title="Custom Integration development guide" href="/docs/user-guide/integrations/custom/"></a>


<a class="item" data-title="Notifications and Alarms on your smartphone using Telegram Bot" href="/docs/pe/user-guide/rule-engine-2-0/tutorials/integration-with-telegram-bot/"></a>
  </div>
</div>


<div class="item" data-title="Analytics">
  <div class="container">


<a class="item" data-title="Trendz Analytics" href="/docs/trendz/"></a>


<a class="item" data-title="Kafka Streams" href="/docs/pe/samples/analytics/kafka-streams/"></a>
  </div>
</div>


<div class="item" data-title="Other Features">
  <div class="container">


<a class="item" data-title="Device Connectivity Status" href="/docs/pe/user-guide/device-connectivity-status/"></a>


<a class="item" data-title="Claiming Devices" href="/docs/pe/user-guide/claiming-devices/"></a>


<a class="item" data-title="Device provisioning" href="/docs/pe/user-guide/device-provisioning/"></a>


<a class="item" data-title="Entity Views" href="/docs/pe/user-guide/entity-views/"></a>


<a class="item" data-title="API Limits" href="/docs/pe/user-guide/api-limits/"></a>


<a class="item" data-title="Bulk Provisioning" href="/docs/pe/user-guide/bulk-provisioning/"></a>


<a class="item" data-title="Entity Groups" href="/docs/pe/user-guide/groups/"></a>


<a class="item" data-title="Scheduler" href="/docs/pe/user-guide/scheduler/"></a>


<a class="item" data-title="Reporting" href="/docs/pe/user-guide/reporting/"></a>


<a class="item" data-title="CSV/XLS data export" href="/docs/pe/user-guide/csv-xls-data-export/"></a>


<a class="item" data-title="File Storage" href="/docs/pe/user-guide/file-storage/"></a>
  </div>
</div>


<div class="item" data-title="Security">
  <div class="container">


<a class="item" data-title="Audit Log" href="/docs/pe/user-guide/audit-log/"></a>


<a class="item" data-title="Advanced RBAC for IoT" href="/docs/pe/user-guide/rbac/"></a>


<a class="item item-new" data-title="OAuth 2 Support" href="/docs/pe/user-guide/oauth-2-support/"></a>


<a class="item" data-title="MQTT over SSL" href="/docs/pe/user-guide/mqtt-over-ssl/"></a>


<a class="item" data-title="Device authentication options" href="/docs/pe/user-guide/device-credentials/"></a>


<a class="item" data-title="Access Token based authentication" href="/docs/pe/user-guide/access-token/"></a>


<a class="item" data-title="Basic MQTT Credentials" href="/docs/pe/user-guide/basic-mqtt/"></a>


<a class="item" data-title="X.509 Certificate based authentication" href="/docs/pe/user-guide/certificates/"></a>
  </div>
</div>


<div class="item" data-title="Administration UI">
  <div class="container">


<a class="item" data-title="Tenants" href="/docs/pe/user-guide/ui/tenants/"></a>


<a class="item" data-title="Customers" href="/docs/pe/user-guide/ui/customers/"></a>


<a class="item" data-title="Users" href="/docs/pe/user-guide/ui/users/"></a>


<a class="item" data-title="Assets" href="/docs/pe/user-guide/ui/assets/"></a>


<a class="item" data-title="Devices" href="/docs/pe/user-guide/ui/devices/"></a>


<a class="item" data-title="Rule Chains" href="/docs/pe/user-guide/ui/rule-chains/"></a>


<a class="item" data-title="Dashboards" href="/docs/pe/user-guide/ui/dashboards/"></a>


<a class="item" data-title="SMS Provider Settings" href="/docs/pe/user-guide/ui/sms-provider-settings/"></a>


<a class="item" data-title="Mail Settings" href="/docs/pe/user-guide/ui/mail-settings/"></a>


<div class="item" data-title="Widgets">
  <div class="container">


<a class="item" data-title="Chart Widgets" href="/docs/pe/user-guide/ui/chart-widget/"></a>


<a class="item" data-title="Entity Table Widget" href="/docs/pe/user-guide/ui/entity-table-widget/"></a>


<a class="item" data-title="Trip Animation Widget" href="/docs/pe/user-guide/ui/trip-animation-widget/"></a>


<a class="item" data-title="Advanced data key configuration" href="/docs/pe/user-guide/ui/advanced-data-key-configuration/"></a>
  </div>
</div>
  </div>
</div>


<div class="item" data-title="Contribution Guide">
  <div class="container">


<a class="item" data-title="How to contribute your device integration guide" href="/docs/pe/user-guide/contribution/how-to-contribute-your-device-integration-guide/"></a>


<a class="item" data-title="Rule Node development" href="/docs/pe/user-guide/contribution/rule-node-development/"></a>


<a class="item" data-title="Widgets development (ThingsBoard v3.x)" href="/docs/pe/user-guide/contribution/widgets-development/"></a>


<a class="item" data-title="Widgets development (ThingsBoard v2.x)" href="/docs/pe/user-guide/contribution/widgets-development-before-3.0/"></a>
  </div>
</div>


<a class="item" data-title="Troubleshooting" href="/docs/pe/user-guide/troubleshooting/"></a>


<a class="item" data-title="Release Notes" href="/docs/pe/reference/releases/"></a>


<a class="item" data-title="Roadmap" href="/docs/pe/reference/roadmap/"></a>
        </div> <!-- /pi-accordion -->
  </div> <!-- /docsToc -->
  
  <div id="docsContent" class=" hasTocContent">
      <div id="table-of-contents">
          
              <h4>On this page</h4>
          
      </div>
      <div id="top-spacer"></div>
      <h1>Widgets Development Guide</h1>
      <div id="content">
          
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#creating-new-widget-definition" id="markdown-toc-creating-new-widget-definition">Creating new widget definition</a>    <ul>
      <li><a href="#widget-editor-overview" id="markdown-toc-widget-editor-overview">Widget Editor overview</a>        <ul>
          <li><a href="#widget-editor-toolbar" id="markdown-toc-widget-editor-toolbar">Widget Editor Toolbar</a></li>
          <li><a href="#resourceshtmlcss-section" id="markdown-toc-resourceshtmlcss-section">Resources/HTML/CSS section</a></li>
          <li><a href="#javascript-section" id="markdown-toc-javascript-section">JavaScript section</a></li>
          <li><a href="#settings-schema-section" id="markdown-toc-settings-schema-section">Settings schema section</a></li>
          <li><a href="#widget-preview-section" id="markdown-toc-widget-preview-section">Widget preview section</a></li>
        </ul>
      </li>
      <li><a href="#basic-widget-api" id="markdown-toc-basic-widget-api">Basic widget API</a>        <ul>
          <li><a href="#subscription-object" id="markdown-toc-subscription-object">Subscription object</a></li>
          <li><a href="#timewindow-functions" id="markdown-toc-timewindow-functions">Timewindow functions</a></li>
          <li><a href="#control-api" id="markdown-toc-control-api">Control API</a></li>
          <li><a href="#actions-api" id="markdown-toc-actions-api">Actions API</a></li>
          <li><a href="#state-controller" id="markdown-toc-state-controller">State Controller</a></li>
          <li><a href="#type-parameters-object" id="markdown-toc-type-parameters-object">Type parameters object</a></li>
          <li><a href="#action-sources-object" id="markdown-toc-action-sources-object">Action sources object</a></li>
        </ul>
      </li>
      <li><a href="#creating-simple-widgets" id="markdown-toc-creating-simple-widgets">Creating simple widgets</a>        <ul>
          <li><a href="#latest-values-widget" id="markdown-toc-latest-values-widget">Latest Values widget</a></li>
          <li><a href="#time-series-widget" id="markdown-toc-time-series-widget">Time-Series widget</a></li>
          <li><a href="#rpc-control-widget" id="markdown-toc-rpc-control-widget">RPC (Control) widget</a></li>
          <li><a href="#alarm-widget" id="markdown-toc-alarm-widget">Alarm widget</a></li>
          <li><a href="#static-widget" id="markdown-toc-static-widget">Static widget</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#integrating-existing-code-to-create-widget-definition" id="markdown-toc-integrating-existing-code-to-create-widget-definition">Integrating existing code to create widget definition</a>    <ul>
      <li><a href="#using-external-javascript-library" id="markdown-toc-using-external-javascript-library">Using external JavaScript library</a>        <ul>
          <li><a href="#latest-values-example" id="markdown-toc-latest-values-example">Latest Values Example</a></li>
          <li><a href="#time-series-example" id="markdown-toc-time-series-example">Time-Series Example</a></li>
        </ul>
      </li>
      <li><a href="#using-existing-javascript-code" id="markdown-toc-using-existing-javascript-code">Using existing JavaScript code</a></li>
    </ul>
  </li>
  <li><a href="#widget-code-debugging-tips" id="markdown-toc-widget-code-debugging-tips">Widget code debugging tips</a></li>
  <li><a href="#next-steps" id="markdown-toc-next-steps">Next steps</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p><strong>ThingsBoard widgets</strong> are additional UI modules that easily integrate into any <a href="/docs/pe/user-guide/dashboards/">IoT Dashboard</a>.  They provide end-user functions such as data visualization, remote device control, alarms management and display of static custom html content.
According to the provided features, each widget definition represents a specific <a href="/docs/pe/user-guide/ui/widget-library/#widget-types">Widget Type</a>.</p>

<h2 id="creating-new-widget-definition">Creating new widget definition</h2>

<p>In order to create a new widget definition, navigate to “Widget Library” and open existing “Widgets Bundle” or create a new one.  In the “Widgets Bundle” view, click the big “+” button at the bottom-right part of the screen and then click the “Create new widget type” button.</p>

<p><img src="/images/user-guide/contribution/widgets/create-new-widget-type.png" alt="image" /></p>

<p>“Select widget type” window should appear with select options corresponding to the <a href="/docs/pe/user-guide/ui/widget-library/#widget-types">widget type</a> you intend to develop.</p>

<p><img src="/images/user-guide/contribution/widgets/select-widget-type.png" alt="image" /></p>

<p>After that, the pre-populated “Widget Editor” page will open with starter widget template according to previously selected widget type.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor.png" alt="image" /></p>

<h3 id="widget-editor-overview">Widget Editor overview</h3>

<p>Widget Editor view is a mini IDE designed to develop custom widget definitions.
It consists of <a href="#widget-editor-toolbar">top toolbar</a> and four main sections:</p>

<ul>
  <li><a href="#resourceshtmlcss-section">Resources/HTML/CSS</a></li>
  <li><a href="#javascript-section">JavaScript</a></li>
  <li><a href="#settings-schema-section">Settings schema</a></li>
  <li><a href="#widget-preview-section">Widget preview</a></li>
</ul>

<h4 id="widget-editor-toolbar">Widget Editor Toolbar</h4>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-toolbar.png" alt="image" /></p>

<p>Widget Editor Toolbar consists of the following items:</p>

<ul>
  <li><strong>Widget Title</strong> field - used to specify title of the widget definition</li>
  <li><strong>Widget Type</strong> selector -  used to specify <a href="/docs/pe/user-guide/ui/widget-library/#widget-types">type</a> of the widget definition</li>
  <li><strong>Run</strong> button - used to run widget code and view result in <strong>Widget preview</strong> section</li>
  <li><strong>Undo</strong> button - reverts all editor sections to latest saved state</li>
  <li><strong>Save</strong> button - saves widget definition</li>
  <li><strong>Save as</strong> button - allows to save a new copy of widget definition by specifying new widget type name and target <strong>Widgets Bundle</strong></li>
</ul>

<h4 id="resourceshtmlcss-section">Resources/HTML/CSS section</h4>

<p>This section consists of three tabs:</p>

<p>The first <strong>Resources</strong> tab is used to specify external JavaScript/CSS resources used by the widget.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-resources.png" alt="image" /></p>

<p>Second <strong>HTML</strong> tab contains widget html code <em>(Note: some widgets create html content dynamically, thus their initial html content can be empty).</em></p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-html.png" alt="image" /></p>

<p>Third <strong>CSS</strong> tab contains widget specific CSS style definitions.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-css.png" alt="image" /></p>

<h4 id="javascript-section">JavaScript section</h4>

<p>This section contains all widget related JavaScript code according to the <a href="#basic-widget-api">Widget API</a>.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-javascript.png" alt="image" /></p>

<h4 id="settings-schema-section">Settings schema section</h4>

<p>This section consists of two tabs:</p>

<p>The first tab, <strong>Settings schema</strong>, is used to specify the json schema of widget settings for UI form auto-generation using react-schema-form <a href="http://networknt.github.io/react-schema-form/">builder</a>. 
This generated UI form is displayed in the <strong>Advanced</strong> tab of widget settings. 
The Settings Object serialized by this schema is used to store specific widget settings and is accessible from widget JavaScript code.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-settings-schema.png" alt="image" /></p>

<p>The second tab, <strong>Data key settings schema</strong>, is used to specify json schema of data key settings for UI form auto-generation using react-schema-form <a href="http://networknt.github.io/react-schema-form/">builder</a>. 
This generated UI form is displayed in <strong>Advanced</strong> tab of the <strong>Data key configuration</strong> dialog.
The Settings Object serialized by this schema is used to store specific settings for each data key of the datasource defined in the widget. 
These settings are accessible from widget JavaScript code.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-datakey-settings-schema.png" alt="image" /></p>

<h4 id="widget-preview-section">Widget preview section</h4>

<p>This section is used to preview and test widget definitions.
It is presented as a mini dashboard containing one widget instantiated from the current widget definition.
It has mostly all functionality provided by usual ThingsBoard dashboard, with some limitations.
For example, “Function” can only be selected as datasource type in widget datasources section for debugging purposes.</p>

<p><img src="/images/user-guide/contribution/widgets/widget-editor-preview.png" alt="image" /></p>

<h3 id="basic-widget-api">Basic widget API</h3>

<p>All widget related code is located in the <a href="#javascript-section">JavaScript section</a>.
The built-in variable <strong>self</strong> that is a reference to the widget instance is also available.
Each widget function should be defined as a property of the <strong>self</strong> variable.
<strong>self</strong> variable has property <strong>ctx</strong> of type <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">WidgetContext</a> - a reference to widget context that has all necessary API and data used by widget instance.
Below is brief description of widget context properties:</p>

<table>
  <thead>
    <tr>
      <th><strong>Property</strong></th>
      <th><strong>Type</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$container</td>
      <td>jQuery Object</td>
      <td>Container element of the widget. Can be used to dynamically access or modify widget DOM using jQuery API.</td>
    </tr>
    <tr>
      <td>$scope</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L274&quot;">IDynamicWidgetComponent</a></td>
      <td>Reference to the current widget component. Can be used to access/modify component properties when widget is built using Angular approach.</td>
    </tr>
    <tr>
      <td>width</td>
      <td>Number</td>
      <td>Current width of widget container in pixels.</td>
    </tr>
    <tr>
      <td>height</td>
      <td>Number</td>
      <td>Current height of widget container in pixels.</td>
    </tr>
    <tr>
      <td>isEdit</td>
      <td>Boolean</td>
      <td>Indicates whether the dashboard is in in the view or editing state.</td>
    </tr>
    <tr>
      <td>isMobile</td>
      <td>Boolean</td>
      <td>Indicates whether the dashboard view is less then 960px width (default mobile breakpoint).</td>
    </tr>
    <tr>
      <td>widgetConfig</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L341">WidgetConfig</a></td>
      <td>Common widget configuration containing properties such as <strong>color</strong> (text color), <strong>backgroundColor</strong> (widget background color), etc.</td>
    </tr>
    <tr>
      <td>settings</td>
      <td>Object</td>
      <td>Widget settings containing widget specific properties according to the defined <a href="#settings-schema-section">settings json schema</a></td>
    </tr>
    <tr>
      <td>datasources</td>
      <td>Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>&gt;</td>
      <td>Array of resolved widget datasources. See <a href="#subscription-object">Subscription object</a>.</td>
    </tr>
    <tr>
      <td>data</td>
      <td>Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L275">DatasourceData</a>&gt;</td>
      <td>Array of latest datasources data. See <a href="#subscription-object">Subscription object</a>.</td>
    </tr>
    <tr>
      <td>timeWindow</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L104">WidgetTimewindow</a></td>
      <td>Current widget timewindow (applicable for timeseries widgets). Holds information about current timewindow bounds. <strong>minTime</strong> - minimum time in UTC milliseconds, <strong>maxTime</strong> - maximum time in UTC milliseconds, <strong>interval</strong> - current aggregation interval in milliseconds.</td>
    </tr>
    <tr>
      <td>units</td>
      <td>String</td>
      <td>Optional property defining units text of values displayed by widget. Useful for simple widgets like cards or gauges.</td>
    </tr>
    <tr>
      <td>decimals</td>
      <td>Number</td>
      <td>Optional property defining how many positions should be used to display decimal part of the value number.</td>
    </tr>
    <tr>
      <td>hideTitlePanel</td>
      <td>Boolean</td>
      <td>Manages visibility of widget title panel. Useful for widget with custom title panels or different states. <strong>updateWidgetParams()</strong> function must be called after this property change.</td>
    </tr>
    <tr>
      <td>widgetTitle</td>
      <td>String</td>
      <td>If set, will override configured widget title text. <strong>updateWidgetParams()</strong> function must be called after this property change.</td>
    </tr>
    <tr>
      <td>detectChanges()</td>
      <td>Function</td>
      <td>Trigger change detection for current widget. Must be invoked when widget HTML template bindings should be updated due to widget data changes.</td>
    </tr>
    <tr>
      <td>updateWidgetParams()</td>
      <td>Function</td>
      <td>Updates widget with runtime set properties such as <strong>widgetTitle</strong>, <strong>hideTitlePanel</strong>, etc. Must be invoked in order these properties changes take effect.</td>
    </tr>
    <tr>
      <td>defaultSubscription</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L220&quot;">IWidgetSubscription</a></td>
      <td>Default widget subscription object contains all subscription information, including current data, according to the widget type. See <a href="#subscription-object">Subscription object</a>.</td>
    </tr>
    <tr>
      <td>timewindowFunctions</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L45">TimewindowFunctions</a></td>
      <td>Object with timewindow functions used to manage widget data time frame. Can by used by Time-series or Alarm widgets. See <a href="#timewindow-functions">Timewindow functions</a>.</td>
    </tr>
    <tr>
      <td>controlApi</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L58">RpcApi</a></td>
      <td>Object that provides API functions for RPC (Control) widgets. See <a href="#control-api">Control API</a>.</td>
    </tr>
    <tr>
      <td>actionsApi</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L67">WidgetActionsApi</a></td>
      <td>Set of API functions to work with user defined actions. See <a href="#actions-api">Actions API</a>.</td>
    </tr>
    <tr>
      <td>stateController</td>
      <td><a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L121">IStateController</a></td>
      <td>Reference to Dashboard state controller, providing API to manage current dashboard state. See <a href="#state-controller">State Controller</a>.</td>
    </tr>
  </tbody>
</table>

<p>In order to implement a new widget, the following JavaScript functions should be defined <em>(Note: each function is optional and can be implemented according to  widget specific behaviour):</em></p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Description</strong></th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onInit()</code></td>
      <td>The first function which is called when widget is ready for initialization. Should be used to prepare widget DOM, process widget settings and initial subscription information.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onDataUpdated()</code></td>
      <td>Called when the new data is available from the widget subscription. Latest data can be accessed from the <a href="#subscription-object"><strong>defaultSubscription</strong> object</a> of widget context (<strong>ctx</strong>).</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onResize()</code></td>
      <td>Called when widget container is resized. Latest width and height can be obtained from widget context (<strong>ctx</strong>).</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onEditModeChanged()</code></td>
      <td>Called when dashboard editing mode is changed. Latest mode is handled by isEdit property of <strong>ctx</strong>.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onMobileModeChanged()</code></td>
      <td>Called when dashboard view width crosses mobile breakpoint. Latest state is handled by isMobile property of <strong>ctx</strong>.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onDestroy()</code></td>
      <td>Called when widget element is destroyed. Should be used to cleanup all resources if necessary.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getSettingsSchema()</code></td>
      <td>Optional function returning widget settings schema json as alternative to <strong>Settings tab</strong> of <a href="#settings-schema-section">Settings schema section</a>.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getDataKeySettingsSchema()</code></td>
      <td>Optional function returning particular data key settings schema json as alternative to <strong>Data key settings schema</strong> tab of <a href="#settings-schema-section">Settings schema section</a>.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">typeParameters()</code></td>
      <td>Returns <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L146">WidgetTypeParameters</a> object describing widget datasource parameters. See <a href="#type-parameters-object">Type parameters object</a>.</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">actionSources()</code></td>
      <td>Returns map describing available widget action sources (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L118">WidgetActionSource</a>) used to define user actions. See <a href="#action-sources-object">Action sources object</a>.</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="subscription-object">Subscription object</h4>

<p>The widget subscription object is instance of <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L220&quot;">IWidgetSubscription</a> and contains all subscription information, including current data, according to the <a href="/docs/pe/user-guide/ui/widget-library/#widget-types">widget type</a>.
Depending on widget type, subscription object provides different data structures.
For <a href="/docs/pe/user-guide/ui/widget-library/#latest-values">Latest values</a> and <a href="/docs/pe/user-guide/ui/widget-library/#time-series">Time-series</a> widget types, it provides the following properties:</p>

<ul>
  <li><strong>datasources</strong> - array of datasources (Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>&gt;) used by this subscription, using the following structure:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>    <span class="nx">datasources</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>  <span class="c1">// datasource</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">entity</span><span class="dl">'</span><span class="p">,</span><span class="c1">// type of the datasource. Can be "function" or "entity"</span>
           <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the datasource (in case of "entity" usually Entity name)</span>
           <span class="na">aliasName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">aliasName</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the alias used to resolve this particular datasource Entity</span>
           <span class="na">entityName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">entityName</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the Entity used as datasource</span>
           <span class="na">entityType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">DEVICE</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// datasource Entity type (for ex. "DEVICE", "ASSET", "TENANT", etc.)</span>
           <span class="na">entityId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">943b8cd0-576a-11e7-824c-0b1cb331ec92</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// entity identificator presented as string uuid. </span>
           <span class="na">dataKeys</span><span class="p">:</span> <span class="p">[</span> <span class="c1">//  array of keys (Array&lt;DataKey&gt;) (attributes or timeseries) of the entity used to fetch data </span>
               <span class="p">{</span> <span class="c1">// dataKey</span>
                    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// the name of the particular entity attribute/timeseries </span>
                    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">timeseries</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// type of the dataKey. Can be "timeseries", "attribute" or "function" </span>
                    <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Sin</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// label of the dataKey. Used as display value (for ex. in the widget legend section) </span>
                    <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#ffffff</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// color of the key. Can be used by widget to set color of the key data (for ex. lines in line chart or segments in the pie chart).  </span>
                    <span class="na">funcBody</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span> <span class="c1">// only applicable for datasource with type "function" and "function" key type. Defines body of the function to generate simulated data.</span>
                    <span class="na">settings</span><span class="p">:</span> <span class="p">{}</span> <span class="c1">// dataKey specific settings with structure according to the defined Data key settings json schema. See "Settings schema section".</span>
               <span class="p">},</span>
               <span class="c1">//...</span>
           <span class="p">]</span>
        <span class="p">},</span>
        <span class="c1">//...</span>
    <span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li><strong>data</strong> - array of latest data (Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L275">DatasourceData</a>&gt;) received in scope of this subscription, using the following structure:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>    <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">datasource</span><span class="p">:</span> <span class="p">{},</span> <span class="c1">// datasource object of this data. See datasource structure above.</span>
            <span class="na">dataKey</span><span class="p">:</span> <span class="p">{},</span> <span class="c1">// dataKey for which the data is held. See dataKey structure above.</span>
            <span class="na">data</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// array of data points</span>
                <span class="p">[</span>   <span class="c1">// data point</span>
                    <span class="mi">1498150092317</span><span class="p">,</span> <span class="c1">// unix timestamp of datapoint in milliseconds</span>
                    <span class="mi">1</span><span class="p">,</span> <span class="c1">// value, can be either string, numeric or boolean  </span>
                <span class="p">],</span>
                <span class="c1">//...</span>
            <span class="p">]</span>  
        <span class="p">},</span>
        <span class="c1">//...</span>
    <span class="p">]</span>     
</pre></td></tr></tbody></table></code></pre></div></div>

<p>For <a href="/docs/pe/user-guide/ui/widget-library/#alarm-widget">Alarm widget</a> type it provides the following properties:</p>

<ul>
  <li><strong>alarmSource</strong> - (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>) information about entity for which alarms are fetched, using the following structure:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>    <span class="nx">alarmSource</span> <span class="o">=</span> <span class="p">{</span>
         <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">entity</span><span class="dl">'</span><span class="p">,</span><span class="c1">// type of the alarm source. Can be "function" or "entity"</span>
         <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the alarm source (in case of "entity" usually Entity name)</span>
         <span class="na">aliasName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">aliasName</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the alias used to resolve this particular alarm source Entity</span>
         <span class="na">entityName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">entityName</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// name of the Entity used as alarm source</span>
         <span class="na">entityType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">DEVICE</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// alarm source Entity type (for ex. "DEVICE", "ASSET", "TENANT", etc.)</span>
         <span class="na">entityId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">943b8cd0-576a-11e7-824c-0b1cb331ec92</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// entity identificator presented as string uuid. </span>
         <span class="na">dataKeys</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// array of keys indicating alarm fields used to display alarms data </span>
            <span class="p">{</span> <span class="c1">// dataKey</span>
                 <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// the name of the particular alarm field </span>
                 <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">alarm</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// type of the dataKey. Only "alarm" in this case. </span>
                 <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Severity</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// label of the dataKey. Used as display value (for ex. as a column title in the Alarms table) </span>
                 <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#ffffff</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// color of the key. Can be used by widget to set color of the key data.  </span>
                 <span class="na">settings</span><span class="p">:</span> <span class="p">{}</span> <span class="c1">// dataKey specific settings with structure according to the defined Data key settings json schema. See "Settings schema section".</span>
            <span class="p">},</span>
            <span class="c1">//...</span>
          <span class="p">]</span> 
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li><strong>alarms</strong> - array of alarms (Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/alarm.models.ts#L88">Alarm</a>&gt;) received in scope of this subscription, using the following structure:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>    <span class="nx">alarms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span> <span class="c1">// alarm</span>
            <span class="na">id</span><span class="p">:</span> <span class="p">{</span> <span class="c1">// alarm id </span>
                <span class="na">entityType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ALARM</span><span class="dl">"</span><span class="p">,</span> 
                <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">943b8cd0-576a-11e7-824c-0b1cb331ec92</span><span class="dl">"</span>
            <span class="p">},</span>
            <span class="na">createdTime</span><span class="p">:</span> <span class="mi">1498150092317</span><span class="p">,</span> <span class="c1">// Alarm created time (unix timestamp)</span>
            <span class="na">startTs</span><span class="p">:</span> <span class="mi">1498150092316</span><span class="p">,</span> <span class="c1">// Alarm started time (unix timestamp)</span>
            <span class="na">endTs</span><span class="p">:</span> <span class="mi">1498563899065</span><span class="p">,</span> <span class="c1">// Alarm end time (unix timestamp)</span>
            <span class="na">ackTs</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// Time of alarm acknowledgment (unix timestamp)</span>
            <span class="na">clearTs</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1">// Time of alarm clear (unix timestamp)</span>
            <span class="na">originator</span><span class="p">:</span> <span class="p">{</span> <span class="c1">// Originator - id of entity produced this alarm </span>
                <span class="na">entityType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ASSET</span><span class="dl">"</span><span class="p">,</span> 
                <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ceb16a30-4142-11e7-8b30-d5d66714ea5a</span><span class="dl">"</span>
            <span class="p">},</span>
            <span class="na">originatorName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Originator Name</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Name of originator entity</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Temperature</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Type of the alarm            </span>
            <span class="na">severity</span><span class="p">:</span> <span class="dl">"</span><span class="s2">CRITICAL</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Severity of the alarm ("CRITICAL", "MAJOR", "MINOR", "WARNING", "INDETERMINATE") </span>
            <span class="na">status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ACTIVE_UNACK</span><span class="dl">"</span><span class="p">,</span> <span class="c1">// Status of the alarm </span>
                                    <span class="c1">// ("ACTIVE_UNACK" - active unacknowledged, </span>
                                    <span class="c1">// "ACTIVE_ACK" - active acknowledged, </span>
                                    <span class="c1">// "CLEARED_UNACK" - cleared unacknowledged, </span>
                                    <span class="c1">// "CLEARED_ACK" - cleared acknowledged)</span>
            <span class="na">details</span><span class="p">:</span> <span class="p">{}</span> <span class="c1">// Alarm details object derived from alarm details json.</span>
        <span class="p">}</span>
    <span class="p">]</span>               
</pre></td></tr></tbody></table></code></pre></div></div>

<p>For <a href="/docs/pe/user-guide/ui/widget-library/#rpc-control-widget">RPC</a> or <a href="/docs/pe/user-guide/ui/widget-library/#static">Static</a> widget types, subscription object is optional and does not contain necessary information.</p>

<h4 id="timewindow-functions">Timewindow functions</h4>

<p>Object with timewindow functions (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L45">TimewindowFunctions</a>) used to manage widget data time frame. Can by used by <a href="/docs/pe/user-guide/ui/widget-library/#time-series">Time-series</a> or <a href="/docs/pe/user-guide/ui/widget-library/#alarm-widget">Alarm</a> widgets.</p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onUpdateTimewindow(startTimeMs, endTimeMs)</code></td>
      <td>This function can be used to update current subscription time frame to historical one identified by <strong>startTimeMs</strong> and <strong>endTimeMs</strong> arguments.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">onResetTimewindow()</code></td>
      <td>Resets subscription time frame to default defined by widget timewindow component or dashboard timewindow depending on widget settings.</td>
    </tr>
  </tbody>
</table>

<h4 id="control-api">Control API</h4>

<p>Object that provides API functions (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L58">RpcApi</a>) for <a href="/docs/pe/user-guide/ui/widget-library/#rpc-control-widget">RPC (Control)</a> widgets.</p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sendOneWayCommand(method, params, timeout)</code></td>
      <td>Sends one way (without response) RPC command to the device. Returns command execution promise. <strong>method</strong> - RPC method name, string, <strong>params</strong> - RPC method params, custom json object, <strong>timeout</strong> - maximum delay in milliseconds to wait until response/acknowledgement is received.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sendTwoWayCommand(method, params, timeout)</code></td>
      <td>Sends two way (with response) RPC command to the device. Returns command execution promise with response body in success callback.</td>
    </tr>
  </tbody>
</table>

<h4 id="actions-api">Actions API</h4>

<p>Set of API functions (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L67">WidgetActionsApi</a>) to work with user defined actions.</p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getActionDescriptors(actionSourceId)</code></td>
      <td>Returns the list of action descriptors for provided <strong>actionSourceId</strong></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">handleWidgetAction($event, descriptor, entityId, entityName)</code></td>
      <td>Handles action produced by particular action source. <strong>$event</strong> - event object associated with action, <strong>descriptor</strong> - action descriptor, <strong>entityId</strong> and <strong>entityName</strong> - current entity id and name provided by action source if available.</td>
    </tr>
  </tbody>
</table>

<h4 id="state-controller">State Controller</h4>

<p>Reference to Dashboard state controller (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L121">IStateController</a>), providing API to manage current dashboard state.</p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">openState(id, params, openRightLayout)</code></td>
      <td>Navigates to new dashboard state. <strong>id</strong> - id of the target dashboard state, <strong>params</strong> - object with state parameters to use by the new state, <strong>openRightLayout</strong> - optional boolean argument to force open right dashboard layout if present in mobile view mode.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">updateState(id, params, openRightLayout)</code></td>
      <td>Updates current dashboard state. <strong>id</strong> - optional id of the target dashboard state to replace current state id, <strong>params</strong> - object with state parameters to update current state parameters, <strong>openRightLayout</strong> - optional boolean argument to force open right dashboard layout if present in mobile view mode.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getStateId()</code></td>
      <td>Returns current dashboard state id.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getStateParams()</code></td>
      <td>Returns current dashboard state parameters.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getStateParamsByStateId(id)</code></td>
      <td>Returns state parameters for particular dashboard state identified by <strong>id</strong>.</td>
    </tr>
  </tbody>
</table>

<h4 id="type-parameters-object">Type parameters object</h4>

<p>Object <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L146">WidgetTypeParameters</a> describing widget datasource parameters. It has the following properties:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>    <span class="k">return</span> <span class="p">{</span>
        <span class="na">maxDatasources</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1">// Maximum allowed datasources for this widget, -1 - unlimited</span>
        <span class="na">maxDataKeys</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1">//Maximum allowed data keys for this widget, -1 - unlimited</span>
        <span class="na">dataKeysOptional</span><span class="p">:</span> <span class="kc">false</span> <span class="c1">//Whether this widget can be configured with datasources without data keys</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="action-sources-object">Action sources object</h4>

<p>Map describing available widget action sources (<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L118">WidgetActionSource</a>) to which user actions can be assigned. It has the following structure:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>   <span class="k">return</span> <span class="p">{</span>
        <span class="dl">'</span><span class="s1">headerButton</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span> <span class="c1">// Action source Id (unique action source identificator)</span>
           <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Header button</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// Display name of action source, used in widget settings ('Actions' tab).</span>
           <span class="na">multiple</span><span class="p">:</span> <span class="kc">true</span> <span class="c1">// Boolean property indicating if this action source supports multiple action definitions (for ex. multiple buttons in one cell, or only one action can by assigned on table row click.)</span>
        <span class="p">}</span>
    <span class="p">};</span>   
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="creating-simple-widgets">Creating simple widgets</h3>

<p>The tutorials below show how to create minimal widgets of each type.
In order to minimize the amount of code, the Angular framework will be used, on which ThingsBoard UI is actually based.
By the way, you can always use pure JavaScript or jQuery API in your widget code.</p>

<h4 id="latest-values-widget">Latest Values widget</h4>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen and then click the “Create new widget type” button.
Click the <strong>Latest Values</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will open, pre-populated with the content of the default <strong>Latest Values</strong> template widget.</p>

<ul>
  <li>Clear content of the CSS tab of “Resources” section.</li>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;div</span> <span class="na">fxFlex</span> <span class="na">fxLayout=</span><span class="s">"column"</span> <span class="na">style=</span><span class="s">"height: 100%;"</span> <span class="na">fxLayoutAlign=</span><span class="s">"center stretch"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>My first latest values widget.<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">fxFlex</span> <span class="na">fxLayout=</span><span class="s">"row"</span> <span class="na">*ngFor=</span><span class="s">"let dataKeyData of data"</span> <span class="na">fxLayoutAlign=</span><span class="s">"space-around center"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>{{dataKeyData.dataKey.label}}:<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div&gt;</span>{{(dataKeyData.data[0] <span class="err">&amp;&amp;</span> dataKeyData.data[0][0]) | date : 'yyyy-MM-dd HH:mm:ss' }}<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div&gt;</span>{{dataKeyData.data[0] <span class="err">&amp;&amp;</span> dataKeyData.data[0][1]}}<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>    <span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="p">}</span>
        
    <span class="nb">self</span><span class="p">.</span><span class="nx">onDataUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/latest-values-widget-sample.png" alt="image" /></p>

<p>In this example, the <strong>data</strong> property of <a href="#subscription-object">subscription</a> is assigned to the <strong>$scope</strong> and becomes accessible within the HTML template.
Inside the HTML, a special <a href="https://angular.io/api/common/NgForOf"><strong>*ngFor</strong></a> structural angular directive is used in order to iterate over available dataKeys &amp; datapoints then render latest values with their corresponding timestamps.</p>

<h4 id="time-series-widget">Time-Series widget</h4>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen, then click the “Create new widget type” button.
Click the <strong>Time-Series</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will open, pre-populated with default <strong>Time-Series</strong> template widget content.</p>

<ul>
  <li>Replace content of the CSS tab in “Resources” section with the following one:</li>
</ul>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">.my-data-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;mat-tab-group</span> <span class="na">style=</span><span class="s">"height: 100%;"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;mat-tab</span> <span class="na">*ngFor=</span><span class="s">"let datasource of datasources; let $dsIndex = index"</span> <span class="na">label=</span><span class="s">"{{datasource.name}}"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"my-data-table"</span> <span class="na">style=</span><span class="s">"width: 100%;"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;thead&gt;</span>
                  <span class="nt">&lt;tr&gt;</span>
                      <span class="nt">&lt;th&gt;</span>Timestamp<span class="nt">&lt;/th&gt;</span>
                      <span class="nt">&lt;th</span> <span class="na">*ngFor=</span><span class="s">"let dataKeyData of datasourceData[$dsIndex]"</span><span class="nt">&gt;</span>{{dataKeyData.dataKey.label}}<span class="nt">&lt;/th&gt;</span>
                  <span class="nt">&lt;tr&gt;</span>          
              <span class="nt">&lt;/thead&gt;</span>
              <span class="nt">&lt;tbody&gt;</span>
                  <span class="nt">&lt;tr</span> <span class="na">*ngFor=</span><span class="s">"let data of datasourceData[$dsIndex][0].data; let $dataIndex = index"</span><span class="nt">&gt;</span>
                      <span class="nt">&lt;td&gt;</span>{{data[0] | date : 'yyyy-MM-dd HH:mm:ss'}}<span class="nt">&lt;/td&gt;</span>
                      <span class="nt">&lt;td</span> <span class="na">*ngFor=</span><span class="s">"let dataKeyData of datasourceData[$dsIndex]"</span><span class="nt">&gt;</span>{{dataKeyData.data[$dataIndex] <span class="err">&amp;&amp;</span> dataKeyData.data[$dataIndex][1]}}<span class="nt">&lt;/td&gt;</span>
                  <span class="nt">&lt;/tr&gt;</span>      
              <span class="nt">&lt;/tbody&gt;</span>          
          <span class="nt">&lt;/table&gt;</span>          
      <span class="nt">&lt;/mat-tab&gt;</span>       
  <span class="nt">&lt;/mat-tab-group&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">widgetTitle</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">My first Time-Series widget</span><span class="dl">'</span><span class="p">;</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">datasources</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">datasources</span><span class="p">;</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">datasourceData</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="kd">var</span> <span class="nx">currentDatasource</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">currentDatasourceIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">dataKeyData</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">dataKeyData</span><span class="p">.</span><span class="nx">datasource</span> <span class="o">!=</span> <span class="nx">currentDatasource</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">currentDatasource</span> <span class="o">=</span> <span class="nx">dataKeyData</span><span class="p">.</span><span class="nx">datasource</span>
            <span class="nx">currentDatasourceIndex</span><span class="o">++</span><span class="p">;</span>
            <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">datasourceData</span><span class="p">[</span><span class="nx">currentDatasourceIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
            
        <span class="p">}</span> 
        <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">datasourceData</span><span class="p">[</span><span class="nx">currentDatasourceIndex</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">dataKeyData</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">updateWidgetParams</span><span class="p">();</span>

<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onDataUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/timeseries-widget-sample.png" alt="image" /></p>

<p>In this example, the <a href="#subscription-object">subscription</a> <strong>datasources</strong> and <strong>data</strong> properties are assigned to <strong>$scope</strong> and become accessible within the HTML template.
The <strong>$scope.datasourceData</strong> property is introduced to map datasource specific dataKeys data by datasource index for flexible access within the HTML template.
Inside the HTML, a special <a href="https://angular.io/api/common/NgForOf"><strong>*ngFor</strong></a> structural angular directive is used in order to iterate over available datasources and render corresponding tabs.
Inside each tab, the table is rendered using dataKeys obtained from <strong>datasourceData</strong> scope property accessed by datasource index.
Each table renders columns by iterating over all <strong>dataKeyData</strong> objects and renders all available datapoints by iterating over <strong>data</strong> array of each <strong>dataKeyData</strong> to render timestamps and values.
Note that in this code, <strong>onDataUpdated</strong> function is implemented with a call to <strong>detectChanges</strong> function necessary to perform new change detection cycle when new data is received.</p>

<h4 id="rpc-control-widget">RPC (Control) widget</h4>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen and then click the “Create new widget type” button.
Click the <strong>Control Widget</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will open, pre-populated with default <strong>Control</strong> template widget content.</p>

<ul>
  <li>Clear content of the CSS tab of “Resources” section.</li>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>    <span class="nt">&lt;form</span> <span class="na">#rpcForm</span><span class="err">="</span><span class="na">ngForm</span><span class="err">"</span> <span class="na">(submit)=</span><span class="s">"sendCommand()"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"mat-content mat-padding"</span> <span class="na">fxLayout=</span><span class="s">"column"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;mat-form-field</span> <span class="na">class=</span><span class="s">"mat-block"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;mat-label&gt;</span>RPC method<span class="nt">&lt;/mat-label&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">matInput</span> <span class="na">required</span> <span class="na">name=</span><span class="s">"rpcMethod"</span> <span class="na">#rpcMethodField</span><span class="err">="</span><span class="na">ngModel</span><span class="err">"</span> <span class="na">[(ngModel)]=</span><span class="s">"rpcMethod"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;mat-error</span> <span class="na">*ngIf=</span><span class="s">"rpcMethodField.hasError('required')"</span><span class="nt">&gt;</span>
            RPC method name is required.
          <span class="nt">&lt;/mat-error&gt;</span>
        <span class="nt">&lt;/mat-form-field&gt;</span>
        <span class="nt">&lt;mat-form-field</span> <span class="na">class=</span><span class="s">"mat-block"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;mat-label&gt;</span>RPC params<span class="nt">&lt;/mat-label&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">matInput</span> <span class="na">required</span> <span class="na">name=</span><span class="s">"rpcParams"</span> <span class="na">#rpcParamsField</span><span class="err">="</span><span class="na">ngModel</span><span class="err">"</span> <span class="na">[(ngModel)]=</span><span class="s">"rpcParams"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;mat-error</span> <span class="na">*ngIf=</span><span class="s">"rpcParamsField.hasError('required')"</span><span class="nt">&gt;</span>
            RPC params is required.
          <span class="nt">&lt;/mat-error&gt;</span>
        <span class="nt">&lt;/mat-form-field&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">[disabled]=</span><span class="s">"rpcForm.invalid || !rpcForm.dirty"</span> <span class="na">mat-raised-button</span> <span class="na">color=</span><span class="s">"primary"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="nt">&gt;</span>
          Send RPC command
        <span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;div&gt;</span>
          <span class="nt">&lt;label&gt;</span>RPC command response<span class="nt">&lt;/label&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"width: 100%; height: 100px; border: solid 2px gray"</span> <span class="na">[innerHTML]=</span><span class="s">"rpcCommandResponse"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JSON content inside the “Settings schema” tab of <strong>Settings schema section</strong>:</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Settings"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"oneWayElseTwoWay"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Is One Way Command"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"boolean"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"requestTimeout"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RPC request timeout"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"oneWayElseTwoWay"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"requestTimeout"</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">sendCommand</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">rpcMethod</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcMethod</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">rpcParams</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcParams</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">requestTimeout</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">oneWayElseTwoWay</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">oneWayElseTwoWay</span> <span class="p">?</span> <span class="kc">true</span> <span class="p">:</span> <span class="kc">false</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">commandObservable</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oneWayElseTwoWay</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">commandObservable</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">controlApi</span><span class="p">.</span><span class="nx">sendOneWayCommand</span><span class="p">(</span><span class="nx">rpcMethod</span><span class="p">,</span> <span class="nx">rpcParams</span><span class="p">,</span> <span class="nx">timeout</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">commandObservable</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">controlApi</span><span class="p">.</span><span class="nx">sendTwoWayCommand</span><span class="p">(</span><span class="nx">rpcMethod</span><span class="p">,</span> <span class="nx">rpcParams</span><span class="p">,</span> <span class="nx">timeout</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">commandObservable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">oneWayElseTwoWay</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Command was successfully received by device.&lt;br&gt; No response body because of one way command mode.</span><span class="dl">"</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Response from device:&lt;br&gt;</span><span class="dl">"</span><span class="p">;</span>                    
                    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">+=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
            <span class="p">},</span>
            <span class="kd">function</span> <span class="p">(</span><span class="nx">rejection</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Failed to send command to the device:&lt;br&gt;</span><span class="dl">"</span>
                <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">Status: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">rejection</span><span class="p">.</span><span class="nx">status</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;br&gt;</span><span class="dl">"</span><span class="p">;</span>
                <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">rpcCommandResponse</span> <span class="o">+=</span> <span class="dl">"</span><span class="s2">Status text: '</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">rejection</span><span class="p">.</span><span class="nx">statusText</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">'</span><span class="dl">"</span><span class="p">;</span>
                <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
            <span class="p">}</span>
            
        <span class="p">);</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Fill <strong>Widget title</strong> field with widget type name, for ex. “My first control widget”.</li>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
  <li>Click dashboard edit button on the preview section to change the size of the resulting widget. Then click dashboard apply button. The final widget should look like the image below.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/control-widget-sample.png" alt="image" /></p>

<ul>
  <li>Click the <strong>Save</strong> button on the <strong>Widget Editor Toolbar</strong> to save widget type.</li>
</ul>

<p>To test how this widget performs RPC commands, we will need to place it in a dashboard then bind it to a device working with RPC commands. To do this, perform the following steps:</p>

<ul>
  <li>Login as Tenant administrator.</li>
  <li>Navigate to <strong>Devices</strong> and create new device with some name, for ex. “My RPC Device”.</li>
  <li>Open device details and click “Copy Access Token” button to copy device access token to clipboard.</li>
  <li>Download <a href="/docs/pe/reference/resources/mqtt-js-rpc-from-server.sh">mqtt-js-rpc-from-server.sh</a> and <a href="/docs/pe/reference/resources/mqtt-js-rpc-from-server.js">mqtt-js-rpc-from-server.js</a>. Place these files in a folder. 
 Edit <strong>mqtt-js-rpc-from-server.sh</strong> - replace <strong>$ACCESS_TOKEN</strong> with your device access token from the clipboard. And install mqtt client library.</li>
  <li>Run <strong>mqtt-js-rpc-from-server.sh</strong> script. You should see a “connected” message in the console.</li>
  <li>Navigate to <strong>Dashboards</strong> and create a new dashboard with some name, for ex. “My first control dashboard”. Open this dashboard.</li>
  <li>Click dashboard “edit” button. In the dashboard edit mode, click the “Entity aliases” button located on the dashboard toolbar.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/dashboard-toolbar-entity-aliases.png" alt="image" /></p>

<ul>
  <li>Inside <strong>Entity aliases</strong> popup click “Add alias”.</li>
  <li>Fill “Alias name” field, for ex. “My RPC Device Alias”.</li>
  <li>Select “Entity list” in “Filter type” field.</li>
  <li>Choose “Device” in “Type” field.</li>
  <li>Select your device in “Entity list” field. In this example “My RPC Device”.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/add-rpc-device-alias.png" alt="image" /></p>

<ul>
  <li>Click “Add” and then “Save” in <strong>Entity aliases</strong>.</li>
  <li>Click dashboard “+” button then click “Create new widget” button.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/dashboard-create-new-widget-button.png" alt="image" /></p>

<ul>
  <li>Then select <strong>Widget Bundle</strong> where your RPC widget was saved. Select “Control widget” tab.</li>
  <li>Click your widget. In this example, “My first control widget”.</li>
  <li>From <strong>Add Widget</strong> popup, select your device alias in <strong>Target device</strong> section. In this example “My RPC Device Alias”.</li>
  <li>Click <strong>Add</strong>. Your Control widget will appear in the dashboard. Click dashboard <strong>Apply changes</strong> button to save dashboard and leave editing mode.</li>
  <li>Fill <strong>RPC method</strong> field with RPC method name. For ex. “TestMethod”.</li>
  <li>Fill <strong>RPC params</strong> field with RPC params. For ex. “{ param1: “value1” }”.</li>
  <li>Click <strong>Send RPC command</strong> button. You should see the following response in the widget.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/control-widget-sample-response-one-way.png" alt="image" /></p>

<p>The following output should be printed in the device console:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>  request.topic: v1/devices/me/rpc/request/0
  request.body: <span class="o">{</span><span class="s2">"method"</span>:<span class="s2">"TestMethod"</span>,<span class="s2">"params"</span>:<span class="s2">"{ param1: </span><span class="se">\"</span><span class="s2">value1</span><span class="se">\"</span><span class="s2"> }"</span><span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>In order to test “Two way” RPC command mode, we need to change the corresponding widget settings property. To do this, perform the following steps:</p>

<ul>
  <li>Click dashboard “edit” button. In dashboard edit mode, click <strong>Edit widget</strong> button located in the header of Control widget.</li>
  <li>In the widget details, view select “Advanced” tab and uncheck “Is One Way Command” checkbox.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/control-widget-sample-settings.png" alt="image" /></p>

<ul>
  <li>Click <strong>Apply changes</strong> button on the widget details header. Close details and click dashboard <strong>Apply changes</strong> button.</li>
  <li>Fill widget fields with RPC method name and params like in previous steps. 
 Click <strong>Send RPC command</strong> button. You should see the following response in the widget.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/control-widget-sample-response-two-way.png" alt="image" /></p>

<ul>
  <li>stop <strong>mqtt-js-rpc-from-server.sh</strong> script.
 Click <strong>Send RPC command</strong> button. You should see the following response in the widget.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/control-widget-sample-response-timeout.png" alt="image" /></p>

<p>In this example, <strong>controlApi</strong> is used to send RPC commands. Additionally, custom widget settings were introduced in order to configure RPC command mode and RPC request timeout.
The response from the device is handled by <strong>commandObservable</strong>.  It has success and failed callbacks with corresponding response, or rejection objects containing information about request execution result.</p>

<h4 id="alarm-widget">Alarm widget</h4>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen and then click the “Create new widget type” button.
Click the <strong>Alarm Widget</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will be opened, pre-populated with the content of the default <strong>Alarm</strong> template widget.</p>

<ul>
  <li>Replace content of the CSS tab in “Resources” section with the following one:</li>
</ul>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">.my-alarm-table</span> <span class="nt">th</span> <span class="p">{</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;div</span> <span class="na">fxFlex</span> <span class="na">fxLayout=</span><span class="s">"column"</span> <span class="na">style=</span><span class="s">"height: 100%;"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div&gt;</span>My first Alarm widget.<span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"my-alarm-table"</span> <span class="na">style=</span><span class="s">"width: 100%;"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;thead&gt;</span>
              <span class="nt">&lt;tr&gt;</span>
                  <span class="nt">&lt;th</span> <span class="na">*ngFor=</span><span class="s">"let dataKey of alarmSource?.dataKeys"</span><span class="nt">&gt;</span>{{dataKey.label}}<span class="nt">&lt;/th&gt;</span> 
              <span class="nt">&lt;tr&gt;</span>          
          <span class="nt">&lt;/thead&gt;</span>
          <span class="nt">&lt;tbody&gt;</span>
              <span class="nt">&lt;tr</span> <span class="na">*ngFor=</span><span class="s">"let alarm of alarms"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;td</span> <span class="na">*ngFor=</span><span class="s">"let dataKey of alarmSource?.dataKeys"</span> 
                      <span class="na">[ngStyle]=</span><span class="s">"getAlarmCellStyle(alarm, dataKey)"</span><span class="nt">&gt;</span>
                      {{getAlarmValue(alarm, dataKey)}}
                  <span class="nt">&lt;/td&gt;</span>
              <span class="nt">&lt;/tr&gt;</span>      
          <span class="nt">&lt;/tbody&gt;</span>          
      <span class="nt">&lt;/table&gt;</span>          
  <span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JSON content inside the “Settings schema” tab of <strong>Settings schema section</strong>:</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AlarmTableSettings"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"alarmSeverityColorFunction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Alarm severity color function: f(severity)"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"if(severity == 'CRITICAL') {return 'red';} else if (severity == 'MAJOR') {return 'orange';} else return 'green'; "</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alarmSeverityColorFunction"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"javascript"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre><span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">pageLink</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">pageLink</span><span class="p">();</span>

    <span class="nx">pageLink</span><span class="p">.</span><span class="nx">typeList</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">widgetConfig</span><span class="p">.</span><span class="nx">alarmTypeList</span><span class="p">;</span>
    <span class="nx">pageLink</span><span class="p">.</span><span class="nx">statusList</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">widgetConfig</span><span class="p">.</span><span class="nx">alarmStatusList</span><span class="p">;</span>
    <span class="nx">pageLink</span><span class="p">.</span><span class="nx">severityList</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">widgetConfig</span><span class="p">.</span><span class="nx">alarmSeverityList</span><span class="p">;</span>
    <span class="nx">pageLink</span><span class="p">.</span><span class="nx">searchPropagatedAlarms</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">widgetConfig</span><span class="p">.</span><span class="nx">searchPropagatedAlarms</span><span class="p">;</span>

    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">subscribeForAlarms</span><span class="p">(</span><span class="nx">pageLink</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">alarmSource</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">alarmSource</span><span class="p">;</span>
    
    <span class="kd">var</span> <span class="nx">alarmSeverityColorFunctionBody</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">alarmSeverityColorFunction</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">alarmSeverityColorFunctionBody</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span> <span class="o">||</span> <span class="o">!</span><span class="nx">alarmSeverityColorFunctionBody</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alarmSeverityColorFunctionBody</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">if(severity == 'CRITICAL') {return 'red';} else if (severity == 'MAJOR') {return 'orange';} else return 'green';</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">var</span> <span class="nx">alarmSeverityColorFunction</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">alarmSeverityColorFunction</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">severity</span><span class="dl">'</span><span class="p">,</span> <span class="nx">alarmSeverityColorFunctionBody</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alarmSeverityColorFunction</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">getAlarmValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">alarm</span><span class="p">,</span> <span class="nx">dataKey</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">alarmKey</span> <span class="o">=</span> <span class="nx">dataKey</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">alarmKey</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">originator</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">alarmKey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">originatorName</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">alarm</span><span class="p">[</span><span class="nx">alarmKey</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">alarmKey</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">createdTime</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">date</span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="dl">'</span><span class="s1">yyyy-MM-dd HH:mm:ss</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">getAlarmCellStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">alarm</span><span class="p">,</span> <span class="nx">dataKey</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">alarmKey</span> <span class="o">=</span> <span class="nx">dataKey</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">alarmKey</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">severity</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">alarmSeverityColorFunction</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">severity</span> <span class="o">=</span> <span class="nx">alarm</span><span class="p">[</span><span class="nx">alarmKey</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">alarmSeverityColorFunction</span><span class="p">(</span><span class="nx">severity</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="na">color</span><span class="p">:</span> <span class="nx">color</span>  
            <span class="p">};</span>
        <span class="p">}</span> 
        <span class="k">return</span> <span class="p">{};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onDataUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">alarms</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">alarms</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">detectChanges</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/alarm-widget-sample.png" alt="image" /></p>

<p>In this example, the <strong>alarmSource</strong> and <strong>alarms</strong> properties of <a href="#subscription-object">subscription</a> are assigned to <strong>$scope</strong> and become accessible within HTML template.
Inside the HTML, a special <a href="https://angular.io/api/common/NgForOf"><strong>*ngFor</strong></a> structural angular directive is used in order to iterate over available alarm <strong>dataKeys</strong> of <strong>alarmSource</strong> and render corresponding columns.
The table rows are rendered by iterating over <strong>alarms</strong> array and corresponding cells rendered by iterating over <strong>dataKeys</strong>.
The function <strong>getAlarmValue</strong> is fetching alarm value and formatting <strong>createdTime</strong> alarm property using a <a href="https://angular.io/api/common/DatePipe">DatePipe</a> angular pipe accessible via <strong>date</strong> property of <strong>ctx</strong>.
The function <strong>getAlarmCellStyle</strong> is used to assign custom cell styles for each alarm cell. In this example, we introduced new settings property called <strong>alarmSeverityColorFunction</strong> that contains function body returning color depending on alarm severity.
Inside the <strong>getAlarmCellStyle</strong> function there is corresponding invocation of <strong>alarmSeverityColorFunction</strong> with severity value in order to get color for alarm severity cell. 
Note that in this code <strong>onDataUpdated</strong> function is implemented in order to update <strong>alarms</strong> property with latest alarms from subscription and invoke change detection using <strong>detectChanges()</strong> function.</p>

<h4 id="static-widget">Static widget</h4>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen and then click the “Create new widget type” button.
Click the <strong>Static Widget</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will be opened pre-populated with the content of default <strong>Static</strong> template widget.</p>

<ul>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;div</span> <span class="na">fxFlex</span> <span class="na">fxLayout=</span><span class="s">"column"</span> <span class="na">style=</span><span class="s">"height: 100%;"</span> <span class="na">fxLayoutAlign=</span><span class="s">"space-around stretch"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h3</span> <span class="na">style=</span><span class="s">"text-align: center;"</span><span class="nt">&gt;</span>My first static widget.<span class="nt">&lt;/h3&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">mat-raised-button</span> <span class="na">color=</span><span class="s">"primary"</span> <span class="na">(click)=</span><span class="s">"showAlert()"</span><span class="nt">&gt;</span>Click me<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JSON content inside the “Settings schema” tab of <strong>Settings schema section</strong>:</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Settings"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"alertContent"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Alert content"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Content derived from alertContent property of widget settings."</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"form"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"alertContent"</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">showAlert</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">alertContent</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">alertContent</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">alertContent</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">alertContent</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Content derived from alertContent property of widget settings.</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">alertContent</span><span class="p">);</span>  
    <span class="p">};</span>

<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> to see the resulting <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/static-widget-sample.png" alt="image" /></p>

<p>This is just a static HTML widget.  There is no subscription data and no special widget API was used.
Only custom <strong>showAlert</strong> function was implemented showing an alert with the content of <strong>alertContent</strong> property of widget settings.
You can switch to dashboard edit mode in <strong>Widget preview</strong> section and change value of <strong>alertContent</strong> by changing widget settings in the “Advanced” tab of widget details.
Then you can see that the new alert content is displayed.</p>

<h2 id="integrating-existing-code-to-create-widget-definition">Integrating existing code to create widget definition</h2>

<p>Below are some examples demonstrating how external JavaScript libraries or existing code can be reused/integrated to create new widgets.</p>

<h3 id="using-external-javascript-library">Using external JavaScript library</h3>

<h4 id="latest-values-example">Latest Values Example</h4>

<p>In this example, <strong>Latest Values</strong> gauge widget will be created using external <a href="http://bernii.github.io/gauge.js/">gauge.js</a> library.</p>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen, then click the “Create new widget type” button.
Click the <strong>Latest Values</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will be opened, pre-populated with the content of default <strong>Latest Values</strong> template widget.</p>

<ul>
  <li>Open <strong>Resources</strong> tab and click “Add” then insert the following link:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>https://bernii.github.io/gauge.js/dist/gauge.min.js  
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Clear content of the CSS tab of “Resources” section.</li>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">"my-gauge"</span><span class="nt">&gt;&lt;/canvas&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">canvasElement</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">gauge</span><span class="p">;</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">canvasElement</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#my-gauge</span><span class="dl">'</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$container</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">gauge</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gauge</span><span class="p">(</span><span class="nx">canvasElement</span><span class="p">);</span>
    <span class="nx">gauge</span><span class="p">.</span><span class="nx">minValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span><span class="p">;</span> 
    <span class="nx">gauge</span><span class="p">.</span><span class="nx">maxValue</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> 
    <span class="nx">gauge</span><span class="p">.</span><span class="nx">animationSpeed</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> 
    <span class="nb">self</span><span class="p">.</span><span class="nx">onResize</span><span class="p">();</span>
<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onResize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">canvasElement</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="nx">canvasElement</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
    <span class="nx">gauge</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">gauge</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onDataUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">defaultSubscription</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
        <span class="nx">gauge</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/external-js-widget-sample.png" alt="image" /></p>

<p>In this example, the external JS library API was used that becomes available after injecting the corresponding URL in <strong>Resources</strong> section.
The value displayed was obtained from <a href="#subscription-object">subscription</a> <strong>data</strong> property for the first dataKey.</p>

<h4 id="time-series-example">Time-Series Example</h4>

<p>In this example, <strong>Time-Series</strong> line chart widget will be created using external <a href="https://www.chartjs.org/">Chart.js</a> library.</p>

<p>In the <strong>Widgets Bundle</strong> view, click the big “+” button at the bottom-right part of the screen, then click the “Create new widget type” button.
Click the <strong>Time-Series</strong> button on the <strong>Select widget type</strong> popup.
The <strong>Widget Editor</strong> will be opened, pre-populated with the content of default <strong>Time-Series</strong> template widget.</p>

<ul>
  <li>Open <strong>Resources</strong> tab and click “Add” then insert the following link:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Clear content of the CSS tab of “Resources” section.</li>
  <li>Put the following HTML code inside the HTML tab of “Resources” section:</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">"myChart"</span><span class="nt">&gt;&lt;/canvas&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Put the following JavaScript code inside the “JavaScript” section:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">myChart</span><span class="p">;</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="kd">var</span> <span class="nx">chartData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">datasets</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">dataKey</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">dataKey</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">dataset</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">label</span><span class="p">:</span> <span class="nx">dataKey</span><span class="p">.</span><span class="nx">label</span><span class="p">,</span>
            <span class="na">data</span><span class="p">:</span> <span class="p">[],</span>
            <span class="na">borderColor</span><span class="p">:</span> <span class="nx">dataKey</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span>
            <span class="na">fill</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">};</span>
        <span class="nx">chartData</span><span class="p">.</span><span class="nx">datasets</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dataset</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">maintainAspectRatio</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">legend</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">display</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">},</span>
        <span class="na">scales</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">xAxes</span><span class="p">:</span> <span class="p">[{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">time</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">ticks</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">maxRotation</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="na">autoSkipPadding</span><span class="p">:</span> <span class="mi">30</span>
            <span class="p">}</span>
        <span class="p">}]</span>
    <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="kd">var</span> <span class="nx">canvasElement</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#myChart</span><span class="dl">'</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">$container</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">canvasCtx</span> <span class="o">=</span> <span class="nx">canvasElement</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">2d</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">myChart</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Chart</span><span class="p">(</span><span class="nx">canvasCtx</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">line</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">data</span><span class="p">:</span> <span class="nx">chartData</span><span class="p">,</span>
        <span class="na">options</span><span class="p">:</span> <span class="nx">options</span>
    <span class="p">});</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">onResize</span><span class="p">();</span>
<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onResize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">myChart</span><span class="p">.</span><span class="nx">resize</span><span class="p">();</span>
<span class="p">}</span>

<span class="nb">self</span><span class="p">.</span><span class="nx">onDataUpdated</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">datasourceData</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">dataSet</span> <span class="o">=</span> <span class="nx">datasourceData</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
        <span class="nx">myChart</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">datasets</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">myChart</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">datasets</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">data</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">d</span> <span class="o">&lt;</span> <span class="nx">dataSet</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">d</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">tsValuePair</span> <span class="o">=</span> <span class="nx">dataSet</span><span class="p">[</span><span class="nx">d</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">ts</span> <span class="o">=</span> <span class="nx">tsValuePair</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">tsValuePair</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="na">t</span><span class="p">:</span> <span class="nx">ts</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="nx">value</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">myChart</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scales</span><span class="p">.</span><span class="nx">xAxes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ticks</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">timeWindow</span><span class="p">.</span><span class="nx">minTime</span><span class="p">;</span>
    <span class="nx">myChart</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scales</span><span class="p">.</span><span class="nx">xAxes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">ticks</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="nx">timeWindow</span><span class="p">.</span><span class="nx">maxTime</span><span class="p">;</span>
    <span class="nx">myChart</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Click the <strong>Run</strong> button on the <strong>Widget Editor Toolbar</strong> in order to see the result in <strong>Widget preview</strong> section.</li>
</ul>

<p><img src="/images/user-guide/contribution/widgets/external-js-timeseries-widget-sample.png" alt="image" /></p>

<p>In this example, the external JS library API was used that becomes available after injecting the corresponding URL in <strong>Resources</strong> section.
Initially chart datasets prepared using configured dataKeys from <strong>data</strong> property of <strong>ctx</strong>.
In the <strong>onDataUpdated</strong> function datasources data converted to Chart.js line chart format and pushed to chart datasets.
Please note that xAxis (time axis) is limited to current timewindow bounds obtained from <strong>timeWindow</strong> property of <strong>ctx</strong>.</p>

<h3 id="using-existing-javascript-code">Using existing JavaScript code</h3>

<p>Another approach of creating widgets is to use existing bundled JavaScript code.
In this case, you can create own TypeScript class or Angular component and bundle it into the ThingsBoard UI code.
In order to make this code accessible within the widget, you need to register corresponding Angular module or inject TypeScript class to a global variable (for ex. window object).
Some of the ThingsBoard widgets already use this approach. Take a look at the <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/polyfills.ts#L106">polyfills.ts</a>
or <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/components/widget/widget-components.module.ts#L44">widget-components.module.ts</a>.
Here you can find how some bundled classes or components are registered for later use in ThingsBoard widgets.
For example “Timeseries - Flot” widget (from “Charts” Widgets Bundle) uses <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/components/widget/lib/flot-widget.ts#L63"><strong>TbFlot</strong></a> TypeScript class which is injected as window property inside <strong>polyfills.ts</strong>:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">...</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">TbFlot</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@home/components/widget/lib/flot-widget</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>

    <span class="p">(</span><span class="nb">window</span> <span class="k">as</span> <span class="kr">any</span><span class="p">).</span><span class="nx">TbFlot</span> <span class="o">=</span> <span class="nx">TbFlot</span><span class="p">;</span>
<span class="p">...</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Another example is “Timeseries table” widget (from “Cards” Widgets Bundle) that uses Angular component <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/components/widget/lib/timeseries-table-widget.component.ts#L99"><strong>tb-timeseries-table-widget</strong></a> which is registered as dependency of <strong>WidgetComponentsModule</strong> Angular module inside <strong>widget-components.module.ts</strong>.
Thereby this component becomes available for use inside the widget template HTML.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="p">...</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">TimeseriesTableWidgetComponent</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@home/components/widget/lib/timeseries-table-widget.component</span><span class="dl">'</span><span class="p">;</span>

<span class="p">...</span>

<span class="p">@</span><span class="nd">NgModule</span><span class="p">({</span>
  <span class="na">declarations</span><span class="p">:</span>
    <span class="p">[</span>
<span class="p">...</span>
      <span class="nx">TimeseriesTableWidgetComponent</span><span class="p">,</span>
<span class="p">...</span>
    <span class="p">],</span>
<span class="p">...</span>
  <span class="na">exports</span><span class="p">:</span> <span class="p">[</span>
<span class="p">...</span>
      <span class="nx">TimeseriesTableWidgetComponent</span><span class="p">,</span>
<span class="p">...</span>
  <span class="p">],</span>
<span class="p">...</span>    
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">WidgetComponentsModule</span> <span class="p">{</span> <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="widget-code-debugging-tips">Widget code debugging tips</h2>

<p>The most simple method of debugging is Web console output.
Just place <a href="https://developer.mozilla.org/en-US/docs/Web/API/Console/log"><strong>console.log(…)</strong></a> function inside any part of widget JavaScript code.
Then click <strong>Run</strong> button to restart widget code and observe debug information in the Web console.</p>

<p>Another and most effective method of debugging is to invoke browser debugger.
Put <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger"><strong>debugger;</strong></a> statement into the place of widget code you are interested in and then click <strong>Run</strong> button to restart widget code.
Browser debugger (if enabled) will automatically pause code execution at the debugger statement and you will be able to analyze script execution using browser debugging tools.</p>

<h2 id="next-steps">Next steps</h2>

<ul>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDGettingStartedGuides">Getting started guides</a> - These guides provide quick overview of main ThingsBoard features. Designed to be completed in 15-30 minutes.</p>
  </li>
  <li>
    <p><a href="/docs/user-guide/install/pe/installation-options/">Installation guides</a> - Learn how to setup ThingsBoard on various available operating systems.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDConnectYourDevice">Connect your device</a> - Learn how to connect devices based on your connectivity technology or solution.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDDataVisualization">Data visualization</a> - These guides contain instructions how to configure complex ThingsBoard dashboards.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDDataProcessing">Data processing &amp; actions</a> - Learn how to use ThingsBoard Rule Engine.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDDataAnalytics">IoT Data analytics</a> - Learn how to use rule engine to perform basic analytics tasks.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDHardwareSamples">Hardware samples</a> - Learn how to connect various hardware platforms to ThingsBoard.</p>
  </li>
  <li>
    <p><a href="/docs/pe/guides#AnchorIDAdvancedFeatures">Advanced features</a> - Learn about advanced ThingsBoard features.</p>
  </li>
</ul>

<p><br /></p>


      </div>
      <footer>
	<main class="light-text">
		<div class="newsletterSubsContainer">
            <script type="text/javascript">
                function subscribeForNewsletter(event) {
                    event.stopPropagation();
                    var script_tag = document.createElement('script');
                    script_tag.setAttribute("type", "text/javascript");
                    script_tag.setAttribute("src", "https://static.mailerlite.com/js/w/webforms.min.js?v28bf44f740701752bfc6767bc7e171d4");
                    document.getElementsByTagName("head")[0].appendChild(script_tag);
                    $(event.target).css('display', 'none');
                    $('#mlb2-7341216').css('display', 'block');
                }
            </script>
            <button class="n-button price subscribe" onClick="subscribeForNewsletter(event)">Sign up for ThingsBoard news</button>
            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: none;">
<!--            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: block;">-->
                <div class="ml-vertical-align-center">
                    <div class="subscribe-form ml-block-success" style="display: none;">
                        <div class="form-section">
                            <p>Thank you for your interest in ThingsBoard!<br/>Have a great day!</p>
                        </div>
                    </div>
                    <form class="ml-block-form" action="https://static.mailerlite.com/webforms/submit/r9r9x7" data-id="708170" data-code="r9r9x7" method="POST" target="_blank">
                        <div class="subscribe-form horizontal">
                            <div class="form-section horizontal">
                                <div class="form-group ml-field-email ml-validate-required ml-validate-email">
                                    <input type="email" name="fields[email]" class="form-control" placeholder="Email address*" value="" autocomplete="email" x-autocompletetype="email" spellcheck="false" autocapitalize="off" autocorrect="off">
                                </div>
                            </div>
                            <input type="hidden" name="ml-submit" value="1">
                            <div class="form-section horizontal ml-button-position">
                                <button class="primary n-button price subscribe" type="submit">
                                    Subscribe
                                </button>
                                <button disabled="disabled" style="display: none;" type="button" class="n-button loading">
                                    <img src="https://static.mailerlite.com/images/rolling@2x.gif" width="20" height="20" style="width: 20px; height: 20px;">
                                </button>
                            </div>
                            <p>By subscribing you agree to receive newsletters from ThingsBoard, Inc.</p>
                        </div>
                    </form>
                </div>
            </div>
		</div>

        <hr>

        <div class="deeper">
            <a href="/" class="footer-logo"></a>
            <nav>
                <a href="/docs/getting-started-guides/helloworld/">Get Started</a>
                <a href="/docs/">Documentation</a>
                <a href="/iot-use-cases/">Use cases</a>
                <a href="https://blog.thingsboard.io/">Blog</a>
                <a href="/docs/services/">Services</a>
                <a href="/docs/contact-us/">Contact us</a>
            </nav>
        </div>

        <div class="deepmost">
            <div class="copyright">&copy; 2021 The ThingsBoard Authors</div>
            <div class="social">
                <a href="https://github.com/thingsboard/thingsboard" class="github"></a>
                <a href="https://gitter.im/thingsboard/chat" class="gitter"></a>
                <a href="https://www.youtube.com/thingsboard" class="youtube"></a>
                <a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"></a>
                <a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"></a>
                <a href="https://www.facebook.com/thingsboard" class="facebook"></a>
                <a href="https://twitter.com/thingsboard" class="twitter"></a>
            </div>
        </div>
	</main>
</footer>

  </div>
</section>

<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
<script>
    jqueryDefer(function () {
        $(document).on('selectionchange',function() {
        // $(document).mouseup(function () {
            $('.clipboard-btn').removeClass('noChars');
            var selectedChars = getSelectedText();
            // $('#numberChars').html(selectedChars.length);
            if (selectedChars == 0) {
                $('.clipboard-btn').addClass('noChars');
            }
        });
    });
    function getSelectedText() {
        var text;
        if (window.getSelection) {
            text = window.getSelection().toString();
        } else if (document.getSelection) {
            text = document.getSelection();
        } else if (document.selection) {
            text = document.selection.createRange().text;
        }
        return text;
    }
</script>
<script>
    jqueryDefer(function () {
        $(document).ready(function () {
            var allCodeBlocksElements = $(".copy-code");
            allCodeBlocksElements.each(function (i) {
                var codeBlock = $(this);
                if (!codeBlock.hasClass('highlighter-rouge')) {
                    codeBlock = codeBlock.find('.highlighter-rouge');
                }
                codeBlock.each(function () {
                    var block = codeBlock.find('pre.highlight > code .rouge-code');
                    var currentId = "codeblock" + (i + 1);
                    block.attr('id', currentId);
                    var clipButton = $('<button class="clipboard-btn" data-clipboard-target="#' + currentId + '"><p>Copy to clipboard</p><div><img src="/images/copy-code-icon.svg" alt="Copy to clipboard"></div></button>');
                    $(this).append(clipButton);
                    var troyan = codeBlock.find('pre.highlight');
                    var Tooltip = $('<div class="customTooltip"><div class="tooltipText">Copied!</div></div>');
                    troyan.append(Tooltip);
                    troyan.addClass('clipboard-btn');
                    troyan.attr('data-clipboard-target', "#" + currentId);
                    troyan.on('mouseleave', clearTooltip);
                    troyan.on('blur', clearTooltip);
                    troyan.on('click', function(e) {
                        var el = $(e.currentTarget);
                        if (el.hasClass('showTool')) {
                            clearTooltip(e);
                            troyan.attr('data-skip-tooltip', "true");
                        }
                    });
                });
            });

            var clipboard = new Clipboard('.noChars');
            clipboard.on('success', function (e) {
                $('.clipboard-btn').removeClass('noChars');
                e.clearSelection();
                var trigger = e.trigger;
                if (!$(trigger).attr('data-skip-tooltip')) {
                    showTooltip(e.trigger, 'Copied!');
                } else {
                    $(trigger).removeAttr('data-skip-tooltip');
                }
            });

            $('#search').focus(
                function(){
                    $(this).parent('#searchBox').addClass('focused');
                }).blur(
                function(){
                    $(this).parent('#searchBox').removeClass('focused');
                });

            $('#searchBox .searchButton').click(function () {
                var value = $('#search').val();
                window.location.replace('/docs/pe/search/?q=' + value);
            });

            $('#docsBreadcrumbs').click(function () {
                if ($(this).hasClass('active')) {
                    $(this).removeClass('active');
                    $('#docsNav').removeClass('active');
                    $('#searchBox').removeClass('visible');
                } else {
                    $(this).addClass('active');
                    $('#docsNav').addClass('active');
                    $('#searchBox').addClass('visible');
                }
            });
        });

        function clearTooltip(e) {
            var el = $(e.currentTarget);
            el.removeClass('showTool');
            el.attr('aria-label', null);
        }

        function showTooltip(elem, msg) {
            var el = $(elem);
            el.addClass('showTool');
            el.attr('aria-label', msg);
        }
    });
</script>

<script>
    jqueryDefer(function () {
        var markdownTocs = null;
        var contentAnchors = [];
        var activeAnchor = null;
        var firstAnchor = null;
        var lastAnchor = null;

        function updatePositions() {
            contentAnchors = [];
            markdownTocs.each(function (i) {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                var contentAnchor = $('div#content ' + href);
                var top = Math.floor(contentAnchor.offset().top);
                var bottom;
                if (i < markdownTocs.length - 1) {
                    var nextHref = $(markdownTocs[i + 1]).children('a').attr('href');
                    var nextContentAnchor = $('div#content ' + nextHref);
                    bottom = Math.floor(nextContentAnchor.offset().top);
                } else {
                    bottom = $('div#content').offset().top + $('div#content').innerHeight();
                }
                var contentAnchorInfo = {anchor: contentAnchor, toc: $(this), top: top, bottom: bottom, href: href};
                contentAnchors.push(contentAnchorInfo);
                if (i === 0) {
                    firstAnchor = contentAnchorInfo;
                }
                if (i === markdownTocs.length - 1) {
                    lastAnchor = contentAnchorInfo;
                }
            });
        }

        function findActiveContentToc() {
            var top = $(window).scrollTop();
            var bottom = top + $(window).height();
            if (bottom === $('#encyclopedia').offset().top + $('#encyclopedia').innerHeight()) {
                return lastAnchor;
            } else {
                bottom -= 154;
                for (var i = 0; i < contentAnchors.length; i++) {
                    var contentAnchor = contentAnchors[i];
                    if (contentAnchor.top <= bottom &&
                        contentAnchor.bottom > top) {
                        return contentAnchor;
                    }
                }
            }
            return firstAnchor;
        }

        function updateActiveToc(init) {
            updatePositions();
            var newActiveAnchor = findActiveContentToc();
            if (!activeAnchor || newActiveAnchor.href !== activeAnchor.href) {
                activeAnchor = newActiveAnchor;
                markdownTocs.removeClass('active');
                activeAnchor.toc.addClass('active');
                var tocTop = $('#table-of-contents').scrollTop() + 100;
                var tocBottom = tocTop + $('#table-of-contents').innerHeight() - 200;
                var activeTocTop = activeAnchor.toc.position().top;
                var activeTocBottom = activeTocTop + activeAnchor.toc.children(':first').height();
                if (tocTop > activeTocTop) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop -= 100;
                } else if (tocBottom < activeTocBottom) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop += init ? -100 : 100;
                }
            }
        }
        $( document ).ready(function() {
            var tocs = $('#content > ul#markdown-toc');
            var tableOfContents = $('#table-of-contents');
            tableOfContents.append(tocs);
            markdownTocs = $('#table-of-contents ul#markdown-toc li').filter(function() {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                if (!href.startsWith('#')) {
                    return false;
                } else {
                    var contentAnchor = $('div#content ' + href);
                    return contentAnchor.length > 0;
                }
            });
            updateActiveToc(true);
        });

        $(document).on("scroll", function() {
            updateActiveToc(false);
        });

    });
</script>

</body>
</html>

