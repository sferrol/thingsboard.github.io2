







<!Doctype html>
<html id="docs" class="Installation">







<head>
    <meta charset="utf-8">
    <meta name="cf-2fa-verify" content="a08672380de15e9">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Installing ThingsBoard CE on CentOS/RHEL | ThingsBoard Community Edition</title>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Installing ThingsBoard CE on CentOS/RHEL" />
<meta name="author" content="thingsboard" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Installing ThingsBoard CE on CentOS/RHEL" />
<meta property="og:description" content="Installing ThingsBoard CE on CentOS/RHEL" />
<link rel="canonical" href="http://0.0.0.0:4002/docs/user-guide/install/rhel/" />
<meta property="og:url" content="http://0.0.0.0:4002/docs/user-guide/install/rhel/" />
<meta property="og:site_name" content="ThingsBoard" />
<meta property="og:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta property="twitter:title" content="Installing ThingsBoard CE on CentOS/RHEL" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4002/docs/user-guide/install/rhel/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4002/images/thingsboard_logo.png"},"name":"thingsboard"},"author":{"@type":"Person","name":"thingsboard"},"image":{"twitter":"/images/thingsboard_logo.png","facebook":"/images/thingsboard_logo.png","url":"http://0.0.0.0:4002/images/thingsboard_logo.png","@type":"imageObject"},"description":"Installing ThingsBoard CE on CentOS/RHEL","@type":"WebPage","headline":"Installing ThingsBoard CE on CentOS/RHEL","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
    
    <meta name="twitter:description" content="Installing ThingsBoard CE on CentOS/RHEL"/>
    
    
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.7.0/qs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gifffer/1.5.0/gifffer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <script type="text/javascript">
        window.onload = function() {
            Gifffer();
        }
    </script>
    <script type="text/javascript">
        /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
        !function (a) {
            "use strict";
            var b = function (b, c, d) {
                function e(a) {
                    return h.body ? a() : void setTimeout(function () {
                        e(a)
                    })
                }

                function f() {
                    i.addEventListener && i.removeEventListener("load", f), i.media = d || "all"
                }

                var g, h = a.document, i = h.createElement("link");
                if (c) g = c; else {
                    var j = (h.body || h.getElementsByTagName("head")[0]).childNodes;
                    g = j[j.length - 1]
                }
                var k = h.styleSheets;
                i.rel = "stylesheet", i.href = b, i.media = "only x", e(function () {
                    g.parentNode.insertBefore(i, c ? g : g.nextSibling)
                });
                var l = function (a) {
                    for (var b = i.href, c = k.length; c--;) if (k[c].href === b) return a();
                    setTimeout(function () {
                        l(a)
                    })
                };
                return i.addEventListener && i.addEventListener("load", f), i.onloadcssdefined = l, l(f), i
            };
            "undefined" != typeof exports ? exports.loadCSS = b : a.loadCSS = b
        }("undefined" != typeof global ? global : this);

        /*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
        function onloadCSS(a, b) {
            function c() {
                !d && b && (d = !0, b.call(a))
            }

            var d;
            a.addEventListener && a.addEventListener("load", c), a.attachEvent && a.attachEvent("onload", c), "isApplicationInstalled" in navigator && "onloadcssdefined" in a && a.onloadcssdefined(c)
        }
    </script>
    <script type="text/javascript">

        function jqueryDefer(method) {
            if (window.jQuery) {
                method();
            } else {
                setTimeout(function () {
                    jqueryDefer(method)
                }, 50);
            }
        }

        function jqueryUiDefer(method) {
            if (window.jQuery && window.jQuery.ui) {
                method();
            } else {
                setTimeout(function () {
                    jqueryUiDefer(method)
                }, 50);
            }
        }

        window.vis = (function () {
            var stateKey,
                eventKey,
                keys = {
                    hidden: "visibilitychange",
                    webkitHidden: "webkitvisibilitychange",
                    mozHidden: "mozvisibilitychange",
                    msHidden: "msvisibilitychange"
                };
            for (stateKey in keys) {
                if (stateKey in document) {
                    eventKey = keys[stateKey];
                    break;
                }
            }
            return function (c) {
                if (c) document.addEventListener(eventKey, c);
                return !document[stateKey];
            }
        })();

        function loadScript(src, callback) {
            var s, r, t;
            r = false;
            s = document.createElement('script');
            s.type = 'text/javascript';
            s.src = src;
            s.onload = s.onreadystatechange = function () {
                if (!r && (!this.readyState || this.readyState == 'complete')) {
                    r = true;
                    if (callback) {
                        callback();
                    }
                }
            };
            t = document.getElementsByTagName('script')[0];
            t.parentNode.insertBefore(s, t);
        }

        function loadCssAsync(src, callback) {
            var stylesheet = loadCSS(src);
            if (callback) {
                onloadCSS(stylesheet, callback);
            }
        }

        function loadNextScript(index, scriptsList, completeCallback) {
            if (index < scriptsList.length) {
                var script = scriptsList[index];
                if (script.type === 'script') {
                    loadScript(script.src, function () {
                        if (script.callback) {
                            script.callback();
                        }
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                } else if (script.type === 'css') {
                    loadCssAsync(script.src, function () {
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                }
            } else if (completeCallback) {
                completeCallback();
            }
        }

        var initialScriptsList = [
            {src: '/js/jquery-2.2.0.min.js', type: 'script'},
            {src: '/css/jquery-ui.min.css', type: 'css'},
            {src: '/js/jquery-ui.min.js', type: 'script'},
            {src: '/js/jquery.vide.js', type: 'script'},
            {src: '/js/script.js', type: 'script'},
            {src: '/css/photoswipe.css', type: 'css'},
            {src: '/css/default-skin/default-skin.css', type: 'css'},
            {src: '/js/photoswipe.min.js', type: 'script'},
            {src: '/js/photoswipe-ui-default.min.js', type: 'script'}
        ];

        loadNextScript(0, initialScriptsList);

        jqueryDefer(function () {
            (function ($, win) {
                $.fn.inViewport = function (cb) {
                    return this.each(function (i, el) {
                        function visPx() {
                            var H = $(this).height(),
                                r = el.getBoundingClientRect(), t = r.top, b = r.bottom;
                            var result = cb.call(el, Math.max(0, t > 0 ? H - t : (b < H ? b : H)));
                            if (result) {
                                $(win).off("resize scroll", visPx);
                            }
                        }

                        visPx();
                        $(win).on("resize scroll", visPx);
                    });
                };
            }(jQuery, window));
        });

        function inViewportDefer(method) {
            if (window.jQuery && $.fn.inViewport) {
                method();
            } else {
                setTimeout(function () {
                    inViewportDefer(method)
                }, 50);
            }
        }

    </script>
    <script type="text/javascript">
        function _gaLt(event) {
            /* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
            if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
                return;
            }
            var el = event.srcElement || event.target;

            while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
                el = el.parentNode;
            }
            if (el && el.href) {
                var link = el.href;
                if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
                    var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
                        target = "_blank";
                    }

                    var hbrun = false; // tracker has not yet run
                    var hitBack = function () {
                        if (hbrun) return;
                        hbrun = true;
                        window.location.href = link;
                    };

                    if (target) {
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search
                        );
                    } else {
                        event.preventDefault ? event.preventDefault() : event.returnValue = !1;
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search, {
                                "hitCallback": hitBack
                            }
                        );

                        setTimeout(hitBack, 1000);
                    }
                }
            }
        }

        var _w = window;
        var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
        _w.addEventListener ? _w.addEventListener("load", function () {
                document.body.addEventListener(_gaLtEvt, _gaLt, !1)
            }, !1)
            : _w.attachEvent && _w.attachEvent("onload", function () {
            document.body.attachEvent("on" + _gaLtEvt, _gaLt)
        });
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-88383331-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script>
        function Burger() {
            var header = $('header');
            var body = $('body');
            if (header.hasClass('opened-burger')) {
                header.removeClass('opened-burger');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                body.css('overflow', '');
            } else {
                header.addClass('opened-burger');
                body.css('overflow', 'hidden');
            }
        }
    </script>
    <script>

        jqueryDefer(function () {
            let menuElement = $('nav.head-menu > ul');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            let menuItems = $('nav.head-menu > ul > li');
            let indicator = $('nav.head-menu > ul > div.indicator');
            let subMenuActive = false;
            menuElement.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('div.sub-menu-container').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            submenuContainer.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('nav.head-menu > ul').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            menuItems.each(function() {
                let item = $( this );
                let subMenuId = item.attr('data-submenu-id');
                item.on('mouseenter', function () {
                    let submenus = $('nav.head-menu > div.sub-menu-container > div');
                    submenus.css('display', 'none');
                    menuItems.removeClass('active');
                    item.addClass('active');
                    let targetSubMenu = $('nav.head-menu > div.sub-menu-container > div#'+subMenuId);
                    targetSubMenu.css('display', 'block');
                    submenuContainer.css('overflow', 'visible');
                    let left = item.position().left + (item.outerWidth() - targetSubMenu.outerWidth()) / 2;
                    submenuContainer.css('left', left + 'px');
                    if (!subMenuActive) {
                        submenuContainer.addClass('active');
                        subMenuActive = true;
                    } else {
                        submenuContainer.addClass('bounds-transition');
                        indicator.addClass('left-transition');
                    }
                    indicator.css('left', item.position().left);
                    indicator.css('width', item.outerWidth());
                    submenuContainer.css('height', targetSubMenu.outerHeight() + 'px');
                    submenuContainer.css('width', targetSubMenu.outerWidth() + 'px');
                    submenuContainer.css('overflow', 'hidden');
                });
            });

            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                initMobileSubmenu();
            }

            $(window).resize(function(){
                let newIsMobile = $('button.burger').css('display') === 'block';
                if (isMobile !== newIsMobile) {
                    isMobile = newIsMobile;
                    if (isMobile) {
                        initMobileSubmenu();
                    } else {
                        restoreDesktopSubmenu();
                    }
                }
            });

            // Products selector

            
            let productsSelector = $('.products-selector');
            $(window).click(function(e) {
                if (productsSelector[0].contains(e.target)) {
                    if (productsSelector.hasClass('active')) {
                        productsSelector.removeClass('active');
                    } else {
                        productsSelector.addClass('active');
                    }
                } else {
                    productsSelector.removeClass('active');
                }
            });
            

            // Rogue line numbers fix (don't show line numbers for 1 row)
            $( document ).ready(function() {
                $('.rouge-gutter.gl').each(function() {
                    var lineNumbers = $(this).children('.lineno');
                    if (lineNumbers.text() === '1\n') {
                        $(this).css('display', 'none');
                    }
                });
            });
        });

        function initMobileSubmenu() {

            var header = $('header');
            if (header.hasClass('opened-burger')) {
                var body = $('body');
                body.css('overflow', 'hidden');
            }

            let targetSubMenus = $('nav.head-menu > div.sub-menu-container > div');
            targetSubMenus.css('display', 'block');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'none');

            targetSubMenus.each(function() {
                let subMenu = $( this );
                let subMenuId = subMenu.attr('id');
                let parent = $('nav.head-menu > ul > li.'+subMenuId);
                parent.append(subMenu);
            });
        }

        function restoreDesktopSubmenu() {
            var body = $('body');
            body.css('overflow', '');
            let targetSubMenus = $('nav.head-menu > ul > li > div');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'block');
            let menuItems = $('nav.head-menu > ul > li');
            menuItems.removeClass('active');
            targetSubMenus.each(function() {
                let subMenu = $( this );
                submenuContainer.append(subMenu);
            });
        }

        function listburg(subMenuId) {
            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                let targetSubMenu = $('nav.head-menu > ul > li > div.centered-sub#'+subMenuId+' > ul.sub-menu');
                let isOpen = targetSubMenu.hasClass('open-sub');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                if (!isOpen) {
                    targetSubMenu.addClass('open-sub');
                }
            }
        }
    </script>
</head>
<body>

<div class="products-selector">
    <img src="/images/thingsboard-cm-icon.svg"/>
    <div class="product-info">
        <div class="product-title">
            Community Edition
        </div>
        <div class="product-description">
            ThingsBoard Documentation
        </div>
    </div>
    <div class="products">
        
        

    
        
        


        
    


        <a href="/docs/paas/" class="product">Cloud</a>
        
        

    
        
        


        
    


        <a href="/docs/pe/" class="product">Professional Edition</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/user-guide/install/rhel/" class="product active">Community Edition</a>
        
        

    


        <a href="/docs/edge/" class="product">Edge</a>
        
        

    


        <a href="/docs/iot-gateway/" class="product">IoT Gateway</a>
        
        

    


        <a href="/products/license-server/" class="product">License Server</a>
        
        

    


        <a href="/docs/trendz/" class="product">Trendz Analytics</a>
        
    </div>
</div>

<header>
    <div class="logo-burger">
        
        <button onclick="Burger()" class="burger"></button>
        <div id="githubButtonContainer">
            <a class="github-button" href="https://github.com/thingsboard/thingsboard" data-show-count="true"
               aria-label="Star thingsboard/thingsboard on GitHub">Star</a>
        </div>
    </div>
    <nav class="head-menu">
        <ul>
            <li class="nav-products" data-submenu-id="nav-products">
                <a onclick="listburg('nav-products')">Products</a>
            </li>
            <li class="nav-services" data-submenu-id="nav-services">
                <a onclick="listburg('nav-services')">Services</a>
            </li>
            
            <li class="nav-cases" data-submenu-id="nav-cases">
                <a onclick="listburg('nav-cases')">Use Cases</a>
            </li>
            <li class="nav-customers" data-submenu-id="nav-customers">
                <a onclick="listburg('nav-customers')">Customers</a>
            </li>
            <li class="nav-company" data-submenu-id="nav-company">
                <a onclick="listburg('nav-company')">Company</a>
            </li>
            <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
        </ul>
        <div class="sub-menu-container">
            <div id="nav-products" class="centered-sub">
                <ul class="sub-menu products">
                    <div class="sub-groups">
                        <div class="group">
                            <p class="group-name">IoT platforms</p>
                            <a class="cloud-lnk" href="/products/paas/">
                                <img src="/images/thingsboard-c-icon.svg">
                                <div class="sub-text">
                                    <h1>Cloud</h1>
                                    <p>Platform as a service</p>
                                </div>
                            </a>
                            <a class="prof-lnk" href="/products/thingsboard-pe/">
                                <img src="/images/thingsboard-p-icon.svg">
                                <div class="sub-text">
                                    <h1>Professional Edition</h1>
                                    <p>Advanced IoT platform</p>
                                </div>
                            </a>
                            <a class="com-lnk" href="/">
                                <img src="/images/thingsboard-cm-icon.svg">
                                <div class="sub-text">
                                    <h1>Community Edition</h1>
                                    <p>Open source platform</p>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <p class="group-name">Product ecosystem</p>
                            <a class="edge-lnk" href="/products/thingsboard-edge/">
                                <img src="/images/thingsboard-e-icon.svg">
                                <div class="sub-text">
                                    <h1>Edge</h1>
                                    <p>Edge computing</p>
                                </div>
                            </a>
                            <a class="gateway-lnk" href="/docs/iot-gateway/what-is-iot-gateway/">
                                <img src="/images/gateway-icon.svg">
                                <div class="sub-text">
                                    <h1>IoT Gateway</h1>
                                    <p>Connect legacy protocols</p>
                                </div>
                            </a>
                            <a class="license-lnk" href="/products/license-server/">
                                <img src="/images/license-icon.svg">
                                <div class="sub-text">
                                    <h1>License Server</h1>
                                    <p>Billing solution</p>
                                </div>
                            </a>
                            <a class="trendz-lnk" href="/products/trendz/">
                                <img src="/images/trendz-icon.svg">
                                <div class="sub-text">
                                    <h1>Trendz Analytics</h1>
                                    <p>Data analytics and Prediction</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-services" class="centered-sub">
                <ul class="sub-menu services">
                    <a href="/docs/services/support/">
                        <img src="/images/support-icon.svg">
                        <div class="sub-text">
                            <h1>Support</h1>
                            <p>Support packages</p>
                        </div>
                    </a>
                    <a href="/docs/services/trainings/">
                        <img src="/images/train-icon.svg">
                        <div class="sub-text">
                            <h1>Trainings</h1>
                            <p>ThingsBoard education courses</p>
                        </div>
                    </a>
                    <a href="/docs/services/consulting/">
                        <img src="/images/prof-icon.svg">
                        <div class="sub-text">
                            <h1>Professional services</h1>
                            <p>Development of solutions by the ThingsBoard team</p>
                        </div>
                    </a>
                </ul>
            </div>
            
            <div id="nav-cases" class="centered-sub">
                <ul class="sub-menu cases">
                    <a href="/smart-metering/">
                        <img src="/images/case-met-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Metering</h1>
                            <p>Collection, analysis and visualization of data from meters</p>
                        </div>
                    </a>
                    <a href="/smart-energy/">
                        <img src="/images/case-eng-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Energy</h1>
                            <p>Energy monitoring and efficiency analysis</p>
                        </div>
                    </a>
                    <a href="/smart-farming/">
                        <img src="/images/case-fam-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Farming</h1>
                            <p>Monitoring of indoor conditions and plant growth characteristics</p>
                        </div>
                    </a>
                    <a href="/fleet-tracking/">
                        <img src="/images/case-trk-icon.svg">
                        <div class="sub-text">
                            <h1>Fleet Tracking</h1>
                            <p>Fleet tracking and fleet management</p>
                        </div>
                    </a>
                </ul>
            </div>
            <div id="nav-customers" class="centered-sub">
                <ul class="sub-menu customers">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/industries/smart-energy/">
                                <img src="/images/se-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Energy</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/agriculture/">
                                <img src="/images/agr-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Agriculture</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/smart-buildings/">
                                <img src="/images/sb-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Buildings</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/industries/smart-city/">
                                <img src="/images/sc-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart City</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/telecom/">
                                <img src="/images/tel-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Telecom</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/industry40/">
                                <img src="/images/in-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Industry 4.0</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-company" class="centered-sub">
                <ul class="sub-menu about">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/company/">
                                <img src="/images/about-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Our Company</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/docs/contact-us/">
                                <img src="/images/contact-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Contact Us</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/careers/">
                                <img src="/images/careers-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Careers</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/mediakit/">
                                <img src="/images/media-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Media Kit</h1>
                                </div>
                            </a>
                            <a class="small-link" href="https://blog.thingsboard.io/">
                                <img src="/images/blog-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Blog</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="bottom-group">
                        <a class="small-link" href="/partners/hardware/">
                            <img src="/images/hard-s-icon.svg">
                            <div class="sub-text">
                                <h1>Hardware partners</h1>
                            </div>
                        </a>
                        <a class="small-link" href="/partners/distributors/">
                            <img src="/images/dis-s-icon.svg">
                            <div class="sub-text">
                                <h1>Distributors</h1>
                            </div>
                        </a>
                    </div>
                </ul>
            </div>
        </div>
    </nav>
    <div>
        <a href="/installations/" class="n-button try">Try it now</a>
        <a href="/pricing/" class="n-button price">Pricing</a>
    </div>
</header>


<div id="searchBox">
    <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    <button class="searchButton"></button>
</div>

<!--  HERO  -->
<section id="hero">
  <div id="hero-content">
    <div id="vendorStrip">
      <div id="docsList">
          <ul>
            
              
              
              
              <li>
                  <a href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/" >Documentation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/guides/" >Guides</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/user-guide/install/installation-options/" class="YAH">Installation</a>
                  
                     <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/reference/" >Architecture</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/api/" >API</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/faq/" >FAQ</a>
                  
              </li>
            
          </ul>
          <div id="docsBreadcrumbs">
              
                  
                  
                  
                  
                      
                  
                      
                         
                         
                         
    

    
        
        
        

                         
                            
                  
                    <span class="item">Installation</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">On premise</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">CentOS/RHEL Server</span>
                    
                  
              
          </div>
      </div>
    </div>
  </div>
</section>
<div id="docsNav">
    <div class="docItems">
        
            
            
                <a class="toc" href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
            
        
            
            
                <a class="toc" href="/docs/" >Documentation</a>
            
        
            
            
                <a class="toc" href="/docs/guides/" >Guides</a>
            
        
            
            
                <div class="pi-accordion">
                    


<a class="item" data-title="Installation options" href="/docs/user-guide/install/installation-options/"></a>


<div class="item" data-title="On premise">
  <div class="container">


<a class="item" data-title="Ubuntu Server" href="/docs/user-guide/install/ubuntu/"></a>


<a class="item" data-title="CentOS/RHEL Server" href="/docs/user-guide/install/rhel/"></a>


<a class="item" data-title="Windows" href="/docs/user-guide/install/windows/"></a>


<a class="item" data-title="Raspberry Pi 3" href="/docs/user-guide/install/rpi/"></a>


<a class="item" data-title="Docker (Windows)" href="/docs/user-guide/install/docker-windows/"></a>


<a class="item" data-title="Docker (Linux or Mac OS)" href="/docs/user-guide/install/docker/"></a>


<a class="item" data-title="Building from sources" href="/docs/user-guide/install/building-from-source/"></a>


<a class="item" data-title="Cluster setup" href="/docs/user-guide/install/cluster-setup/"></a>
  </div>
</div>


<div class="item" data-title="Cloud">
  <div class="container">


<a class="item" data-title="AWS" href="/docs/user-guide/install/aws/"></a>


<a class="item" data-title="DigitalOcean" href="/docs/user-guide/install/digital-ocean/"></a>


<a class="item" data-title="Google Cloud Platform" href="/docs/user-guide/install/gcp/"></a>


<a class="item" data-title="Azure" href="/docs/user-guide/install/azure/"></a>
  </div>
</div>


<a class="item" data-title="Upgrade instructions" href="/docs/user-guide/install/upgrade-instructions/"></a>


<a class="item" data-title="Configuration" href="/docs/user-guide/install/config/"></a>
                </div>
            
        
            
            
                <a class="toc" href="/docs/reference/" >Architecture</a>
            
        
            
            
                <a class="toc" href="/docs/api/" >API</a>
            
        
            
            
                <a class="toc" href="/docs/faq/" >FAQ</a>
            
        
    </div>
</div>








<section id="encyclopedia">
  
  <div id="docsToc">
        <div class="pi-accordion">
        


<a class="item" data-title="Installation options" href="/docs/user-guide/install/installation-options/"></a>


<div class="item" data-title="On premise">
  <div class="container">


<a class="item" data-title="Ubuntu Server" href="/docs/user-guide/install/ubuntu/"></a>


<a class="item" data-title="CentOS/RHEL Server" href="/docs/user-guide/install/rhel/"></a>


<a class="item" data-title="Windows" href="/docs/user-guide/install/windows/"></a>


<a class="item" data-title="Raspberry Pi 3" href="/docs/user-guide/install/rpi/"></a>


<a class="item" data-title="Docker (Windows)" href="/docs/user-guide/install/docker-windows/"></a>


<a class="item" data-title="Docker (Linux or Mac OS)" href="/docs/user-guide/install/docker/"></a>


<a class="item" data-title="Building from sources" href="/docs/user-guide/install/building-from-source/"></a>


<a class="item" data-title="Cluster setup" href="/docs/user-guide/install/cluster-setup/"></a>
  </div>
</div>


<div class="item" data-title="Cloud">
  <div class="container">


<a class="item" data-title="AWS" href="/docs/user-guide/install/aws/"></a>


<a class="item" data-title="DigitalOcean" href="/docs/user-guide/install/digital-ocean/"></a>


<a class="item" data-title="Google Cloud Platform" href="/docs/user-guide/install/gcp/"></a>


<a class="item" data-title="Azure" href="/docs/user-guide/install/azure/"></a>
  </div>
</div>


<a class="item" data-title="Upgrade instructions" href="/docs/user-guide/install/upgrade-instructions/"></a>


<a class="item" data-title="Configuration" href="/docs/user-guide/install/config/"></a>
        </div> <!-- /pi-accordion -->
  </div> <!-- /docsToc -->
  
  <div id="docsContent" class=" hasTocContent">
      <div id="table-of-contents">
          
              <h4>On this page</h4>
          
      </div>
      <div id="top-spacer"></div>
      <h1>Installing ThingsBoard CE on CentOS/RHEL</h1>
      <div id="content">
          <ul id="markdown-toc">
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#step-1-install-java-11-openjdk" id="markdown-toc-step-1-install-java-11-openjdk">Step 1. Install Java 11 (OpenJDK)</a></li>
  <li><a href="#step-2-thingsboard-service-installation" id="markdown-toc-step-2-thingsboard-service-installation">Step 2. ThingsBoard service installation</a></li>
  <li><a href="#step-3-configure-thingsboard-database" id="markdown-toc-step-3-configure-thingsboard-database">Step 3. Configure ThingsBoard database</a></li>
  <li><a href="#step-4-choose-thingsboard-queue-service" id="markdown-toc-step-4-choose-thingsboard-queue-service">Step 4. Choose ThingsBoard queue service</a></li>
  <li><a href="#step-5-optional-memory-update-for-slow-machines-1gb-of-ram" id="markdown-toc-step-5-optional-memory-update-for-slow-machines-1gb-of-ram">Step 5. [Optional] Memory update for slow machines (1GB of RAM)</a></li>
  <li><a href="#step-6-run-installation-script" id="markdown-toc-step-6-run-installation-script">Step 6. Run installation script</a></li>
  <li><a href="#step-7-start-thingsboard-service" id="markdown-toc-step-7-start-thingsboard-service">Step 7. Start ThingsBoard service</a></li>
  <li><a href="#post-installation-steps" id="markdown-toc-post-installation-steps">Post-installation steps</a></li>
  <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a></li>
  <li><a href="#next-steps" id="markdown-toc-next-steps">Next steps</a></li>
</ul>

<h3 id="prerequisites">Prerequisites</h3>

<p>This guide describes how to install ThingsBoard on RHEL/CentOS 7/8. 
Hardware requirements depend on chosen database and amount of devices connected to the system. 
To run ThingsBoard and PostgreSQL on a single machine you will need at least 1Gb of RAM.
To run ThingsBoard and Cassandra on a single machine you will need at least 8Gb of RAM.</p>

<p>Before continue to installation execute the following commands in order to install necessary tools:</p>

<p><strong>For CentOS 7:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># Install wget</span>
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> nano wget
<span class="c"># Add latest EPEL release for CentOS 7</span>
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm

</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 8:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># Install wget</span>
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> nano wget
<span class="c"># Add latest EPEL release for CentOS 8</span>
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="step-1-install-java-11-openjdk">Step 1. Install Java 11 (OpenJDK)</h3>

<p>ThingsBoard service is running on Java 11. Follow this instructions to install OpenJDK 11:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>yum <span class="nb">install </span>java-11-openjdk
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Please donâ€™t forget to configure your operating system to use OpenJDK 11 by default. 
You can configure which version is the default using the following command:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>update-alternatives <span class="nt">--config</span> java
</pre></td></tr></tbody></table></code></pre></div></div>

<p>You can check the installation using the following command:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>java <span class="nt">-version</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Expected command output is:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>openjdk version "11.0.xx"
OpenJDK Runtime Environment (...)
OpenJDK 64-Bit Server VM (build ...)
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="step-2-thingsboard-service-installation">Step 2. ThingsBoard service installation</h3>

<p>Download installation package.</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>wget https://github.com/thingsboard/thingsboard/releases/download/v3.3.1/thingsboard-3.3.1.rpm
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Install ThingsBoard as a service</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>rpm <span class="nt">-Uvh</span> thingsboard-3.3.1.rpm
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="step-3-configure-thingsboard-database">Step 3. Configure ThingsBoard database</h3>

<p>ThingsBoard is able to use SQL or hybrid database approach. See corresponding architecture <a href="/docs/reference/#sql-vs-nosql-vs-hybrid-database-approach">page</a> for more details.</p>

<div class="tb-content-toggle" id="rhelThingsboardDatabase">
  <div class="panel panel-default">
    <div class="panel-heading">
<a class="content-toggle-button" data-target="#postgresql">
                <div class="content-toggle-button-text">
                    PostgreSQL <small>(recommended for &lt; 5K msg/sec)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#hybrid">
                <div class="content-toggle-button-text">
                    Hybrid <br />PostgreSQL+Cassandra<br /><small>(recommended for &gt; 5K msg/sec)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#timescale">
                <div class="content-toggle-button-text">
                    Hybrid <br />PostgreSQL+TimescaleDB<br /><small>(for TimescaleDB professionals)</small>
                </div>
            </a>
    </div>
    <div id="postgresql" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<div class="info-banner">
<img src="/images/doc-info-icon.svg" />   <div>
    <p>ThingsBoard team recommends to use PostgreSQL for development and production environments with reasonable load (&lt; 5000 msg/sec). Many cloud vendors support managed PostgreSQL servers which is a cost-effective solution for most of ThingsBoard instances.</p>
  </div>
</div>

<h5 class="no_toc" id="postgresql-installation">PostgreSQL Installation</h5>

<p>Instructions listed below will help you to install PostgreSQL.</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Update your system</span>
<span class="nb">sudo </span>yum update
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 7:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 7):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>epel-release yum-utils
<span class="nb">sudo </span>yum-config-manager <span class="nt">--enable</span> pgdg12
<span class="nb">sudo </span>yum <span class="nb">install </span>postgresql12-server postgresql12
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 8:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 8):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>dnf <span class="nt">-qy</span> module disable postgresql
<span class="nb">sudo </span>dnf <span class="nt">-y</span> <span class="nb">install </span>postgresql12 postgresql12-server
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Once PostgreSQL is installed you may want to create a new user or set the password for the the main user. 
The instructions below will help to set the password for main postgresql user</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>sudo su - postgres
psql
\password
\q
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then, press â€œCtrl+Dâ€ to return to main user console.</p>

<p>After configuring the password, edit the pg_hba.conf to use MD5 authentication with the postgres user.</p>

<p>Edit pg_hba.conf file:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /var/lib/pgsql/12/data/pg_hba.conf

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Locate the following lines:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre># IPv4 local connections:
host    all             all             127.0.0.1/32            ident
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Replace <code class="language-plaintext highlighter-rouge">ident</code> with <code class="language-plaintext highlighter-rouge">md5</code>:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>host    all             all             127.0.0.1/32            md5
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Finally, you should restart the PostgreSQL service to initialize the new configuration:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart postgresql-12.service

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Connect to the database to create thingsboard DB:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>psql <span class="nt">-U</span> postgres <span class="nt">-d</span> postgres <span class="nt">-h</span> 127.0.0.1 <span class="nt">-W</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Execute create database statement</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>CREATE DATABASE thingsboard<span class="p">;</span>
<span class="se">\q</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget <strong>to replace</strong> â€œPUT_YOUR_POSTGRESQL_PASSWORD_HEREâ€ with your <strong>real postgres user password</strong>:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># DB Configuration </span>
<span class="nb">export </span><span class="nv">DATABASE_ENTITIES_TYPE</span><span class="o">=</span>sql
<span class="nb">export </span><span class="nv">DATABASE_TS_TYPE</span><span class="o">=</span>sql
<span class="nb">export </span><span class="nv">SPRING_JPA_DATABASE_PLATFORM</span><span class="o">=</span>org.hibernate.dialect.PostgreSQLDialect
<span class="nb">export </span><span class="nv">SPRING_DRIVER_CLASS_NAME</span><span class="o">=</span>org.postgresql.Driver
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_URL</span><span class="o">=</span>jdbc:postgresql://localhost:5432/thingsboard
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_USERNAME</span><span class="o">=</span>postgres
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_PASSWORD</span><span class="o">=</span>PUT_YOUR_POSTGRESQL_PASSWORD_HERE
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_MAXIMUM_POOL_SIZE</span><span class="o">=</span>5
<span class="c"># Specify partitioning size for timestamp key-value storage. Allowed values: DAYS, MONTHS, YEARS, INDEFINITE.</span>
<span class="nb">export </span><span class="nv">SQL_POSTGRES_TS_KV_PARTITIONING</span><span class="o">=</span>MONTHS
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="hybrid" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<div class="info-banner">
<img src="/images/doc-info-icon.svg" />   <div>
    <p>ThingsBoard team recommends to use Hybrid database approach if you do plan to have 1M+ devices in production or high data ingestion rate (&gt; 5000 msg/sec). In this case, ThingsBoard will be storing timeseries data in Cassandra while continue to use PostgreSQL for main entities (devices/assets/dashboards/customers).</p>
  </div>
</div>

<h5 class="no_toc" id="postgresql-installation">PostgreSQL Installation</h5>

<p>Instructions listed below will help you to install PostgreSQL.</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Update your system</span>
<span class="nb">sudo </span>yum update
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 7:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 7):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>epel-release yum-utils
<span class="nb">sudo </span>yum-config-manager <span class="nt">--enable</span> pgdg12
<span class="nb">sudo </span>yum <span class="nb">install </span>postgresql12-server postgresql12
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 8:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 8):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>dnf <span class="nt">-qy</span> module disable postgresql
<span class="nb">sudo </span>dnf <span class="nt">-y</span> <span class="nb">install </span>postgresql12 postgresql12-server
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Once PostgreSQL is installed you may want to create a new user or set the password for the the main user. 
The instructions below will help to set the password for main postgresql user</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>sudo su - postgres
psql
\password
\q
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then, press â€œCtrl+Dâ€ to return to main user console.</p>

<p>After configuring the password, edit the pg_hba.conf to use MD5 authentication with the postgres user.</p>

<p>Edit pg_hba.conf file:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /var/lib/pgsql/12/data/pg_hba.conf

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Locate the following lines:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre># IPv4 local connections:
host    all             all             127.0.0.1/32            ident
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Replace <code class="language-plaintext highlighter-rouge">ident</code> with <code class="language-plaintext highlighter-rouge">md5</code>:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>host    all             all             127.0.0.1/32            md5
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Finally, you should restart the PostgreSQL service to initialize the new configuration:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart postgresql-12.service

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Connect to the database to create thingsboard DB:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>psql <span class="nt">-U</span> postgres <span class="nt">-d</span> postgres <span class="nt">-h</span> 127.0.0.1 <span class="nt">-W</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Execute create database statement</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>CREATE DATABASE thingsboard<span class="p">;</span>
<span class="se">\q</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h5 class="no_toc" id="cassandra-installation">Cassandra Installation</h5>

<p>Instructions listed below will help you to install Cassandra.</p>

<div class="info-banner">
<img src="/images/doc-info-icon.svg" />   <div>
    <p>Please note that Cassandra 4.x is still in beta. ThingsBoard is compatible with Cassandra 3.x as well. However, since ThingsBoard 3.2.2+ requires Java 11 and Cassandra 3.x is <a href="https://cassandra.apache.org/doc/latest/new/java11.html">not compatible</a> with Java 8, you <strong>canâ€™t launch ThingsBoard 3.2.2+ and Cassandra 3.x on the same machine without separate docker containers for both.</strong>.</p>
    <p>Please consider using <a href="/docs/user-guide/install/cluster/docker-compose-setup/">docker compose</a> or other <a href="/docs/user-guide/install/cluster-setup/">cluster setup</a> to avoid issues with beta version of Cassandra.</p>
  </div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c"># Add cassandra repository</span>
<span class="nb">sudo touch</span> /etc/yum.repos.d/cassandra.repo
<span class="nb">echo</span> <span class="s1">'[cassandra]'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null
<span class="nb">echo</span> <span class="s1">'name=Apache Cassandra'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null
<span class="nb">echo</span> <span class="s1">'baseurl=https://downloads.apache.org/cassandra/redhat/40x/'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null
<span class="nb">echo</span> <span class="s1">'gpgcheck=1'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null
<span class="nb">echo</span> <span class="s1">'repo_gpgcheck=1'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null
<span class="nb">echo</span> <span class="s1">'gpgkey=https://downloads.apache.org/cassandra/KEYS'</span> | <span class="nb">sudo tee</span> <span class="nt">--append</span> /etc/yum.repos.d/cassandra.repo <span class="o">&gt;</span> /dev/null

<span class="c"># Cassandra installation</span>
<span class="nb">sudo </span>yum <span class="nb">install </span>cassandra
<span class="c"># Tools installation</span>
<span class="nb">sudo </span>yum <span class="nb">install </span>cassandra-tools
<span class="c"># Start Cassandra</span>
<span class="nb">sudo </span>service cassandra start
<span class="c"># Configure the database to start automatically when OS starts.</span>
<span class="nb">sudo </span>chkconfig cassandra on
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget <strong>to replace</strong> â€œPUT_YOUR_POSTGRESQL_PASSWORD_HEREâ€ with your <strong>real postgres user password</strong>:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># DB Configuration </span>
<span class="nb">export </span><span class="nv">DATABASE_ENTITIES_TYPE</span><span class="o">=</span>sql
<span class="nb">export </span><span class="nv">DATABASE_TS_TYPE</span><span class="o">=</span>cassandra
<span class="nb">export </span><span class="nv">SPRING_JPA_DATABASE_PLATFORM</span><span class="o">=</span>org.hibernate.dialect.PostgreSQLDialect
<span class="nb">export </span><span class="nv">SPRING_DRIVER_CLASS_NAME</span><span class="o">=</span>org.postgresql.Driver
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_URL</span><span class="o">=</span>jdbc:postgresql://localhost:5432/thingsboard
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_USERNAME</span><span class="o">=</span>postgres
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_PASSWORD</span><span class="o">=</span>PUT_YOUR_POSTGRESQL_PASSWORD_HERE
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_MAXIMUM_POOL_SIZE</span><span class="o">=</span>5
</pre></td></tr></tbody></table></code></pre></div></div>

<p>You can optionally add the following parameters to reconfigure your ThingsBoard instance to connect to external Cassandra nodes:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">CASSANDRA_CLUSTER_NAME</span><span class="o">=</span>Thingsboard Cluster
<span class="nb">export </span><span class="nv">CASSANDRA_KEYSPACE_NAME</span><span class="o">=</span>thingsboard
<span class="nb">export </span><span class="nv">CASSANDRA_URL</span><span class="o">=</span>127.0.0.1:9042
<span class="nb">export </span><span class="nv">CASSANDRA_USE_CREDENTIALS</span><span class="o">=</span><span class="nb">false
export </span><span class="nv">CASSANDRA_USERNAME</span><span class="o">=</span>
<span class="nb">export </span><span class="nv">CASSANDRA_PASSWORD</span><span class="o">=</span>
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="timescale" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<div class="info-banner">
<img src="/images/doc-info-icon.svg" />   <div>
    <p>ThingsBoard team recommends using Timescale database only for companies that already use TimescaleDB in production. In this case, ThingsBoard will be storing timeseries data in TimescaleDB Hypertable while continue to use PostgreSQL for main entities (devices/assets/dashboards/customers).</p>
  </div>
</div>

<h5 class="no_toc" id="postgresql-installation">PostgreSQL Installation</h5>

<p>Instructions listed below will help you to install PostgreSQL.</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Update your system</span>
<span class="nb">sudo </span>yum update
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 7:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 7):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>epel-release yum-utils
<span class="nb">sudo </span>yum-config-manager <span class="nt">--enable</span> pgdg12
<span class="nb">sudo </span>yum <span class="nb">install </span>postgresql12-server postgresql12
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>For CentOS 8:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># Install the repository RPM (for CentOS 8):</span>
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm
<span class="c"># Install packages</span>
<span class="nb">sudo </span>dnf <span class="nt">-qy</span> module disable postgresql
<span class="nb">sudo </span>dnf <span class="nt">-y</span> <span class="nb">install </span>postgresql12 postgresql12-server
<span class="c"># Initialize your PostgreSQL DB</span>
<span class="nb">sudo</span> /usr/pgsql-12/bin/postgresql-12-setup initdb
<span class="nb">sudo </span>systemctl start postgresql-12
<span class="c"># Optional: Configure PostgreSQL to start on boot</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> postgresql-12

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Once PostgreSQL is installed you may want to create a new user or set the password for the the main user. 
The instructions below will help to set the password for main postgresql user</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>sudo su - postgres
psql
\password
\q
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Then, press â€œCtrl+Dâ€ to return to main user console.</p>

<p>After configuring the password, edit the pg_hba.conf to use MD5 authentication with the postgres user.</p>

<p>Edit pg_hba.conf file:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /var/lib/pgsql/12/data/pg_hba.conf

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Locate the following lines:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre># IPv4 local connections:
host    all             all             127.0.0.1/32            ident
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Replace <code class="language-plaintext highlighter-rouge">ident</code> with <code class="language-plaintext highlighter-rouge">md5</code>:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>host    all             all             127.0.0.1/32            md5
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Finally, you should restart the PostgreSQL service to initialize the new configuration:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart postgresql-12.service

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Connect to the database to create thingsboard DB:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>psql <span class="nt">-U</span> postgres <span class="nt">-d</span> postgres <span class="nt">-h</span> 127.0.0.1 <span class="nt">-W</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Execute create database statement</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>CREATE DATABASE thingsboard<span class="p">;</span>
<span class="se">\q</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<h5 class="no_toc" id="timescaledb-installation">TimescaleDB Installation</h5>

<p>Please refer to the official <a href="https://docs.timescale.com/latest/getting-started/installation/rhel-centos/installation-yum">TimescaleDB installation page</a> on RHEL/CentOS distros and follow the instructions in accordance with your installed PostgreSQL version.</p>

<p>After package installation, you need to create TimescaleDB extension in your ThingsBoard database:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>su - postgres
psql <span class="nt">-d</span> thingsboard
CREATE EXTENSION IF NOT EXISTS timescaledb<span class="p">;</span>
<span class="se">\q</span>
<span class="c">#Then, press â€œCtrl+Dâ€ to return to main user console.</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget <strong>to replace</strong> â€œPUT_YOUR_POSTGRESQL_PASSWORD_HEREâ€ with your <strong>real postgres user password</strong>:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># DB Configuration </span>
<span class="nb">export </span><span class="nv">DATABASE_ENTITIES_TYPE</span><span class="o">=</span>sql
<span class="nb">export </span><span class="nv">DATABASE_TS_TYPE</span><span class="o">=</span>timescale
<span class="nb">export </span><span class="nv">SPRING_JPA_DATABASE_PLATFORM</span><span class="o">=</span>org.hibernate.dialect.PostgreSQLDialect
<span class="nb">export </span><span class="nv">SPRING_DRIVER_CLASS_NAME</span><span class="o">=</span>org.postgresql.Driver
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_URL</span><span class="o">=</span>jdbc:postgresql://localhost:5432/thingsboard
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_USERNAME</span><span class="o">=</span>postgres
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_PASSWORD</span><span class="o">=</span>PUT_YOUR_POSTGRESQL_PASSWORD_HERE
<span class="nb">export </span><span class="nv">SPRING_DATASOURCE_MAXIMUM_POOL_SIZE</span><span class="o">=</span>5
<span class="c"># Specify Interval size for data chunks storage. Please note that this value can be set only once.</span>
<span class="nb">export </span><span class="nv">SQL_TIMESCALE_CHUNK_TIME_INTERVAL</span><span class="o">=</span>604800000 <span class="c"># Number of miliseconds. The current value corresponds to one week.</span>
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
  </div>
</div>

<script>
    jqueryUiDefer(initContentTogglerhelThingsboardDatabase);
    function initContentTogglerhelThingsboardDatabase() {
        $(function(){

            window.addEventListener('popstate', onPopStaterhelThingsboardDatabase);

            onPopStaterhelThingsboardDatabase();

            $('.tb-content-toggle#rhelThingsboardDatabase a.content-toggle-button').click(function(event) {
                event.preventDefault();
                var id = $(this).attr("data-target").substring(1);
                var param = 'rhelThingsboardDatabase';
                var params = Qs.parse(window.location.search, { ignoreQueryPrefix: true });
                params[param] = id;

                var newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?' + Qs.stringify(params);
                if (window.location.hash) {
                    newurl += window.location.hash;
                }
                window.history.pushState({ path: newurl }, '', newurl);
                selectTargetrhelThingsboardDatabase(id);
            });
        });
    }

    function onPopStaterhelThingsboardDatabase() {
        var params = Qs.parse(window.location.search, { ignoreQueryPrefix: true });
        var targetId = params['rhelThingsboardDatabase'];
        if (!targetId) {
            targetId = 'postgresql';
        }
        selectTargetrhelThingsboardDatabase(targetId);
    }

    function selectTargetrhelThingsboardDatabase(targetId) {
        $(".tb-content-toggle#rhelThingsboardDatabase a.content-toggle-button").removeClass("active");
        $(".tb-content-toggle#rhelThingsboardDatabase a.content-toggle-button[data-target='#"+targetId+"']").addClass("active");
        $('.tb-content-toggle#rhelThingsboardDatabase .panel-collapse').removeClass("show");
        $('.tb-content-toggle#rhelThingsboardDatabase .panel-collapse#'+targetId).addClass("show");
    }

</script>

<h3 id="step-4-choose-thingsboard-queue-service">Step 4. Choose ThingsBoard queue service</h3>

<p>ThingsBoard is able to use various messaging systems/brokers for storing the messages and communication between ThingsBoard services. How to choose the right queue implementation?</p>

<ul>
  <li>
    <p><strong>In Memory</strong> queue implementation is built-in and default. 
It is useful for development(PoC) environments and is not suitable for production deployments or any sort of cluster deployments.</p>
  </li>
  <li>
    <p><strong>Kafka</strong> is recommended for production deployments. This queue is used on the most of ThingsBoard production environments now. 
It is useful for both on-prem and private cloud deployments. It is also useful if you like to stay independent from your cloud provider.
However, some providers also have managed services for Kafka. See AWS <a href="https://aws.amazon.com/msk/">MSK</a> for example.</p>
  </li>
  <li>
    <p><strong>RabbitMQ</strong> is recommended if you donâ€™t have much load and you already have experience with this messaging system.</p>
  </li>
  <li>
    <p><strong>AWS SQS</strong> is a fully managed message queuing service from AWS. Useful if you plan to deploy ThingsBoard on AWS.</p>
  </li>
  <li>
    <p><strong>Google Pub/Sub</strong> is a fully managed message queuing service from Google. Useful if you plan to deploy ThingsBoard on Google Cloud.</p>
  </li>
  <li>
    <p><strong>Azure Service Bus</strong> is a fully managed message queuing service from Azure. Useful if you plan to deploy ThingsBoard on Azure.</p>
  </li>
  <li>
    <p><strong>Confluent Cloud</strong> is a fully managed streaming platform based on Kafka. Useful for a cloud agnostic deployments.</p>
  </li>
</ul>

<p>See corresponding architecture <a href="/docs/reference/#message-queues-are-awesome">page</a> and rule engine <a href="/docs/user-guide/rule-engine-2-0/overview/#rule-engine-queue">page</a> for more details.</p>

<div class="tb-content-toggle" id="ubuntuThingsboardQueue">
  <div class="panel panel-default">
    <div class="panel-heading">
<a class="content-toggle-button" data-target="#inmemory">
                <div class="content-toggle-button-text">
                    In Memory <small>(built-in and default)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#kafka">
                <div class="content-toggle-button-text">
                    Kafka <small>(recommended for on-prem, production installations)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#aws-sqs">
                <div class="content-toggle-button-text">
                    AWS SQS <small>(managed service from AWS)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#pubsub">
                <div class="content-toggle-button-text">
                    Google Pub/Sub <small>(managed service from Google)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#service-bus">
                <div class="content-toggle-button-text">
                    Azure Service Bus <small>(managed service from Azure)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#rabbitmq">
                <div class="content-toggle-button-text">
                    RabbitMQ <small>(for small on-prem installations)</small>
                </div>
            </a> <a class="content-toggle-button" data-target="#confluent-cloud">
                <div class="content-toggle-button-text">
                    Confluent Cloud <small>(Event Streaming Platform based on Kafka)</small>
                </div>
            </a>
    </div>
    <div id="inmemory" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<p>In Memory queue is built-in and enabled by default. No additional configuration steps required.</p>

</td></tr></table>
      </div>
    </div>
    <div id="kafka" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="kafka-installation">Kafka Installation</h4>

<p><a href="https://kafka.apache.org/">Apache Kafka</a> is an open-source stream-processing software platform.</p>

<h5 class="no_toc" id="install-kafka">Install Kafka</h5>

<p>We recommend to use Kafka in Docker container, use this <a href="https://github.com/wurstmeister/kafka-docker">instruction</a> for installing.</p>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following line to the configuration file. <strong>Donâ€™t forget</strong> to replace â€œlocalhost:9092â€ with your real Kafka bootstrap servers:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>kafka
<span class="nb">export </span><span class="nv">TB_KAFKA_SERVERS</span><span class="o">=</span>localhost:9092
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="aws-sqs" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="aws-sqs-configuration">AWS SQS Configuration</h4>

<p>To access AWS SQS service, you first need to create an <a href="https://aws.amazon.com/sqs/">AWS account</a>.</p>

<p>To work with AWS SQS service you will need to create your next credentials using <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-setting-up.html">this instruction</a>:</p>
<ul>
  <li>Access key ID</li>
  <li>Secret access key</li>
</ul>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget to replace â€œYOUR_KEYâ€, â€œYOUR_SECRETâ€ with your <strong>real AWS SQS IAM user credentials</strong> and â€œYOUR_REGIONâ€ with your <strong>real AWS SQS account region:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>aws-sqs
<span class="nb">export </span><span class="nv">TB_QUEUE_AWS_SQS_ACCESS_KEY_ID</span><span class="o">=</span>YOUR_KEY
<span class="nb">export </span><span class="nv">TB_QUEUE_AWS_SQS_SECRET_ACCESS_KEY</span><span class="o">=</span>YOUR_SECRET
<span class="nb">export </span><span class="nv">TB_QUEUE_AWS_SQS_REGION</span><span class="o">=</span>YOUR_REGION

<span class="c"># These params affect the number of requests per second from each partitions per each queue.</span>
<span class="c"># Number of requests to particular Message Queue is calculated based on the formula:</span>
<span class="c"># ((Number of Rule Engine and Core Queues) * (Number of partitions per Queue) + (Number of transport queues)</span>
<span class="c">#  + (Number of microservices) + (Number of JS executors)) * 1000 / POLL_INTERVAL_MS</span>
<span class="c"># For example, number of requests based on default parameters is:</span>

<span class="c"># Rule Engine queues:</span>
<span class="c"># Main 10 partitions + HighPriority 10 partitions + SequentialByOriginator 10 partitions = 30</span>
<span class="c"># Core queue 10 partitions</span>
<span class="c"># Transport request Queue + response Queue = 2</span>
<span class="c"># Rule Engine Transport notifications Queue + Core Transport notifications Queue = 2</span>
<span class="c"># Total = 44</span>
<span class="c"># Number of requests per second = 44 * 1000 / 25 = 1760 requests</span>

<span class="c"># Based on the use case, you can compromise latency and decrease number of partitions/requests to the queue, if the message load is low.</span>
<span class="c"># Sample parameters to fit into 10 requests per second on a "monolith" deployment: </span>

<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="pubsub" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="google-pubsub-configuration">Google Pub/Sub Configuration</h4>

<p>To access Pub/Sub service, you first need to create an <a href="https://cloud.google.com/">Google cloud account</a>.</p>

<p>To work with Pub/Sub service you will need to create a project using <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">this instruction</a>.</p>

<p>Create service account credentials with the <strong>role â€œEditorâ€ or â€œAdminâ€</strong> using <a href="https://cloud.google.com/pubsub/docs/quickstart-py-mac#create_service_account_credentials">this instruction</a>,
and save json file with your service account credentials step 9 <a href="https://cloud.google.com/pubsub/docs/quickstart-py-mac#create_service_account_credentials">here</a>.</p>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget to replace â€œYOUR_PROJECT_IDâ€, â€œYOUR_SERVICE_ACCOUNTâ€ with your <strong>real Pub/Sub project id, and service account (it is whole data from json file):</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>pubsub
<span class="nb">export </span><span class="nv">TB_QUEUE_PUBSUB_PROJECT_ID</span><span class="o">=</span>YOUR_PROJECT_ID
<span class="nb">export </span><span class="nv">TB_QUEUE_PUBSUB_SERVICE_ACCOUNT</span><span class="o">=</span>YOUR_SERVICE_ACCOUNT

<span class="c"># These params affect the number of requests per second from each partitions per each queue!!!</span>
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">REMOTE_JS_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000

<span class="c"># These params affect the number of requests per second from each partitions per each queue.</span>
<span class="c"># Number of requests to particular Message Queue is calculated based on the formula:</span>
<span class="c"># ((Number of Rule Engine and Core Queues) * (Number of partitions per Queue) + (Number of transport queues)</span>
<span class="c">#  + (Number of microservices) + (Number of JS executors)) * 1000 / POLL_INTERVAL_MS</span>
<span class="c"># For example, number of requests based on default parameters is:</span>

<span class="c"># Rule Engine queues:</span>
<span class="c"># Main 10 partitions + HighPriority 10 partitions + SequentialByOriginator 10 partitions = 30</span>
<span class="c"># Core queue 10 partitions</span>
<span class="c"># Transport request Queue + response Queue = 2</span>
<span class="c"># Rule Engine Transport notifications Queue + Core Transport notifications Queue = 2</span>
<span class="c"># Total = 44</span>
<span class="c"># Number of requests per second = 44 * 1000 / 25 = 1760 requests</span>

<span class="c"># Based on the use case, you can compromise latency and decrease number of partitions/requests to the queue, if the message load is low.</span>
<span class="c"># Sample parameters to fit into 10 requests per second on a "monolith" deployment: </span>

<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="service-bus" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="azure-service-bus-configuration">Azure Service Bus Configuration</h4>

<p>To access Azure Service Bus, you first need to create an <a href="https://azure.microsoft.com/">Azure account</a>.</p>

<p>To work with Service Bus service you will need to create a Service Bus Namespace using <a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-create-namespace-portal">this instruction</a>.</p>

<p>Create Shared Access Signature using <a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-create-namespace-portal#get-the-connection-string">this instruction</a>.</p>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget to replace â€œYOUR_NAMESPACE_NAMEâ€ with your <strong>real Service Bus namespace name</strong>, and â€œYOUR_SAS_KEY_NAMEâ€, â€œYOUR_SAS_KEYâ€ with your <strong>real Service Bus credentials. Note: â€œYOUR_SAS_KEY_NAMEâ€ it is â€œSAS Policyâ€, â€œYOUR_SAS_KEYâ€ it is â€œSAS Policy Primary Keyâ€:</strong></p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>service-bus
<span class="nb">export </span><span class="nv">TB_QUEUE_SERVICE_BUS_NAMESPACE_NAME</span><span class="o">=</span>YOUR_NAMESPACE_NAME
<span class="nb">export </span><span class="nv">TB_QUEUE_SERVICE_BUS_SAS_KEY_NAME</span><span class="o">=</span>YOUR_SAS_KEY_NAME
<span class="nb">export </span><span class="nv">TB_QUEUE_SERVICE_BUS_SAS_KEY</span><span class="o">=</span>YOUR_SAS_KEY

<span class="c"># These params affect the number of requests per second from each partitions per each queue!!!</span>
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">REMOTE_JS_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000

<span class="c"># These params affect the number of requests per second from each partitions per each queue.</span>
<span class="c"># Number of requests to particular Message Queue is calculated based on the formula:</span>
<span class="c"># ((Number of Rule Engine and Core Queues) * (Number of partitions per Queue) + (Number of transport queues)</span>
<span class="c">#  + (Number of microservices) + (Number of JS executors)) * 1000 / POLL_INTERVAL_MS</span>
<span class="c"># For example, number of requests based on default parameters is:</span>

<span class="c"># Rule Engine queues:</span>
<span class="c"># Main 10 partitions + HighPriority 10 partitions + SequentialByOriginator 10 partitions = 30</span>
<span class="c"># Core queue 10 partitions</span>
<span class="c"># Transport request Queue + response Queue = 2</span>
<span class="c"># Rule Engine Transport notifications Queue + Core Transport notifications Queue = 2</span>
<span class="c"># Total = 44</span>
<span class="c"># Number of requests per second = 44 * 1000 / 25 = 1760 requests</span>

<span class="c"># Based on the use case, you can compromise latency and decrease number of partitions/requests to the queue, if the message load is low.</span>
<span class="c"># Sample parameters to fit into 10 requests per second on a "monolith" deployment: </span>

<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="rabbitmq" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="rabbitmq-installation">RabbitMQ Installation</h4>

<p>Use this <a href="https://www.rabbitmq.com/install-debian.html">instruction</a> for installing RabbitMQ.</p>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget to replace â€œYOUR_USERNAMEâ€ and â€œYOUR_PASSWORDâ€ with your <strong>real user credentials</strong>, â€œlocalhostâ€ and â€œ5672â€ with your <strong>real RabbitMQ host and port</strong>:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>rabbitmq
<span class="nb">export </span><span class="nv">TB_QUEUE_RABBIT_MQ_USERNAME</span><span class="o">=</span>YOUR_USERNAME
<span class="nb">export </span><span class="nv">TB_QUEUE_RABBIT_MQ_PASSWORD</span><span class="o">=</span>YOUR_PASSWORD
<span class="nb">export </span><span class="nv">TB_QUEUE_RABBIT_MQ_HOST</span><span class="o">=</span>localhost
<span class="nb">export </span><span class="nv">TB_QUEUE_RABBIT_MQ_PORT</span><span class="o">=</span>5672
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
    <div id="confluent-cloud" class="panel-collapse collapse">
      <div class="panel-body">
        <table><tr><td>
<h4 class="no_toc" id="confluent-cloud-configuration">Confluent Cloud Configuration</h4>

<p>To access <a href="https://docs.confluent.io/current/platform.html#what-is-cp">Confluent Cloud</a> 
you should first create an <a href="https://confluent.cloud/login">account</a>, 
then create a <a href="https://docs.confluent.io/current/quickstart/cloud-quickstart/index.html#step-1-create-a-ak-cluster-in-ccloud">Kafka cluster</a> 
and get your <a href="https://docs.confluent.io/current/quickstart/cloud-quickstart/index.html#step-4-create-an-api-key">API Key</a>.</p>

<h5 class="no_toc" id="thingsboard-configuration">ThingsBoard Configuration</h5>

<p>Edit ThingsBoard configuration file</p>

<div class="language-text copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file. Donâ€™t forget to replace â€œCLUSTER_API_KEYâ€, â€œCLUSTER_API_SECRETâ€ and â€œlocalhost:9092â€ with your real Confluent Cloud bootstrap servers:**</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">TB_QUEUE_TYPE</span><span class="o">=</span>kafka
<span class="nb">export </span><span class="nv">TB_QUEUE_KAFKA_USE_CONFLUENT_CLOUD</span><span class="o">=</span><span class="nb">true
export </span><span class="nv">TB_KAFKA_SERVERS</span><span class="o">=</span>localhost:9092
<span class="nb">export </span><span class="nv">TB_QUEUE_KAFKA_REPLICATION_FACTOR</span><span class="o">=</span>3
<span class="nb">export </span><span class="nv">TB_QUEUE_KAFKA_CONFLUENT_SASL_JAAS_CONFIG</span><span class="o">=</span>org.apache.kafka.common.security.plain.PlainLoginModule required <span class="nv">username</span><span class="o">=</span><span class="s2">"CLUSTER_API_KEY"</span> <span class="nv">password</span><span class="o">=</span><span class="s2">"CLUSTER_API_SECRET"</span><span class="p">;</span><span class="o">}</span>

<span class="c"># These params affect the number of requests per second from each partitions per each queue.</span>
<span class="c"># Number of requests to particular Message Queue is calculated based on the formula:</span>
<span class="c"># ((Number of Rule Engine and Core Queues) * (Number of partitions per Queue) + (Number of transport queues)</span>
<span class="c">#  + (Number of microservices) + (Number of JS executors)) * 1000 / POLL_INTERVAL_MS</span>
<span class="c"># For example, number of requests based on default parameters is:</span>

<span class="c"># Rule Engine queues:</span>
<span class="c"># Main 10 partitions + HighPriority 10 partitions + SequentialByOriginator 10 partitions = 30</span>
<span class="c"># Core queue 10 partitions</span>
<span class="c"># Transport request Queue + response Queue = 2</span>
<span class="c"># Rule Engine Transport notifications Queue + Core Transport notifications Queue = 2</span>
<span class="c"># Total = 44</span>
<span class="c"># Number of requests per second = 44 * 1000 / 25 = 1760 requests</span>

<span class="c"># Based on the use case, you can compromise latency and decrease number of partitions/requests to the queue, if the message load is low.</span>
<span class="c"># Sample parameters to fit into 10 requests per second on a "monolith" deployment: </span>

<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_CORE_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RULE_ENGINE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_MAIN_PARTITIONS</span><span class="o">=</span>2
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_HP_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_RE_SQ_PARTITIONS</span><span class="o">=</span>1
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_REQUEST_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_RESPONSE_POLL_INTERVAL_MS</span><span class="o">=</span>1000
<span class="nb">export </span><span class="nv">TB_QUEUE_TRANSPORT_NOTIFICATIONS_POLL_INTERVAL_MS</span><span class="o">=</span>1000
</pre></td></tr></tbody></table></code></pre></div></div>

</td></tr></table>
      </div>
    </div>
  </div>
</div>

<script>
    jqueryUiDefer(initContentToggleubuntuThingsboardQueue);
    function initContentToggleubuntuThingsboardQueue() {
        $(function(){

            window.addEventListener('popstate', onPopStateubuntuThingsboardQueue);

            onPopStateubuntuThingsboardQueue();

            $('.tb-content-toggle#ubuntuThingsboardQueue a.content-toggle-button').click(function(event) {
                event.preventDefault();
                var id = $(this).attr("data-target").substring(1);
                var param = 'ubuntuThingsboardQueue';
                var params = Qs.parse(window.location.search, { ignoreQueryPrefix: true });
                params[param] = id;

                var newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?' + Qs.stringify(params);
                if (window.location.hash) {
                    newurl += window.location.hash;
                }
                window.history.pushState({ path: newurl }, '', newurl);
                selectTargetubuntuThingsboardQueue(id);
            });
        });
    }

    function onPopStateubuntuThingsboardQueue() {
        var params = Qs.parse(window.location.search, { ignoreQueryPrefix: true });
        var targetId = params['ubuntuThingsboardQueue'];
        if (!targetId) {
            targetId = 'inmemory';
        }
        selectTargetubuntuThingsboardQueue(targetId);
    }

    function selectTargetubuntuThingsboardQueue(targetId) {
        $(".tb-content-toggle#ubuntuThingsboardQueue a.content-toggle-button").removeClass("active");
        $(".tb-content-toggle#ubuntuThingsboardQueue a.content-toggle-button[data-target='#"+targetId+"']").addClass("active");
        $('.tb-content-toggle#ubuntuThingsboardQueue .panel-collapse').removeClass("show");
        $('.tb-content-toggle#ubuntuThingsboardQueue .panel-collapse#'+targetId).addClass("show");
    }

</script>

<h3 id="step-5-optional-memory-update-for-slow-machines-1gb-of-ram">Step 5. [Optional] Memory update for slow machines (1GB of RAM)</h3>

<p>Edit ThingsBoard configuration file</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/thingsboard/conf/thingsboard.conf
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Add the following lines to the configuration file.</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># Update ThingsBoard memory usage and restrict it to 256MB in /etc/thingsboard/conf/thingsboard.conf</span>
<span class="nb">export </span><span class="nv">JAVA_OPTS</span><span class="o">=</span><span class="s2">"</span><span class="nv">$JAVA_OPTS</span><span class="s2"> -Xms256M -Xmx256M"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="step-6-run-installation-script">Step 6. Run installation script</h3>

<p>Once ThingsBoard service is installed and DB configuration is updated, you can execute the following script:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># --loadDemo option will load demo data: users, devices, assets, rules, widgets.</span>
<span class="nb">sudo</span> /usr/share/thingsboard/bin/install/install.sh <span class="nt">--loadDemo</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="step-7-start-thingsboard-service">Step 7. Start ThingsBoard service</h3>

<p>ThingsBoard UI is accessible on 8080 port by default. 
Make sure that your 8080 port is accessible via firewall.
In order to open 8080 port execute the following command:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>firewall-cmd <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-port</span><span class="o">=</span>8080/tcp <span class="nt">--permanent</span>
<span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Execute the following command to start ThingsBoard:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>service thingsboard start

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Once started, you will be able to open Web UI using the following link:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>http://localhost:8080/
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The following default credentials are available if you have specified <em>â€“loadDemo</em> during execution of the installation script:</p>

<ul>
  <li><strong>System Administrator</strong>: sysadmin@thingsboard.org / sysadmin</li>
  <li><strong>Tenant Administrator</strong>: tenant@thingsboard.org / tenant</li>
  <li><strong>Customer User</strong>: customer@thingsboard.org / customer</li>
</ul>

<p>You can always change passwords for each account in account profile page.</p>

<div class="info-banner">
<img src="/images/doc-info-icon.svg" />   <div>
    <p>Please allow up to 90 seconds for the Web UI to start. This is applicable only for slow machines with 1-2 CPUs or 1-2 GB RAM.</p>
  </div>
</div>

<h3 id="post-installation-steps">Post-installation steps</h3>

<p><strong>Configure HAProxy to enable HTTPS</strong></p>

<p>You may want to configure HTTPS access using HAProxy. 
This is possible in case you are hosting ThingsBoard in the cloud and have a valid DNS name assigned to your instance.
Please follow this <a href="/docs/user-guide/install/pe/add-haproxy-rhel">guide</a> to install HAProxy and generate valid SSL certificate using Letâ€™s Encrypt.</p>

<h3 id="troubleshooting">Troubleshooting</h3>

<p>ThingsBoard logs are stored in the following directory:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/var/log/thingsboard
</pre></td></tr></tbody></table></code></pre></div></div>

<p>You can issue the following command in order to check if there are any errors on the backend side:</p>

<div class="language-bash copy-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cat</span> /var/log/thingsboard/thingsboard.log | <span class="nb">grep </span>ERROR
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="next-steps">Next steps</h2>

<ul>
  <li>
    <p><a href="/docs/guides#AnchorIDGettingStartedGuides">Getting started guides</a> - These guides provide quick overview of main ThingsBoard features. Designed to be completed in 15-30 minutes.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDConnectYourDevice">Connect your device</a> - Learn how to connect devices based on your connectivity technology or solution.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDDataVisualization">Data visualization</a> - These guides contain instructions how to configure complex ThingsBoard dashboards.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDDataProcessing">Data processing &amp; actions</a> - Learn how to use ThingsBoard Rule Engine.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDDataAnalytics">IoT Data analytics</a> - Learn how to use rule engine to perform basic analytics tasks.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDHardwareSamples">Hardware samples</a> - Learn how to connect various hardware platforms to ThingsBoard.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDAdvancedFeatures">Advanced features</a> - Learn about advanced ThingsBoard features.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDContribution">Contribution and Development</a> - Learn about contribution and development in ThingsBoard.</p>
  </li>
</ul>

<p><br /></p>


      </div>
      <footer>
	<main class="light-text">
		<div class="newsletterSubsContainer">
            <script type="text/javascript">
                function subscribeForNewsletter(event) {
                    event.stopPropagation();
                    var script_tag = document.createElement('script');
                    script_tag.setAttribute("type", "text/javascript");
                    script_tag.setAttribute("src", "https://static.mailerlite.com/js/w/webforms.min.js?v28bf44f740701752bfc6767bc7e171d4");
                    document.getElementsByTagName("head")[0].appendChild(script_tag);
                    $(event.target).css('display', 'none');
                    $('#mlb2-7341216').css('display', 'block');
                }
            </script>
            <button class="n-button price subscribe" onClick="subscribeForNewsletter(event)">Sign up for ThingsBoard news</button>
            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: none;">
<!--            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: block;">-->
                <div class="ml-vertical-align-center">
                    <div class="subscribe-form ml-block-success" style="display: none;">
                        <div class="form-section">
                            <p>Thank you for your interest in ThingsBoard!<br/>Have a great day!</p>
                        </div>
                    </div>
                    <form class="ml-block-form" action="https://static.mailerlite.com/webforms/submit/r9r9x7" data-id="708170" data-code="r9r9x7" method="POST" target="_blank">
                        <div class="subscribe-form horizontal">
                            <div class="form-section horizontal">
                                <div class="form-group ml-field-email ml-validate-required ml-validate-email">
                                    <input type="email" name="fields[email]" class="form-control" placeholder="Email address*" value="" autocomplete="email" x-autocompletetype="email" spellcheck="false" autocapitalize="off" autocorrect="off">
                                </div>
                            </div>
                            <input type="hidden" name="ml-submit" value="1">
                            <div class="form-section horizontal ml-button-position">
                                <button class="primary n-button price subscribe" type="submit">
                                    Subscribe
                                </button>
                                <button disabled="disabled" style="display: none;" type="button" class="n-button loading">
                                    <img src="https://static.mailerlite.com/images/rolling@2x.gif" width="20" height="20" style="width: 20px; height: 20px;">
                                </button>
                            </div>
                            <p>By subscribing you agree to receive newsletters from ThingsBoard, Inc.</p>
                        </div>
                    </form>
                </div>
            </div>
		</div>

        <hr>

        <div class="deeper">
            <a href="/" class="footer-logo"></a>
            <nav>
                <a href="/docs/getting-started-guides/helloworld/">Get Started</a>
                <a href="/docs/">Documentation</a>
                <a href="/iot-use-cases/">Use cases</a>
                <a href="https://blog.thingsboard.io/">Blog</a>
                <a href="/docs/services/">Services</a>
                <a href="/docs/contact-us/">Contact us</a>
            </nav>
        </div>

        <div class="deepmost">
            <div class="copyright">&copy; 2021 The ThingsBoard Authors</div>
            <div class="social">
                <a href="https://github.com/thingsboard/thingsboard" class="github"></a>
                <a href="https://gitter.im/thingsboard/chat" class="gitter"></a>
                <a href="https://www.youtube.com/thingsboard" class="youtube"></a>
                <a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"></a>
                <a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"></a>
                <a href="https://www.facebook.com/thingsboard" class="facebook"></a>
                <a href="https://twitter.com/thingsboard" class="twitter"></a>
            </div>
        </div>
	</main>
</footer>

  </div>
</section>

<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
<script>
    jqueryDefer(function () {
        $(document).on('selectionchange',function() {
        // $(document).mouseup(function () {
            $('.clipboard-btn').removeClass('noChars');
            var selectedChars = getSelectedText();
            // $('#numberChars').html(selectedChars.length);
            if (selectedChars == 0) {
                $('.clipboard-btn').addClass('noChars');
            }
        });
    });
    function getSelectedText() {
        var text;
        if (window.getSelection) {
            text = window.getSelection().toString();
        } else if (document.getSelection) {
            text = document.getSelection();
        } else if (document.selection) {
            text = document.selection.createRange().text;
        }
        return text;
    }
</script>
<script>
    jqueryDefer(function () {
        $(document).ready(function () {
            var allCodeBlocksElements = $(".copy-code");
            allCodeBlocksElements.each(function (i) {
                var codeBlock = $(this);
                if (!codeBlock.hasClass('highlighter-rouge')) {
                    codeBlock = codeBlock.find('.highlighter-rouge');
                }
                codeBlock.each(function () {
                    var block = codeBlock.find('pre.highlight > code .rouge-code');
                    var currentId = "codeblock" + (i + 1);
                    block.attr('id', currentId);
                    var clipButton = $('<button class="clipboard-btn" data-clipboard-target="#' + currentId + '"><p>Copy to clipboard</p><div><img src="/images/copy-code-icon.svg" alt="Copy to clipboard"></div></button>');
                    $(this).append(clipButton);
                    var troyan = codeBlock.find('pre.highlight');
                    var Tooltip = $('<div class="customTooltip"><div class="tooltipText">Copied!</div></div>');
                    troyan.append(Tooltip);
                    troyan.addClass('clipboard-btn');
                    troyan.attr('data-clipboard-target', "#" + currentId);
                    troyan.on('mouseleave', clearTooltip);
                    troyan.on('blur', clearTooltip);
                    troyan.on('click', function(e) {
                        var el = $(e.currentTarget);
                        if (el.hasClass('showTool')) {
                            clearTooltip(e);
                            troyan.attr('data-skip-tooltip', "true");
                        }
                    });
                });
            });

            var clipboard = new Clipboard('.noChars');
            clipboard.on('success', function (e) {
                $('.clipboard-btn').removeClass('noChars');
                e.clearSelection();
                var trigger = e.trigger;
                if (!$(trigger).attr('data-skip-tooltip')) {
                    showTooltip(e.trigger, 'Copied!');
                } else {
                    $(trigger).removeAttr('data-skip-tooltip');
                }
            });

            $('#search').focus(
                function(){
                    $(this).parent('#searchBox').addClass('focused');
                }).blur(
                function(){
                    $(this).parent('#searchBox').removeClass('focused');
                });

            $('#searchBox .searchButton').click(function () {
                var value = $('#search').val();
                window.location.replace('/docs/search/?q=' + value);
            });

            $('#docsBreadcrumbs').click(function () {
                if ($(this).hasClass('active')) {
                    $(this).removeClass('active');
                    $('#docsNav').removeClass('active');
                    $('#searchBox').removeClass('visible');
                } else {
                    $(this).addClass('active');
                    $('#docsNav').addClass('active');
                    $('#searchBox').addClass('visible');
                }
            });
        });

        function clearTooltip(e) {
            var el = $(e.currentTarget);
            el.removeClass('showTool');
            el.attr('aria-label', null);
        }

        function showTooltip(elem, msg) {
            var el = $(elem);
            el.addClass('showTool');
            el.attr('aria-label', msg);
        }
    });
</script>

<script>
    jqueryDefer(function () {
        var markdownTocs = null;
        var contentAnchors = [];
        var activeAnchor = null;
        var firstAnchor = null;
        var lastAnchor = null;

        function updatePositions() {
            contentAnchors = [];
            markdownTocs.each(function (i) {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                var contentAnchor = $('div#content ' + href);
                var top = Math.floor(contentAnchor.offset().top);
                var bottom;
                if (i < markdownTocs.length - 1) {
                    var nextHref = $(markdownTocs[i + 1]).children('a').attr('href');
                    var nextContentAnchor = $('div#content ' + nextHref);
                    bottom = Math.floor(nextContentAnchor.offset().top);
                } else {
                    bottom = $('div#content').offset().top + $('div#content').innerHeight();
                }
                var contentAnchorInfo = {anchor: contentAnchor, toc: $(this), top: top, bottom: bottom, href: href};
                contentAnchors.push(contentAnchorInfo);
                if (i === 0) {
                    firstAnchor = contentAnchorInfo;
                }
                if (i === markdownTocs.length - 1) {
                    lastAnchor = contentAnchorInfo;
                }
            });
        }

        function findActiveContentToc() {
            var top = $(window).scrollTop();
            var bottom = top + $(window).height();
            if (bottom === $('#encyclopedia').offset().top + $('#encyclopedia').innerHeight()) {
                return lastAnchor;
            } else {
                bottom -= 154;
                for (var i = 0; i < contentAnchors.length; i++) {
                    var contentAnchor = contentAnchors[i];
                    if (contentAnchor.top <= bottom &&
                        contentAnchor.bottom > top) {
                        return contentAnchor;
                    }
                }
            }
            return firstAnchor;
        }

        function updateActiveToc(init) {
            updatePositions();
            var newActiveAnchor = findActiveContentToc();
            if (!activeAnchor || newActiveAnchor.href !== activeAnchor.href) {
                activeAnchor = newActiveAnchor;
                markdownTocs.removeClass('active');
                activeAnchor.toc.addClass('active');
                var tocTop = $('#table-of-contents').scrollTop() + 100;
                var tocBottom = tocTop + $('#table-of-contents').innerHeight() - 200;
                var activeTocTop = activeAnchor.toc.position().top;
                var activeTocBottom = activeTocTop + activeAnchor.toc.children(':first').height();
                if (tocTop > activeTocTop) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop -= 100;
                } else if (tocBottom < activeTocBottom) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop += init ? -100 : 100;
                }
            }
        }
        $( document ).ready(function() {
            var tocs = $('#content > ul#markdown-toc');
            var tableOfContents = $('#table-of-contents');
            tableOfContents.append(tocs);
            markdownTocs = $('#table-of-contents ul#markdown-toc li').filter(function() {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                if (!href.startsWith('#')) {
                    return false;
                } else {
                    var contentAnchor = $('div#content ' + href);
                    return contentAnchor.length > 0;
                }
            });
            updateActiveToc(true);
        });

        $(document).on("scroll", function() {
            updateActiveToc(false);
        });

    });
</script>

</body>
</html>

