







<!Doctype html>
<html id="docs" class="Guides">







<head>
    <meta charset="utf-8">
    <meta name="cf-2fa-verify" content="a08672380de15e9">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Send RPC Request to the Related Device | ThingsBoard Community Edition</title>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Send RPC Request to the Related Device" />
<meta name="author" content="thingsboard" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Send RPC Request to a Device" />
<meta property="og:description" content="Send RPC Request to a Device" />
<link rel="canonical" href="http://0.0.0.0:4002/docs/user-guide/rule-engine-2-0/tutorials/rpc-request-tutorial/" />
<meta property="og:url" content="http://0.0.0.0:4002/docs/user-guide/rule-engine-2-0/tutorials/rpc-request-tutorial/" />
<meta property="og:site_name" content="ThingsBoard" />
<meta property="og:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://0.0.0.0:4002/images/thingsboard_logo.png" />
<meta property="twitter:title" content="Send RPC Request to the Related Device" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
{"url":"http://0.0.0.0:4002/docs/user-guide/rule-engine-2-0/tutorials/rpc-request-tutorial/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:4002/images/thingsboard_logo.png"},"name":"thingsboard"},"author":{"@type":"Person","name":"thingsboard"},"image":{"twitter":"/images/thingsboard_logo.png","facebook":"/images/thingsboard_logo.png","url":"http://0.0.0.0:4002/images/thingsboard_logo.png","@type":"imageObject"},"description":"Send RPC Request to a Device","@type":"WebPage","headline":"Send RPC Request to the Related Device","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
    
    <meta name="twitter:description" content="Send RPC Request to a Device"/>
    
    
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.7.0/qs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gifffer/1.5.0/gifffer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
    <script type="text/javascript">
        window.onload = function() {
            Gifffer();
        }
    </script>
    <script type="text/javascript">
        /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
        !function (a) {
            "use strict";
            var b = function (b, c, d) {
                function e(a) {
                    return h.body ? a() : void setTimeout(function () {
                        e(a)
                    })
                }

                function f() {
                    i.addEventListener && i.removeEventListener("load", f), i.media = d || "all"
                }

                var g, h = a.document, i = h.createElement("link");
                if (c) g = c; else {
                    var j = (h.body || h.getElementsByTagName("head")[0]).childNodes;
                    g = j[j.length - 1]
                }
                var k = h.styleSheets;
                i.rel = "stylesheet", i.href = b, i.media = "only x", e(function () {
                    g.parentNode.insertBefore(i, c ? g : g.nextSibling)
                });
                var l = function (a) {
                    for (var b = i.href, c = k.length; c--;) if (k[c].href === b) return a();
                    setTimeout(function () {
                        l(a)
                    })
                };
                return i.addEventListener && i.addEventListener("load", f), i.onloadcssdefined = l, l(f), i
            };
            "undefined" != typeof exports ? exports.loadCSS = b : a.loadCSS = b
        }("undefined" != typeof global ? global : this);

        /*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
        function onloadCSS(a, b) {
            function c() {
                !d && b && (d = !0, b.call(a))
            }

            var d;
            a.addEventListener && a.addEventListener("load", c), a.attachEvent && a.attachEvent("onload", c), "isApplicationInstalled" in navigator && "onloadcssdefined" in a && a.onloadcssdefined(c)
        }
    </script>
    <script type="text/javascript">

        function jqueryDefer(method) {
            if (window.jQuery) {
                method();
            } else {
                setTimeout(function () {
                    jqueryDefer(method)
                }, 50);
            }
        }

        function jqueryUiDefer(method) {
            if (window.jQuery && window.jQuery.ui) {
                method();
            } else {
                setTimeout(function () {
                    jqueryUiDefer(method)
                }, 50);
            }
        }

        window.vis = (function () {
            var stateKey,
                eventKey,
                keys = {
                    hidden: "visibilitychange",
                    webkitHidden: "webkitvisibilitychange",
                    mozHidden: "mozvisibilitychange",
                    msHidden: "msvisibilitychange"
                };
            for (stateKey in keys) {
                if (stateKey in document) {
                    eventKey = keys[stateKey];
                    break;
                }
            }
            return function (c) {
                if (c) document.addEventListener(eventKey, c);
                return !document[stateKey];
            }
        })();

        function loadScript(src, callback) {
            var s, r, t;
            r = false;
            s = document.createElement('script');
            s.type = 'text/javascript';
            s.src = src;
            s.onload = s.onreadystatechange = function () {
                if (!r && (!this.readyState || this.readyState == 'complete')) {
                    r = true;
                    if (callback) {
                        callback();
                    }
                }
            };
            t = document.getElementsByTagName('script')[0];
            t.parentNode.insertBefore(s, t);
        }

        function loadCssAsync(src, callback) {
            var stylesheet = loadCSS(src);
            if (callback) {
                onloadCSS(stylesheet, callback);
            }
        }

        function loadNextScript(index, scriptsList, completeCallback) {
            if (index < scriptsList.length) {
                var script = scriptsList[index];
                if (script.type === 'script') {
                    loadScript(script.src, function () {
                        if (script.callback) {
                            script.callback();
                        }
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                } else if (script.type === 'css') {
                    loadCssAsync(script.src, function () {
                        index++;
                        loadNextScript(index, scriptsList, completeCallback);
                    });
                }
            } else if (completeCallback) {
                completeCallback();
            }
        }

        var initialScriptsList = [
            {src: '/js/jquery-2.2.0.min.js', type: 'script'},
            {src: '/css/jquery-ui.min.css', type: 'css'},
            {src: '/js/jquery-ui.min.js', type: 'script'},
            {src: '/js/jquery.vide.js', type: 'script'},
            {src: '/js/script.js', type: 'script'},
            {src: '/css/photoswipe.css', type: 'css'},
            {src: '/css/default-skin/default-skin.css', type: 'css'},
            {src: '/js/photoswipe.min.js', type: 'script'},
            {src: '/js/photoswipe-ui-default.min.js', type: 'script'}
        ];

        loadNextScript(0, initialScriptsList);

        jqueryDefer(function () {
            (function ($, win) {
                $.fn.inViewport = function (cb) {
                    return this.each(function (i, el) {
                        function visPx() {
                            var H = $(this).height(),
                                r = el.getBoundingClientRect(), t = r.top, b = r.bottom;
                            var result = cb.call(el, Math.max(0, t > 0 ? H - t : (b < H ? b : H)));
                            if (result) {
                                $(win).off("resize scroll", visPx);
                            }
                        }

                        visPx();
                        $(win).on("resize scroll", visPx);
                    });
                };
            }(jQuery, window));
        });

        function inViewportDefer(method) {
            if (window.jQuery && $.fn.inViewport) {
                method();
            } else {
                setTimeout(function () {
                    inViewportDefer(method)
                }, 50);
            }
        }

    </script>
    <script type="text/javascript">
        function _gaLt(event) {
            /* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
            if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
                return;
            }
            var el = event.srcElement || event.target;

            while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
                el = el.parentNode;
            }
            if (el && el.href) {
                var link = el.href;
                if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
                    var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
                        target = "_blank";
                    }

                    var hbrun = false; // tracker has not yet run
                    var hitBack = function () {
                        if (hbrun) return;
                        hbrun = true;
                        window.location.href = link;
                    };

                    if (target) {
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search
                        );
                    } else {
                        event.preventDefault ? event.preventDefault() : event.returnValue = !1;
                        ga(
                            "send", "event", "Outgoing Links", link,
                            document.location.pathname + document.location.search, {
                                "hitCallback": hitBack
                            }
                        );

                        setTimeout(hitBack, 1000);
                    }
                }
            }
        }

        var _w = window;
        var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
        _w.addEventListener ? _w.addEventListener("load", function () {
                document.body.addEventListener(_gaLtEvt, _gaLt, !1)
            }, !1)
            : _w.attachEvent && _w.attachEvent("onload", function () {
            document.body.attachEvent("on" + _gaLtEvt, _gaLt)
        });
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-88383331-1', 'auto');
        ga('send', 'pageview');
    </script>
    <script>
        function Burger() {
            var header = $('header');
            var body = $('body');
            if (header.hasClass('opened-burger')) {
                header.removeClass('opened-burger');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                body.css('overflow', '');
            } else {
                header.addClass('opened-burger');
                body.css('overflow', 'hidden');
            }
        }
    </script>
    <script>

        jqueryDefer(function () {
            let menuElement = $('nav.head-menu > ul');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            let menuItems = $('nav.head-menu > ul > li');
            let indicator = $('nav.head-menu > ul > div.indicator');
            let subMenuActive = false;
            menuElement.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('div.sub-menu-container').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            submenuContainer.on('mouseleave', function (event) {
                if (!$(event.relatedTarget).parents('nav.head-menu > ul').length) {
                    subMenuActive = false;
                    submenuContainer.removeClass('active bounds-transition');
                    menuItems.removeClass('active');
                    indicator.removeClass('left-transition');
                }
            });
            menuItems.each(function() {
                let item = $( this );
                let subMenuId = item.attr('data-submenu-id');
                item.on('mouseenter', function () {
                    let submenus = $('nav.head-menu > div.sub-menu-container > div');
                    submenus.css('display', 'none');
                    menuItems.removeClass('active');
                    item.addClass('active');
                    let targetSubMenu = $('nav.head-menu > div.sub-menu-container > div#'+subMenuId);
                    targetSubMenu.css('display', 'block');
                    submenuContainer.css('overflow', 'visible');
                    let left = item.position().left + (item.outerWidth() - targetSubMenu.outerWidth()) / 2;
                    submenuContainer.css('left', left + 'px');
                    if (!subMenuActive) {
                        submenuContainer.addClass('active');
                        subMenuActive = true;
                    } else {
                        submenuContainer.addClass('bounds-transition');
                        indicator.addClass('left-transition');
                    }
                    indicator.css('left', item.position().left);
                    indicator.css('width', item.outerWidth());
                    submenuContainer.css('height', targetSubMenu.outerHeight() + 'px');
                    submenuContainer.css('width', targetSubMenu.outerWidth() + 'px');
                    submenuContainer.css('overflow', 'hidden');
                });
            });

            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                initMobileSubmenu();
            }

            $(window).resize(function(){
                let newIsMobile = $('button.burger').css('display') === 'block';
                if (isMobile !== newIsMobile) {
                    isMobile = newIsMobile;
                    if (isMobile) {
                        initMobileSubmenu();
                    } else {
                        restoreDesktopSubmenu();
                    }
                }
            });

            // Products selector

            
            let productsSelector = $('.products-selector');
            $(window).click(function(e) {
                if (productsSelector[0].contains(e.target)) {
                    if (productsSelector.hasClass('active')) {
                        productsSelector.removeClass('active');
                    } else {
                        productsSelector.addClass('active');
                    }
                } else {
                    productsSelector.removeClass('active');
                }
            });
            

            // Rogue line numbers fix (don't show line numbers for 1 row)
            $( document ).ready(function() {
                $('.rouge-gutter.gl').each(function() {
                    var lineNumbers = $(this).children('.lineno');
                    if (lineNumbers.text() === '1\n') {
                        $(this).css('display', 'none');
                    }
                });
            });
        });

        function initMobileSubmenu() {

            var header = $('header');
            if (header.hasClass('opened-burger')) {
                var body = $('body');
                body.css('overflow', 'hidden');
            }

            let targetSubMenus = $('nav.head-menu > div.sub-menu-container > div');
            targetSubMenus.css('display', 'block');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'none');

            targetSubMenus.each(function() {
                let subMenu = $( this );
                let subMenuId = subMenu.attr('id');
                let parent = $('nav.head-menu > ul > li.'+subMenuId);
                parent.append(subMenu);
            });
        }

        function restoreDesktopSubmenu() {
            var body = $('body');
            body.css('overflow', '');
            let targetSubMenus = $('nav.head-menu > ul > li > div');
            let submenuContainer = $('nav.head-menu > div.sub-menu-container');
            submenuContainer.removeClass('active');
            submenuContainer.css('display', 'block');
            let menuItems = $('nav.head-menu > ul > li');
            menuItems.removeClass('active');
            targetSubMenus.each(function() {
                let subMenu = $( this );
                submenuContainer.append(subMenu);
            });
        }

        function listburg(subMenuId) {
            let isMobile = $('button.burger').css('display') === 'block';
            if (isMobile) {
                let targetSubMenu = $('nav.head-menu > ul > li > div.centered-sub#'+subMenuId+' > ul.sub-menu');
                let isOpen = targetSubMenu.hasClass('open-sub');
                let subMenus = $('nav.head-menu > ul > li > div.centered-sub > ul.sub-menu');
                subMenus.removeClass('open-sub');
                if (!isOpen) {
                    targetSubMenu.addClass('open-sub');
                }
            }
        }
    </script>
</head>
<body>

<div class="products-selector">
    <img src="/images/thingsboard-cm-icon.svg"/>
    <div class="product-info">
        <div class="product-title">
            Community Edition
        </div>
        <div class="product-description">
            ThingsBoard Documentation
        </div>
    </div>
    <div class="products">
        
        

    
        
        


        
    


        <a href="/docs/paas/" class="product">Cloud</a>
        
        

    
        
        


        
    


        <a href="/docs/pe/" class="product">Professional Edition</a>
        
        

    
        
        


        
            
        
    


        <a href="/docs/user-guide/rule-engine-2-0/tutorials/rpc-request-tutorial/" class="product active">Community Edition</a>
        
        

    


        <a href="/docs/edge/" class="product">Edge</a>
        
        

    


        <a href="/docs/iot-gateway/" class="product">IoT Gateway</a>
        
        

    


        <a href="/products/license-server/" class="product">License Server</a>
        
        

    


        <a href="/docs/trendz/" class="product">Trendz Analytics</a>
        
    </div>
</div>

<header>
    <div class="logo-burger">
        
        <button onclick="Burger()" class="burger"></button>
        <div id="githubButtonContainer">
            <a class="github-button" href="https://github.com/thingsboard/thingsboard" data-show-count="true"
               aria-label="Star thingsboard/thingsboard on GitHub">Star</a>
        </div>
    </div>
    <nav class="head-menu">
        <ul>
            <li class="nav-products" data-submenu-id="nav-products">
                <a onclick="listburg('nav-products')">Products</a>
            </li>
            <li class="nav-services" data-submenu-id="nav-services">
                <a onclick="listburg('nav-services')">Services</a>
            </li>
            
            <li class="nav-cases" data-submenu-id="nav-cases">
                <a onclick="listburg('nav-cases')">Use Cases</a>
            </li>
            <li class="nav-customers" data-submenu-id="nav-customers">
                <a onclick="listburg('nav-customers')">Customers</a>
            </li>
            <li class="nav-company" data-submenu-id="nav-company">
                <a onclick="listburg('nav-company')">Company</a>
            </li>
            <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
        </ul>
        <div class="sub-menu-container">
            <div id="nav-products" class="centered-sub">
                <ul class="sub-menu products">
                    <div class="sub-groups">
                        <div class="group">
                            <p class="group-name">IoT platforms</p>
                            <a class="cloud-lnk" href="/products/paas/">
                                <img src="/images/thingsboard-c-icon.svg">
                                <div class="sub-text">
                                    <h1>Cloud</h1>
                                    <p>Platform as a service</p>
                                </div>
                            </a>
                            <a class="prof-lnk" href="/products/thingsboard-pe/">
                                <img src="/images/thingsboard-p-icon.svg">
                                <div class="sub-text">
                                    <h1>Professional Edition</h1>
                                    <p>Advanced IoT platform</p>
                                </div>
                            </a>
                            <a class="com-lnk" href="/">
                                <img src="/images/thingsboard-cm-icon.svg">
                                <div class="sub-text">
                                    <h1>Community Edition</h1>
                                    <p>Open source platform</p>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <p class="group-name">Product ecosystem</p>
                            <a class="edge-lnk" href="/products/thingsboard-edge/">
                                <img src="/images/thingsboard-e-icon.svg">
                                <div class="sub-text">
                                    <h1>Edge</h1>
                                    <p>Edge computing</p>
                                </div>
                            </a>
                            <a class="gateway-lnk" href="/docs/iot-gateway/what-is-iot-gateway/">
                                <img src="/images/gateway-icon.svg">
                                <div class="sub-text">
                                    <h1>IoT Gateway</h1>
                                    <p>Connect legacy protocols</p>
                                </div>
                            </a>
                            <a class="license-lnk" href="/products/license-server/">
                                <img src="/images/license-icon.svg">
                                <div class="sub-text">
                                    <h1>License Server</h1>
                                    <p>Billing solution</p>
                                </div>
                            </a>
                            <a class="trendz-lnk" href="/products/trendz/">
                                <img src="/images/trendz-icon.svg">
                                <div class="sub-text">
                                    <h1>Trendz Analytics</h1>
                                    <p>Data analytics and Prediction</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-services" class="centered-sub">
                <ul class="sub-menu services">
                    <a href="/docs/services/support/">
                        <img src="/images/support-icon.svg">
                        <div class="sub-text">
                            <h1>Support</h1>
                            <p>Support packages</p>
                        </div>
                    </a>
                    <a href="/docs/services/trainings/">
                        <img src="/images/train-icon.svg">
                        <div class="sub-text">
                            <h1>Trainings</h1>
                            <p>ThingsBoard education courses</p>
                        </div>
                    </a>
                    <a href="/docs/services/consulting/">
                        <img src="/images/prof-icon.svg">
                        <div class="sub-text">
                            <h1>Professional services</h1>
                            <p>Development of solutions by the ThingsBoard team</p>
                        </div>
                    </a>
                </ul>
            </div>
            
            <div id="nav-cases" class="centered-sub">
                <ul class="sub-menu cases">
                    <a href="/smart-metering/">
                        <img src="/images/case-met-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Metering</h1>
                            <p>Collection, analysis and visualization of data from meters</p>
                        </div>
                    </a>
                    <a href="/smart-energy/">
                        <img src="/images/case-eng-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Energy</h1>
                            <p>Energy monitoring and efficiency analysis</p>
                        </div>
                    </a>
                    <a href="/smart-farming/">
                        <img src="/images/case-fam-icon.svg">
                        <div class="sub-text">
                            <h1>Smart Farming</h1>
                            <p>Monitoring of indoor conditions and plant growth characteristics</p>
                        </div>
                    </a>
                    <a href="/fleet-tracking/">
                        <img src="/images/case-trk-icon.svg">
                        <div class="sub-text">
                            <h1>Fleet Tracking</h1>
                            <p>Fleet tracking and fleet management</p>
                        </div>
                    </a>
                </ul>
            </div>
            <div id="nav-customers" class="centered-sub">
                <ul class="sub-menu customers">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/industries/smart-energy/">
                                <img src="/images/se-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Energy</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/agriculture/">
                                <img src="/images/agr-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Agriculture</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/smart-buildings/">
                                <img src="/images/sb-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart Buildings</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/industries/smart-city/">
                                <img src="/images/sc-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Smart City</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/telecom/">
                                <img src="/images/tel-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Telecom</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/industries/industry40/">
                                <img src="/images/in-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Industry 4.0</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                </ul>
            </div>
            <div id="nav-company" class="centered-sub">
                <ul class="sub-menu about">
                    <div class="sub-groups">
                        <div class="group">
                            <a class="small-link" href="/company/">
                                <img src="/images/about-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Our Company</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/docs/contact-us/">
                                <img src="/images/contact-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Contact Us</h1>
                                </div>
                            </a>
                            <a class="small-link" href="/careers/">
                                <img src="/images/careers-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Careers</h1>
                                </div>
                            </a>
                        </div>
                        <div class="group">
                            <a class="small-link" href="/mediakit/">
                                <img src="/images/media-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Media Kit</h1>
                                </div>
                            </a>
                            <a class="small-link" href="https://blog.thingsboard.io/">
                                <img src="/images/blog-s-icon.svg">
                                <div class="sub-text">
                                    <h1>Blog</h1>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="bottom-group">
                        <a class="small-link" href="/partners/hardware/">
                            <img src="/images/hard-s-icon.svg">
                            <div class="sub-text">
                                <h1>Hardware partners</h1>
                            </div>
                        </a>
                        <a class="small-link" href="/partners/distributors/">
                            <img src="/images/dis-s-icon.svg">
                            <div class="sub-text">
                                <h1>Distributors</h1>
                            </div>
                        </a>
                    </div>
                </ul>
            </div>
        </div>
    </nav>
    <div>
        <a href="/installations/" class="n-button try">Try it now</a>
        <a href="/pricing/" class="n-button price">Pricing</a>
    </div>
</header>


<div id="searchBox">
    <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    <button class="searchButton"></button>
</div>

<!--  HERO  -->
<section id="hero">
  <div id="hero-content">
    <div id="vendorStrip">
      <div id="docsList">
          <ul>
            
              
              
              
              <li>
                  <a href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/" >Documentation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/guides/" class="YAH">Guides</a>
                  
                     <div class="indicator"><div class="head-arrow"></div><div class="line"></div><div class="sub-background"></div></div>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/user-guide/install/installation-options/" >Installation</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/reference/" >Architecture</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/api/" >API</a>
                  
              </li>
            
              
              
              
              <li>
                  <a href="/docs/faq/" >FAQ</a>
                  
              </li>
            
          </ul>
          <div id="docsBreadcrumbs">
              
                  
                  
                  
                  
                      
                  
                      
                         
                         
                         
    
        
        
        
    

    

    

    

    

    

    

    


        
            
        
    

    
        
        
        
    

    

    
        
        
        

        
            

                         
                            
                  
                    <span class="item">Guides</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">Tutorials</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">Advanced</span>
                    
                        <span class="divider">></span>
                    
                  
                    <span class="item">RPC Request to Related Device</span>
                    
                  
              
          </div>
      </div>
    </div>
  </div>
</section>
<div id="docsNav">
    <div class="docItems">
        
            
            
                <a class="toc" href="/docs/getting-started-guides/helloworld/" >Getting Started</a>
            
        
            
            
                <a class="toc" href="/docs/" >Documentation</a>
            
        
            
            
                <div class="pi-accordion">
                    


<a class="item" data-title="Guides" href="/docs/guides/"></a>


<div class="item" data-title="Tutorials">
  <div class="container">


<div class="item" data-title="Basics">
  <div class="container">


<a class="item" data-title="Validate incoming telemetry" href="/docs/user-guide/rule-engine-2-0/tutorials/validate-incoming-telemetry/"></a>


<a class="item" data-title="Transform incoming telemetry" href="/docs/user-guide/rule-engine-2-0/tutorials/transform-incoming-telemetry/"></a>


<a class="item" data-title="Transform telemetry using previous record" href="/docs/user-guide/rule-engine-2-0/tutorials/transform-telemetry-using-previous-record/"></a>


<a class="item" data-title="Create Alarm when the Device is offline" href="/docs/user-guide/rule-engine-2-0/tutorials/create-inactivity-alarm/"></a>


<a class="item" data-title="Create & Clear Alarms" href="/docs/user-guide/rule-engine-2-0/tutorials/create-clear-alarms/"></a>


<a class="item" data-title="Send Email v2" href="/docs/user-guide/rule-engine-2-0/tutorials/send-email/"></a>


<a class="item" data-title="Using queues for synchronization" href="/docs/user-guide/rule-engine-2-5/tutorials/queues-for-synchronization/"></a>


<a class="item" data-title="Using queues for message reprocessing" href="/docs/user-guide/rule-engine-2-5/tutorials/queues-for-message-reprocessing/"></a>
  </div>
</div>


<div class="item" data-title="Advanced">
  <div class="container">


<a class="item" data-title="Check Relation between Entities" href="/docs/user-guide/rule-engine-2-0/tutorials/check-relation-tutorial/"></a>


<a class="item" data-title="RPC Reply With data from Related Device" href="/docs/user-guide/rule-engine-2-0/tutorials/rpc-reply-tutorial/"></a>


<a class="item" data-title="RPC Request to Related Device" href="/docs/user-guide/rule-engine-2-0/tutorials/rpc-request-tutorial/"></a>


<a class="item" data-title="Create & Clear Alarms" href="/docs/user-guide/rule-engine-2-0/tutorials/create-clear-alarms/"></a>


<a class="item" data-title="Send Email To Customer" href="/docs/user-guide/rule-engine-2-0/tutorials/send-email/"></a>
  </div>
</div>


<div class="item" data-title="PE">
  <div class="container">


<a class="item" data-title="Add & remove devices from groups dynamically" href="/docs/user-guide/rule-engine-2-0/tutorials/add-devices-to-group/"></a>
  </div>
</div>
  </div>
</div>


<a class="item" data-title="Video Tutorials" href="/docs/iot-video-tutorials/"></a>


<a class="item" data-title="Samples" href="/docs/samples/"></a>


<a class="item" data-title="Live Demo Server" href="/docs/user-guide/live-demo/"></a>


<a class="item" data-title="Local Demo Account" href="/docs/samples/demo-account/"></a>


<div class="item" data-title="Hardware samples">
  <div class="container">


<div class="item" data-title="Arduino">
  <div class="container">


<a class="item" data-title="Arduino overview" href="/docs/samples/arduino/"></a>


<a class="item" data-title="Temperature upload over MQTT using Arduino UNO, ESP8266 and DHT22 sensor" href="/docs/samples/arduino/temperature/"></a>


<a class="item" data-title="Humidity and temperature upload over HTTP using Arduino UNO, SIM808 Shield and HTU21D sensor" href="/docs/samples/arduino/sim808-htu21d/"></a>
  </div>
</div>


<div class="item" data-title="ESP8266">
  <div class="container">


<a class="item" data-title="ESP8266 overview" href="/docs/samples/esp8266/"></a>


<a class="item" data-title="Temperature upload over MQTT using ESP8266 and DHT22 sensor" href="/docs/samples/esp8266/temperature/"></a>


<a class="item" data-title="ESP8266 GPIO control over MQTT using ThingsBoard" href="/docs/samples/esp8266/gpio/"></a>
  </div>
</div>


<div class="item" data-title="NodeMCU">
  <div class="container">


<a class="item" data-title="NodeMCU overview" href="/docs/samples/nodemcu/"></a>


<a class="item" data-title="Temperature upload over MQTT using NodeMCU and DHT11 sensor" href="/docs/samples/nodemcu/temperature/"></a>
  </div>
</div>


<div class="item" data-title="Raspberry Pi">
  <div class="container">


<a class="item" data-title="Raspberry Pi overview" href="/docs/samples/raspberry/"></a>


<a class="item" data-title="Raspberry Pi GPIO control over MQTT using ThingsBoard" href="/docs/samples/raspberry/gpio/"></a>


<a class="item" data-title="Raspberry Pi GPIO control using Android Things and ThingsBoard" href="/docs/samples/raspberry/gpio-android-things/"></a>


<a class="item" data-title="Temperature upload over MQTT using Raspberry Pi and DHT22 sensor" href="/docs/samples/raspberry/temperature/"></a>
  </div>
</div>


<div class="item" data-title="LinkIt ONE">
  <div class="container">


<a class="item" data-title="LinkIt ONE overview" href="/docs/samples/linkit-one/"></a>


<a class="item" data-title="GPS data upload and visualization using LinkIt ONE and ThingsBoard" href="/docs/samples/linkit-one/gps/"></a>
  </div>
</div>
  </div>
</div>
                </div>
            
        
            
            
                <a class="toc" href="/docs/user-guide/install/installation-options/" >Installation</a>
            
        
            
            
                <a class="toc" href="/docs/reference/" >Architecture</a>
            
        
            
            
                <a class="toc" href="/docs/api/" >API</a>
            
        
            
            
                <a class="toc" href="/docs/faq/" >FAQ</a>
            
        
    </div>
</div>








<section id="encyclopedia">
  
  <div id="docsContent" class="noToc hasTocContent">
      <div id="table-of-contents">
          
              <h4>On this page</h4>
          
      </div>
      <div id="top-spacer"></div>
      <h1>Send RPC Request to the Related Device</h1>
      <div id="content">
          <p>ThingsBoard allows you to send remote procedure calls <a href="/docs/user-guide/rpc/#server-side-rpc-api"><strong>RPC</strong></a> from server-side applications to devices and vice versa. <br />
This Tutorial is to show you how to send a remote request call to a Related Device using Rule Engine.</p>

<ul id="markdown-toc">
  <li><a href="#use-case" id="markdown-toc-use-case">Use case</a>    <ul>
      <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
    </ul>
  </li>
  <li><a href="#model-definition" id="markdown-toc-model-definition">Model definition</a></li>
  <li><a href="#message-flow" id="markdown-toc-message-flow">Message flow</a></li>
  <li><a href="#configuring-the-rule-chain" id="markdown-toc-configuring-the-rule-chain">Configuring the Rule Chain</a>    <ul>
      <li><a href="#creating-a-new-rule-chain-tutorial-of-rpc-call-request" id="markdown-toc-creating-a-new-rule-chain-tutorial-of-rpc-call-request">Creating a new Rule Chain (<strong>Tutorial of RPC Call Request</strong>)</a>        <ul>
          <li><a href="#adding-the-required-nodes" id="markdown-toc-adding-the-required-nodes">Adding the required nodes</a>            <ul>
              <li><a href="#node-a-message-type-switch" id="markdown-toc-node-a-message-type-switch">Node A: <strong>Message Type Switch</strong></a></li>
              <li><a href="#node-b-save-timeseries" id="markdown-toc-node-b-save-timeseries">Node B: <strong>Save TimeSeries</strong></a></li>
              <li><a href="#node-c-related-attributes" id="markdown-toc-node-c-related-attributes">Node C: <strong>Related attributes</strong></a></li>
              <li><a href="#node-d-change-originator" id="markdown-toc-node-d-change-originator">Node D: <strong>Change Originator</strong></a></li>
              <li><a href="#node-e-save-timeseries" id="markdown-toc-node-e-save-timeseries">Node E: <strong>Save TimeSeries</strong></a></li>
              <li><a href="#node-f-transform-script" id="markdown-toc-node-f-transform-script">Node F: <strong>Transform Script</strong></a></li>
              <li><a href="#node-g-filter-script" id="markdown-toc-node-g-filter-script">Node G: <strong>Filter Script</strong></a></li>
              <li><a href="#node-h-rpc-call-request" id="markdown-toc-node-h-rpc-call-request">Node H: <strong>RPC call request</strong></a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#how-to-verify-the-rule-chain" id="markdown-toc-how-to-verify-the-rule-chain">How to verify the Rule Chain</a></li>
  <li><a href="#configuring-dashboards" id="markdown-toc-configuring-dashboards">Configuring Dashboards</a></li>
  <li><a href="#see-also" id="markdown-toc-see-also">See Also</a>    <ul>
      <li><a href="#next-steps" id="markdown-toc-next-steps">Next steps</a></li>
    </ul>
  </li>
</ul>

<h1 id="use-case">Use case</h1>
<p>Letâ€™s assume the following use case:</p>

<ul>
  <li>you have the following devices connected to ThingsBoard:
    <ul>
      <li>Wind Direction Sensor.</li>
      <li>Rotating System.</li>
    </ul>
  </li>
  <li>also, you have one asset:
    <ul>
      <li>Wind Turbine.</li>
    </ul>
  </li>
  <li>You want to initiate an RPC request to the Rotating System and change the direction of the Wind Turbine according to the direction of the wind.</li>
  <li>The RPC call will have two properties:
    <ul>
      <li>method: <strong>spinLeft</strong> or <strong>spinRight</strong>.</li>
      <li>params: <strong>value</strong>.</li>
    </ul>
  </li>
</ul>

<table style="width: 60%">
   <thead>
     <tr>
	 <td><strong><em>Note:</em></strong></td>
     </tr>
   </thead>
   <tbody>
     <tr>
	<td>
	<p>Turning the Rotating System to the left or to the right is based on which way is better and faster so that the angle between the direction of the wind and the wind turbine has to be no more than 5 degrees.</p>
	</td>
     </tr>
   </tbody>
</table>

<h2 id="prerequisites">Prerequisites</h2>

<p>We assume you have completed the following guides and reviewed the articles listed below:</p>

<ul>
  <li><a href="/docs/getting-started-guides/helloworld/">Getting Started</a> guide.</li>
  <li><a href="/docs/user-guide/rule-engine-2-0/overview/">Rule Engine Overview</a>.</li>
</ul>

<h1 id="model-definition">Model definition</h1>
<p>The Wind Turbine has two devices installed: Wind Direction Sensor and Rotating System.</p>

<ul>
  <li>The Wind turbine is represented as an Asset. Its name is <strong>Wind Turbine</strong> and its type is <strong>Wind turbine</strong>.</li>
  <li>The Wind Direction Sensor is represented as a Device. Its name is <strong>Wind Direction Sensor</strong> and its type is <strong>Direction Sensor</strong>.</li>
  <li>The Rotating System is represented as a Device. Its name is <strong>Rotating System</strong> and its type is <strong>Rotating System</strong>.</li>
  <li>Create a relation of the type <strong>Contains</strong>:
    <ul>
      <li>from <strong>Wind Turbine</strong> to <strong>Wind Direction Sensor</strong>, and</li>
      <li>from <strong>Wind Turbine</strong> to <strong>Rotating System</strong>.</li>
    </ul>
  </li>
  <li>Create a relation of the type <strong>Uses</strong>:
    <ul>
      <li>from <strong>Rotating System</strong> to <strong>Wind Direction Sensor</strong>.</li>
    </ul>
  </li>
</ul>

<h1 id="message-flow">Message flow</h1>
<p>In this section, we explain the purpose of each node in this tutorial:</p>

<ul>
  <li>Node A: <a href="/docs/user-guide/rule-engine-2-0/filter-nodes/#message-type-switch-node"><strong>Message Type Switch</strong></a> node.
    <ul>
      <li>Routes incoming messages based on the message type.</li>
    </ul>
  </li>
  <li>Node B: <a href="/docs/user-guide/rule-engine-2-0/action-nodes/#save-timeseries-node"><strong>Save Timeseries</strong></a> node.
    <ul>
      <li>Stores messages telemetry from <strong>Wind Direction Sensor</strong> and <strong>Rotating System</strong> into the database.</li>
    </ul>
  </li>
  <li>Node C: <a href="/docs/user-guide/rule-engine-2-0/enrichment-nodes/#related-attributes"><strong>Related attributes</strong></a>.
    <ul>
      <li>Loads the source telemetry <strong>windDirection</strong> of the related <strong>Wind Direction Sensor</strong> and save it into the Message metadata with the name <strong>windDirection</strong>.</li>
    </ul>
  </li>
  <li>Node D: <a href="/docs/user-guide/rule-engine-2-0/transformation-nodes/#change-originator"><strong>Change originator</strong></a> node.
    <ul>
      <li>Change the originator from Devices <strong>Wind Direction Sensor</strong> and <strong>Rotating System</strong> to the related Asset <strong>Wind Turbine</strong> and the submitted message will be processed as a message from Asset.</li>
    </ul>
  </li>
  <li>Node E: <a href="/docs/user-guide/rule-engine-2-0/action-nodes/#save-timeseries-node"><strong>Save Timeseries</strong></a> node.
    <ul>
      <li>Stores messages telemetry from Asset <strong>Wind Turbine</strong> into the database.</li>
    </ul>
  </li>
  <li>Node F: <a href="/docs/user-guide/rule-engine-2-0/transformation-nodes/#script-transformation-node"><strong>Transformation Script</strong></a>.
    <ul>
      <li>Transform an original message into RPC request message.</li>
    </ul>
  </li>
  <li>Node G: <a href="/docs/user-guide/rule-engine-2-0/filter-nodes/#script-filter-node"><strong>Filter Script</strong></a> node.
    <ul>
      <li>Checks if msgType of incoming message is <strong>RPC message</strong>.</li>
    </ul>
  </li>
  <li>Node H: <a href="/docs/user-guide/rule-engine-2-0/action-nodes/#rpc-call-request-node"><strong>RPC call request</strong></a> node.
    <ul>
      <li>Takes the message payload and sends it as a response to the <strong>Rotating System</strong>.</li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h1 id="configuring-the-rule-chain">Configuring the Rule Chain</h1>

<p>The following screenshot shows how the <strong>Tutorial of RPC Call Request</strong> Rule Chain should look like:</p>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/chain.png" alt="image" /></p>

<ul>
  <li>Download the attached json <a href="/docs/user-guide/rule-engine-2-0/tutorials/resources/tutorial_of_rpc_call_request.json"><strong>file</strong></a> for the rule chain indicated above and import it.</li>
  <li>Donâ€™t forget to mark the new rule chain as â€œrootâ€.</li>
</ul>

<p>Also, you can create the new Rule Chain from scratch. The following section shows you how to create it.</p>

<h4 id="creating-a-new-rule-chain-tutorial-of-rpc-call-request">Creating a new Rule Chain (<strong>Tutorial of RPC Call Request</strong>)</h4>

<ul>
  <li>Go to <strong>Rule Chains</strong> -&gt; <strong>Add new Rule Chain</strong></li>
  <li>Enter the Name field as <strong>Tutorial of RPC Call Request</strong>, then click the <strong>ADD</strong> button.</li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/create-chain.png" alt="image" /> <img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/root-chain.png" alt="image" /></p>

<ul>
  <li>The new Rule Chain is now created. Donâ€™t forget to mark it as â€œrootâ€.</li>
</ul>

<h5 id="adding-the-required-nodes">Adding the required nodes</h5>

<p>In this tutorial, you will create 8 nodes as it will be explained in the following sections:</p>

<h6 id="node-a-message-type-switch">Node A: <strong>Message Type Switch</strong></h6>
<ul>
  <li>
    <p>Add the <strong>Message Type Switch</strong> node and connect it to the <strong>Input</strong> node. <br />
This node will route the incoming messages according to the message type, namely <strong>POST_TELEMETRY_REQUEST</strong>.</p>
  </li>
  <li>
    <p>Enter the Name field as <strong>Message Type Switch</strong>.</p>
  </li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/message-type-switch.png" alt="image" /></p>

<h6 id="node-b-save-timeseries">Node B: <strong>Save TimeSeries</strong></h6>
<ul>
  <li>
    <p>Add the <strong>Save TimeSeries</strong> node and connect it to the <strong>Message Type Switch</strong> node with a relation type <strong>Post telemetry</strong>. <br />
This node will store TimeSeries data from incoming Message payload to the database and associate them to the Device, that is identified by the Message Originator, namely <strong>Wind Direction Sensor</strong> and <strong>Rotating System</strong>.</p>
  </li>
  <li>
    <p>Enter the Name field as <strong>Save Time Series</strong>.</p>
  </li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/save-ts.png" alt="image" /></p>

<h6 id="node-c-related-attributes">Node C: <strong>Related attributes</strong></h6>
<ul>
  <li>Add the <strong>Related attributes</strong> node and connect it to the <strong>Save TimeSeries</strong> node with a relation type <strong>Success</strong>. <br />
This node will load the source telemetry <strong>windDirection</strong> from the related <strong>Wind Direction Sensor</strong> to <strong>Rotating System</strong> and save it into the Message metadata with the name <strong>windDirection</strong>.</li>
  <li>Fill in the fields with the input data shown in the following table:</li>
</ul>

<table style="width: 25%">
  <thead>
      <tr>
          <td><b>Field</b></td><td><b>Input Data</b></td>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Name</td>
          <td>Fetch Wind Sensor Telemetry</td>
      </tr>
      <tr>
          <td>Direction</td>
          <td>From</td>
      </tr>
      <tr>
          <td>Max relationship level</td>
          <td>1</td>
      </tr>
      <tr>
          <td>Relationship type</td>
          <td>Uses</td>
      </tr>
      <tr>
          <td>Entity type</td>
          <td>Device</td>
      </tr>
      <tr>
          <td>Latest telemetry</td>
          <td>true</td>
      </tr>
      <tr>
          <td>Source telemetry</td>
          <td>windDirection</td>
      </tr>
      <tr>
          <td>Target telemetry</td>
          <td>windDirection</td>
      </tr>
   </tbody>
</table>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/get-related.png" alt="image" /></p>

<h6 id="node-d-change-originator">Node D: <strong>Change Originator</strong></h6>
<ul>
  <li>Add the <strong>Change Originator</strong> node and connect it to the <strong>Save TimeSeries</strong> node with a relation type <strong>Success</strong>. <br />
This node will change the originator from Devices <strong>Wind Direction Sensor</strong> and <strong>Rotating System</strong> to the Related Asset <strong>Wind Turbine</strong> that has a relation of the type <strong>Contains</strong> from each of them. 
<br />As a result, the submitted message will be processed as a message from this Entity</li>
  <li>Fill in the fields with the input data shown in the following table:</li>
</ul>

<table style="width: 25%">
  <thead>
      <tr>
          <td><b>Field</b></td><td><b>Input Data</b></td>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Name</td>
          <td>Create New Telemetry</td>
      </tr>
      <tr>
          <td>Originator source</td>
          <td>Related</td>
      </tr>
      <tr>
          <td>Direction</td>
          <td>To</td>
      </tr>
      <tr>
          <td>Max relationship level</td>
          <td>1</td>
      </tr>
      <tr>
          <td>Relationship type</td>
          <td>Contains</td>
      </tr>
      <tr>
          <td>Entity type</td>
          <td>Asset</td>
      </tr>
   </tbody>
</table>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/change-originator.png" alt="image" /></p>

<h6 id="node-e-save-timeseries">Node E: <strong>Save TimeSeries</strong></h6>
<ul>
  <li>Add the <strong>Save TimeSeries</strong> node and connect it to the <strong>Change Orignator</strong> node with a relation type <strong>Success</strong>. <br />
This node will store the TimeSeries data from the incoming Message payload into the database from the Asset <strong>Wind Turbine</strong> that is Message Originator.</li>
  <li>Enter the Name field as <strong>Save Time Series</strong>.</li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/save-ts.png" alt="image" /></p>

<h6 id="node-f-transform-script">Node F: <strong>Transform Script</strong></h6>
<ul>
  <li>Add the <strong>Transform Script</strong> node and connect it to the <strong>Related attributes</strong> node with a relation type <strong>Success</strong>. <br />
This node will transform an original message into RPC request message.</li>
  <li>The RPC call will have 2 properties:
    <ul>
      <li>method: <strong>spinLeft</strong> or <strong>spinRight</strong>.</li>
      <li>params: <strong>value</strong>.</li>
    </ul>
  </li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/rpc-message.png" alt="image" /></p>

<ul>
  <li>Enter the Name field as <strong>New RPC Message</strong>.</li>
  <li>Add the following Script:</li>
</ul>
<figure class="highlight">
  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre> <span class="kd">var</span> <span class="nx">newMsg</span> <span class="o">=</span> <span class="p">{};</span>
 <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">turbineDirection</span> <span class="o">-</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">((</span><span class="nx">value</span> <span class="o">&lt;</span> <span class="mi">180</span> <span class="o">&amp;&amp;</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">turbineDirection</span> <span class="o">&lt;</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">)</span><span class="o">||</span>
     <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="mi">180</span> <span class="o">&amp;&amp;</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">turbineDirection</span> <span class="o">&gt;</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">))</span> <span class="p">{</span>
     <span class="nx">newMsg</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">spinLeft</span><span class="dl">'</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">if</span> <span class="p">((</span><span class="nx">value</span> <span class="o">&lt;=</span> <span class="mi">180</span> <span class="o">&amp;&amp;</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">turbineDirection</span> <span class="o">&gt;</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">)</span><span class="o">||</span>
     <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;=</span> <span class="mi">180</span> <span class="o">&amp;&amp;</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">turbineDirection</span> <span class="o">&lt;</span> <span class="nx">metadata</span><span class="p">.</span><span class="nx">windDirection</span><span class="p">))</span> <span class="p">{</span>
     <span class="nx">newMsg</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">spinRight</span><span class="dl">'</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">if</span><span class="p">(</span><span class="nx">newMsg</span><span class="p">.</span><span class="nx">method</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">spinLeft</span><span class="dl">'</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">spinRight</span><span class="dl">'</span><span class="p">){</span>
     <span class="nx">msgType</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">RPC message</span><span class="dl">'</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="nx">newMsg</span><span class="p">.</span><span class="nx">params</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">value</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
 <span class="k">return</span> <span class="p">{</span><span class="na">msg</span><span class="p">:</span> <span class="nx">newMsg</span><span class="p">,</span> <span class="na">metadata</span><span class="p">:</span> <span class="nx">metadata</span><span class="p">,</span> <span class="na">msgType</span><span class="p">:</span> <span class="nx">msgType</span><span class="p">};</span> 
</pre></td></tr></tbody></table></code></pre></div>  </div>
</figure>

<h6 id="node-g-filter-script">Node G: <strong>Filter Script</strong></h6>

<ul>
  <li>
    <p>Add the the <strong>Filter Script</strong> node and connect it to the <strong>Transform Script</strong> node with a relation type <strong>Success</strong>. <br /> 
This node will check if msgType of incoming message is <strong>RPC message</strong>.</p>
  </li>
  <li>Enter the Name field as <strong>Check RPC Message</strong>.</li>
  <li>Add the following Script:</li>
</ul>
<figure class="highlight">
  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">:</span> <span class="k">return</span> <span class="nx">msgType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">RPC message</span><span class="dl">'</span><span class="p">;</span> 
</pre></td></tr></tbody></table></code></pre></div>  </div>
</figure>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/check-validity.png" alt="image" /></p>

<h6 id="node-h-rpc-call-request">Node H: <strong>RPC call request</strong></h6>
<ul>
  <li>Add the <strong>RPC call request</strong> node and connect it to the <strong>Filter Script</strong> node with a relation type <strong>True</strong>. <br />
This node takes the message payload and sends it as a response to the Message Originator.</li>
  <li>Enter the Name field as <strong>Rotating System</strong>.</li>
  <li>Enter the Timeout value as 60 seconds.</li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/request.png" alt="image" /></p>

<p><br /></p>

<p>This Rule chain is now ready and you need to save it.</p>

<p><br />
<br /></p>

<h1 id="how-to-verify-the-rule-chain">How to verify the Rule Chain</h1>

<ul>
  <li>Use the following javascript code to emulate the <strong>Wind Direction Sensor</strong> device.
    <ul>
      <li><a href="/docs/user-guide/rule-engine-2-0/tutorials/resources/WindDirectionEmulator.js"><strong>WindDirectionEmulator.js</strong></a>.</li>
    </ul>
  </li>
  <li>Also, use the following javascript code to emulate the <strong>Rotating System</strong> device. <br />
This code contains a method to emulate changing the turbine direction based on the incoming RPC message.
    <ul>
      <li><a href="/docs/user-guide/rule-engine-2-0/tutorials/resources/RotatingSystemEmulator.js"><strong>RotatingSystemEmulator.js</strong></a>.</li>
    </ul>
  </li>
</ul>

<p>To run the scripts, you need to do the following steps:</p>

<ul>
  <li>Copy the <strong>Wind Direction Sensor</strong> device access token and the <strong>Rotating System</strong> device access token, then paste them in the script.  <br />
You can copy the access token from the Device page. <br /> <br />
In this tutorial,
    <ul>
      <li>the <strong>Wind Direction Sensor</strong> device access token is <strong>Z61K03FAGSziW9b0nKsm</strong></li>
      <li>the <strong>Rotating System</strong> device access token is <strong>jSuvzrURCbw7q4LGtygc</strong></li>
    </ul>

    <p>However, these access tokens are unique and you will need to copy the access tokens of your devices.</p>
  </li>
</ul>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/wind-token.png" alt="image" /> <img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/rs-token.png" alt="image" /></p>

<ul>
  <li>Open the terminal and go to the folder that contains these emulator scripts, then run the following commands:
    <ul>
      <li>node WindDirectionEmulator.js</li>
      <li>node RotatingSystemEmulator.js</li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h1 id="configuring-dashboards">Configuring Dashboards</h1>
<p>The following screenshot shows how the <strong>Wind Turbine Dashboard</strong> should look like:</p>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/dashboard.png" alt="image" /></p>

<p>Download the attached json <a href="/docs/user-guide/rule-engine-2-0/tutorials/resources/wind_turbine_dashboard.json"><strong>file</strong></a> for the dashboard indicated above and import it.</p>

<ul>
  <li>Go to <strong>Dashboards</strong> -&gt; <strong>Add new Dashboard</strong> -&gt; <strong>Import Dashboard</strong> and drop the downloaded json file.</li>
</ul>

<p>The next Step is to configure the aliases used by the imported dashboard.</p>

<p><img src="/images/user-guide/rule-engine-2-0/tutorials/rpc-request/aliases.png" alt="image" /></p>

<p>Click the <strong>Edit alias</strong> button and enter the input data shown in the following table:</p>

<table style="width: 30%">
  <thead>
      <tr>
       <td>Alias </td>
       <td>Field</td>
       <td>Input Data </td>
      </tr>
  </thead>
  <tbody>
      <tr>
           <td rowspan="3">Wind Turbine
           </td>
           <td>Filter type
           </td>
           <td>Single entity
           </td>
      </tr>
      <tr>
           <td>Type
           </td>
           <td>Asset
           </td>
      </tr>
      <tr>
           <td>Asset
           </td>
           <td>Wind Turbine
           </td>
      </tr>
      <tr>
           <td rowspan="3">Wind Direction Sensor
           </td>
           <td>Filter type
           </td>
           <td>Single entity
           </td>
      </tr>
      <tr>
           <td>Type
           </td>
           <td>Device
           </td>
      </tr>
      <tr>
           <td>Device
           </td>
           <td>Wind Direction Sensor
           </td>
          </tr>
      <tr>
           <td rowspan="3">Rotating System
           </td>
           <td>Filter type
           </td>
           <td>Single entity
           </td>
      </tr>
      <tr>
           <td>Type
           </td>
           <td>Device
           </td>
      </tr>
      <tr>
           <td>Device
           </td>
           <td>Rotating System
           </td>
      </tr>
  </tbody>
</table>

<p>The configuration of the dashboard is now completed and you can verify that it works as expected.</p>

<p>Also, you can see:</p>

<ul>
  <li>how to work with <strong>RPC call reply</strong> Rule Node</li>
</ul>

<p>Please refer to the second link under the <strong>See Also</strong> section to see how to do this.</p>

<p><br />
<br /></p>

<h1 id="see-also">See Also</h1>

<ul>
  <li>
    <p>For more details about how RPC works in Thignsboard, please refer to the <a href="/docs/user-guide/rpc/#server-side-rpc-api">RPC capabilities</a> guide.</p>
  </li>
  <li>
    <p><a href="/docs/user-guide/rule-engine-2-0/tutorials/rpc-reply-tutorial/">RPC Reply With data from Related Device</a> guide.</p>
  </li>
</ul>

<h2 id="next-steps">Next steps</h2>

<ul>
  <li>
    <p><a href="/docs/guides#AnchorIDGettingStartedGuides">Getting started guides</a> - These guides provide quick overview of main ThingsBoard features. Designed to be completed in 15-30 minutes.</p>
  </li>
  <li>
    <p><a href="/docs/user-guide/install/installation-options/">Installation guides</a> - Learn how to setup ThingsBoard on various available operating systems.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDConnectYourDevice">Connect your device</a> - Learn how to connect devices based on your connectivity technology or solution.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDDataVisualization">Data visualization</a> - These guides contain instructions how to configure complex ThingsBoard dashboards.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDDataAnalytics">IoT Data analytics</a> - Learn how to use rule engine to perform basic analytics tasks.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDHardwareSamples">Hardware samples</a> - Learn how to connect various hardware platforms to ThingsBoard.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDAdvancedFeatures">Advanced features</a> - Learn about advanced ThingsBoard features.</p>
  </li>
  <li>
    <p><a href="/docs/guides#AnchorIDContribution">Contribution and Development</a> - Learn about contribution and development in ThingsBoard.</p>
  </li>
</ul>

<p><br /></p>


      </div>
      <footer>
	<main class="light-text">
		<div class="newsletterSubsContainer">
            <script type="text/javascript">
                function subscribeForNewsletter(event) {
                    event.stopPropagation();
                    var script_tag = document.createElement('script');
                    script_tag.setAttribute("type", "text/javascript");
                    script_tag.setAttribute("src", "https://static.mailerlite.com/js/w/webforms.min.js?v28bf44f740701752bfc6767bc7e171d4");
                    document.getElementsByTagName("head")[0].appendChild(script_tag);
                    $(event.target).css('display', 'none');
                    $('#mlb2-7341216').css('display', 'block');
                }
            </script>
            <button class="n-button price subscribe" onClick="subscribeForNewsletter(event)">Sign up for ThingsBoard news</button>
            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: none;">
<!--            <div id="mlb2-7341216" class="ml-subscribe-form ml-subscribe-form-7341216" style="display: block;">-->
                <div class="ml-vertical-align-center">
                    <div class="subscribe-form ml-block-success" style="display: none;">
                        <div class="form-section">
                            <p>Thank you for your interest in ThingsBoard!<br/>Have a great day!</p>
                        </div>
                    </div>
                    <form class="ml-block-form" action="https://static.mailerlite.com/webforms/submit/r9r9x7" data-id="708170" data-code="r9r9x7" method="POST" target="_blank">
                        <div class="subscribe-form horizontal">
                            <div class="form-section horizontal">
                                <div class="form-group ml-field-email ml-validate-required ml-validate-email">
                                    <input type="email" name="fields[email]" class="form-control" placeholder="Email address*" value="" autocomplete="email" x-autocompletetype="email" spellcheck="false" autocapitalize="off" autocorrect="off">
                                </div>
                            </div>
                            <input type="hidden" name="ml-submit" value="1">
                            <div class="form-section horizontal ml-button-position">
                                <button class="primary n-button price subscribe" type="submit">
                                    Subscribe
                                </button>
                                <button disabled="disabled" style="display: none;" type="button" class="n-button loading">
                                    <img src="https://static.mailerlite.com/images/rolling@2x.gif" width="20" height="20" style="width: 20px; height: 20px;">
                                </button>
                            </div>
                            <p>By subscribing you agree to receive newsletters from ThingsBoard, Inc.</p>
                        </div>
                    </form>
                </div>
            </div>
		</div>

        <hr>

        <div class="deeper">
            <a href="/" class="footer-logo"></a>
            <nav>
                <a href="/docs/getting-started-guides/helloworld/">Get Started</a>
                <a href="/docs/">Documentation</a>
                <a href="/iot-use-cases/">Use cases</a>
                <a href="https://blog.thingsboard.io/">Blog</a>
                <a href="/docs/services/">Services</a>
                <a href="/docs/contact-us/">Contact us</a>
            </nav>
        </div>

        <div class="deepmost">
            <div class="copyright">&copy; 2021 The ThingsBoard Authors</div>
            <div class="social">
                <a href="https://github.com/thingsboard/thingsboard" class="github"></a>
                <a href="https://gitter.im/thingsboard/chat" class="gitter"></a>
                <a href="https://www.youtube.com/thingsboard" class="youtube"></a>
                <a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"></a>
                <a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"></a>
                <a href="https://www.facebook.com/thingsboard" class="facebook"></a>
                <a href="https://twitter.com/thingsboard" class="twitter"></a>
            </div>
        </div>
	</main>
</footer>

  </div>
</section>

<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
<script>
    jqueryDefer(function () {
        $(document).on('selectionchange',function() {
        // $(document).mouseup(function () {
            $('.clipboard-btn').removeClass('noChars');
            var selectedChars = getSelectedText();
            // $('#numberChars').html(selectedChars.length);
            if (selectedChars == 0) {
                $('.clipboard-btn').addClass('noChars');
            }
        });
    });
    function getSelectedText() {
        var text;
        if (window.getSelection) {
            text = window.getSelection().toString();
        } else if (document.getSelection) {
            text = document.getSelection();
        } else if (document.selection) {
            text = document.selection.createRange().text;
        }
        return text;
    }
</script>
<script>
    jqueryDefer(function () {
        $(document).ready(function () {
            var allCodeBlocksElements = $(".copy-code");
            allCodeBlocksElements.each(function (i) {
                var codeBlock = $(this);
                if (!codeBlock.hasClass('highlighter-rouge')) {
                    codeBlock = codeBlock.find('.highlighter-rouge');
                }
                codeBlock.each(function () {
                    var block = codeBlock.find('pre.highlight > code .rouge-code');
                    var currentId = "codeblock" + (i + 1);
                    block.attr('id', currentId);
                    var clipButton = $('<button class="clipboard-btn" data-clipboard-target="#' + currentId + '"><p>Copy to clipboard</p><div><img src="/images/copy-code-icon.svg" alt="Copy to clipboard"></div></button>');
                    $(this).append(clipButton);
                    var troyan = codeBlock.find('pre.highlight');
                    var Tooltip = $('<div class="customTooltip"><div class="tooltipText">Copied!</div></div>');
                    troyan.append(Tooltip);
                    troyan.addClass('clipboard-btn');
                    troyan.attr('data-clipboard-target', "#" + currentId);
                    troyan.on('mouseleave', clearTooltip);
                    troyan.on('blur', clearTooltip);
                    troyan.on('click', function(e) {
                        var el = $(e.currentTarget);
                        if (el.hasClass('showTool')) {
                            clearTooltip(e);
                            troyan.attr('data-skip-tooltip', "true");
                        }
                    });
                });
            });

            var clipboard = new Clipboard('.noChars');
            clipboard.on('success', function (e) {
                $('.clipboard-btn').removeClass('noChars');
                e.clearSelection();
                var trigger = e.trigger;
                if (!$(trigger).attr('data-skip-tooltip')) {
                    showTooltip(e.trigger, 'Copied!');
                } else {
                    $(trigger).removeAttr('data-skip-tooltip');
                }
            });

            $('#search').focus(
                function(){
                    $(this).parent('#searchBox').addClass('focused');
                }).blur(
                function(){
                    $(this).parent('#searchBox').removeClass('focused');
                });

            $('#searchBox .searchButton').click(function () {
                var value = $('#search').val();
                window.location.replace('/docs/search/?q=' + value);
            });

            $('#docsBreadcrumbs').click(function () {
                if ($(this).hasClass('active')) {
                    $(this).removeClass('active');
                    $('#docsNav').removeClass('active');
                    $('#searchBox').removeClass('visible');
                } else {
                    $(this).addClass('active');
                    $('#docsNav').addClass('active');
                    $('#searchBox').addClass('visible');
                }
            });
        });

        function clearTooltip(e) {
            var el = $(e.currentTarget);
            el.removeClass('showTool');
            el.attr('aria-label', null);
        }

        function showTooltip(elem, msg) {
            var el = $(elem);
            el.addClass('showTool');
            el.attr('aria-label', msg);
        }
    });
</script>

<script>
    jqueryDefer(function () {
        var markdownTocs = null;
        var contentAnchors = [];
        var activeAnchor = null;
        var firstAnchor = null;
        var lastAnchor = null;

        function updatePositions() {
            contentAnchors = [];
            markdownTocs.each(function (i) {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                var contentAnchor = $('div#content ' + href);
                var top = Math.floor(contentAnchor.offset().top);
                var bottom;
                if (i < markdownTocs.length - 1) {
                    var nextHref = $(markdownTocs[i + 1]).children('a').attr('href');
                    var nextContentAnchor = $('div#content ' + nextHref);
                    bottom = Math.floor(nextContentAnchor.offset().top);
                } else {
                    bottom = $('div#content').offset().top + $('div#content').innerHeight();
                }
                var contentAnchorInfo = {anchor: contentAnchor, toc: $(this), top: top, bottom: bottom, href: href};
                contentAnchors.push(contentAnchorInfo);
                if (i === 0) {
                    firstAnchor = contentAnchorInfo;
                }
                if (i === markdownTocs.length - 1) {
                    lastAnchor = contentAnchorInfo;
                }
            });
        }

        function findActiveContentToc() {
            var top = $(window).scrollTop();
            var bottom = top + $(window).height();
            if (bottom === $('#encyclopedia').offset().top + $('#encyclopedia').innerHeight()) {
                return lastAnchor;
            } else {
                bottom -= 154;
                for (var i = 0; i < contentAnchors.length; i++) {
                    var contentAnchor = contentAnchors[i];
                    if (contentAnchor.top <= bottom &&
                        contentAnchor.bottom > top) {
                        return contentAnchor;
                    }
                }
            }
            return firstAnchor;
        }

        function updateActiveToc(init) {
            updatePositions();
            var newActiveAnchor = findActiveContentToc();
            if (!activeAnchor || newActiveAnchor.href !== activeAnchor.href) {
                activeAnchor = newActiveAnchor;
                markdownTocs.removeClass('active');
                activeAnchor.toc.addClass('active');
                var tocTop = $('#table-of-contents').scrollTop() + 100;
                var tocBottom = tocTop + $('#table-of-contents').innerHeight() - 200;
                var activeTocTop = activeAnchor.toc.position().top;
                var activeTocBottom = activeTocTop + activeAnchor.toc.children(':first').height();
                if (tocTop > activeTocTop) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop -= 100;
                } else if (tocBottom < activeTocBottom) {
                    activeAnchor.toc[0].scrollIntoView();
                    $('#table-of-contents')[0].scrollTop += init ? -100 : 100;
                }
            }
        }
        $( document ).ready(function() {
            var tocs = $('#content > ul#markdown-toc');
            var tableOfContents = $('#table-of-contents');
            tableOfContents.append(tocs);
            markdownTocs = $('#table-of-contents ul#markdown-toc li').filter(function() {
                var tocAnchor = $(this).children('a');
                var href = tocAnchor.attr('href');
                if (!href.startsWith('#')) {
                    return false;
                } else {
                    var contentAnchor = $('div#content ' + href);
                    return contentAnchor.length > 0;
                }
            });
            updateActiveToc(true);
        });

        $(document).on("scroll", function() {
            updateActiveToc(false);
        });

    });
</script>

</body>
</html>

